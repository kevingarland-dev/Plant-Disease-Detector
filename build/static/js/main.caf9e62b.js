/*! For license information please see main.caf9e62b.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,n)=>{var i=n(853),r=n(43),o=n(950);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function c(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function l(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(c(e)!==e)throw Error(a(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var p=Object.assign,f=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),S=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope");var R=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var x=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var O=Symbol.iterator;function _(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var I=Symbol.for("react.client.reference");function N(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===I?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case v:return"Fragment";case b:return"Profiler";case y:return"StrictMode";case w:return"Suspense";case C:return"SuspenseList";case R:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case S:return e.displayName||"Context";case k:return(e._context.displayName||"Context")+".Consumer";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case E:return null!==(t=e.displayName||null)?t:N(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return N(e(t))}catch(n){}}return null}var D=Array.isArray,M=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,A=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},U=[],j=-1;function F(e){return{current:e}}function B(e){0>j||(e.current=U[j],U[j]=null,j--)}function z(e,t){j++,U[j]=e.current,e.current=t}var V,q,H=F(null),W=F(null),G=F(null),K=F(null);function J(e,t){switch(z(G,t),z(W,e),z(H,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?vd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=yd(t=vd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(H),z(H,e)}function Q(){B(H),B(W),B(G)}function $(e){null!==e.memoizedState&&z(K,e);var t=H.current,n=yd(t,e.type);t!==n&&(z(W,e),z(H,n))}function Y(e){W.current===e&&(B(H),B(W)),K.current===e&&(B(K),uh._currentValue=L)}function X(e){if(void 0===V)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);V=t&&t[1]||"",q=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+V+e+q}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(r){var i=r}Reflect.construct(e,[],n)}else{try{n.call()}catch(o){i=o}e.call(n.prototype)}}else{try{throw Error()}catch(a){i=a}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&i&&"string"===typeof s.stack)return[s.stack,i.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=i.DetermineComponentFrameRoot(),a=o[0],s=o[1];if(a&&s){var c=a.split("\n"),l=s.split("\n");for(r=i=0;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;for(;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;if(i===c.length||r===l.length)for(i=c.length-1,r=l.length-1;1<=i&&0<=r&&c[i]!==l[r];)r--;for(;1<=i&&0<=r;i--,r--)if(c[i]!==l[r]){if(1!==i||1!==r)do{if(i--,0>--r||c[i]!==l[r]){var u="\n"+c[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=i&&0<=r);break}}}finally{Z=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?X(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return X(e.type);case 16:return X("Lazy");case 13:return e.child!==t&&null!==t?X("Suspense Fallback"):X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return X("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(i){return"\nError generating stack: "+i.message+"\n"+i.stack}}var ie=Object.prototype.hasOwnProperty,re=i.unstable_scheduleCallback,oe=i.unstable_cancelCallback,ae=i.unstable_shouldYield,se=i.unstable_requestPaint,ce=i.unstable_now,le=i.unstable_getCurrentPriorityLevel,ue=i.unstable_ImmediatePriority,de=i.unstable_UserBlockingPriority,he=i.unstable_NormalPriority,pe=i.unstable_LowPriority,fe=i.unstable_IdlePriority,me=i.log,ge=i.unstable_setDisableYieldValue,ve=null,ye=null;function be(e){if("function"===typeof me&&ge(e),ye&&"function"===typeof ye.setStrictMode)try{ye.setStrictMode(ve,e)}catch(t){}}var ke=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(Se(e)/Te|0)|0},Se=Math.log,Te=Math.LN2;var we=256,Ce=262144,Ee=4194304;function Pe(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Re(e,t,n){var i=e.pendingLanes;if(0===i)return 0;var r=0,o=e.suspendedLanes,a=e.pingedLanes;e=e.warmLanes;var s=134217727&i;return 0!==s?0!==(i=s&~o)?r=Pe(i):0!==(a&=s)?r=Pe(a):n||0!==(n=s&~e)&&(r=Pe(n)):0!==(s=i&~o)?r=Pe(s):0!==a?r=Pe(a):n||0!==(n=i&~e)&&(r=Pe(n)),0===r?0:0!==t&&t!==r&&0===(t&o)&&((o=r&-r)>=(n=t&-t)||32===o&&0!==(4194048&n))?t:r}function xe(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Oe(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function _e(){var e=Ee;return 0===(62914560&(Ee<<=1))&&(Ee=4194304),e}function Ie(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ne(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function De(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-ke(t);e.entangledLanes|=t,e.entanglements[i]=1073741824|e.entanglements[i]|261930&n}function Me(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ke(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}function Ae(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:Le(n))&(e.suspendedLanes|t))?0:n}function Le(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ue(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function je(){var e=A.p;return 0!==e?e:void 0===(e=window.event)?32:Ph(e.type)}function Fe(e,t){var n=A.p;try{return A.p=e,t()}finally{A.p=n}}var Be=Math.random().toString(36).slice(2),ze="__reactFiber$"+Be,Ve="__reactProps$"+Be,qe="__reactContainer$"+Be,He="__reactEvents$"+Be,We="__reactListeners$"+Be,Ge="__reactHandles$"+Be,Ke="__reactResources$"+Be,Je="__reactMarker$"+Be;function Qe(e){delete e[ze],delete e[Ve],delete e[He],delete e[We],delete e[Ge]}function $e(e){var t=e[ze];if(t)return t;for(var n=e.parentNode;n;){if(t=n[qe]||n[ze]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Ld(e);null!==e;){if(n=e[ze])return n;e=Ld(e)}return t}n=(e=n).parentNode}return null}function Ye(e){if(e=e[ze]||e[qe]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Xe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function Ze(e){var t=e[Ke];return t||(t=e[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Je]=!0}var tt=new Set,nt={};function it(e,t){rt(e,t),rt(e+"Capture",t)}function rt(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var ot=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),at={},st={};function ct(e,t,n){if(r=t,ie.call(st,r)||!ie.call(at,r)&&(ot.test(r)?st[r]=!0:(at[r]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var i=t.toLowerCase().slice(0,5);if("data-"!==i&&"aria-"!==i)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var r}function lt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ut(e,t,n,i){if(null===i)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+i)}}function dt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function pt(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,n){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var r=i.get,o=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=ht(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function mt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function vt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function yt(e,t,n,i,r,o,a,s){e.name="",null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.type=a:e.removeAttribute("type"),null!=t?"number"===a?(0===t&&""===e.value||e.value!=t)&&(e.value=""+dt(t)):e.value!==""+dt(t)&&(e.value=""+dt(t)):"submit"!==a&&"reset"!==a||e.removeAttribute("value"),null!=t?kt(e,a,dt(t)):null!=n?kt(e,a,dt(n)):null!=i&&e.removeAttribute("value"),null==r&&null!=o&&(e.defaultChecked=!!o),null!=r&&(e.checked=r&&"function"!==typeof r&&"symbol"!==typeof r),null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.name=""+dt(s):e.removeAttribute("name")}function bt(e,t,n,i,r,o,a,s){if(null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.type=o),null!=t||null!=n){if(!("submit"!==o&&"reset"!==o||void 0!==t&&null!==t))return void pt(e);n=null!=n?""+dt(n):"",t=null!=t?""+dt(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}i="function"!==typeof(i=null!=i?i:r)&&"symbol"!==typeof i&&!!i,e.checked=s?e.checked:!!i,e.defaultChecked=!!i,null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.name=a),pt(e)}function kt(e,t,n){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function St(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+dt(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function Tt(e,t,n){null==t||((t=""+dt(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+dt(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,n,i){if(null==t){if(null!=i){if(null!=n)throw Error(a(92));if(D(i)){if(1<i.length)throw Error(a(93));i=i[0]}n=i}null==n&&(n=""),t=n}n=dt(t),e.defaultValue=n,(i=e.textContent)===n&&""!==i&&null!==i&&(e.value=i),pt(e)}function Ct(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Et=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Pt(e,t,n){var i=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?i?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":i?e.setProperty(t,n):"number"!==typeof n||0===n||Et.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Rt(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var i in n)!n.hasOwnProperty(i)||null!=t&&t.hasOwnProperty(i)||(0===i.indexOf("--")?e.setProperty(i,""):"float"===i?e.cssFloat="":e[i]="");for(var r in t)i=t[r],t.hasOwnProperty(r)&&n[r]!==i&&Pt(e,r,i)}else for(var o in t)t.hasOwnProperty(o)&&Pt(e,o,t[o])}function xt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ot=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_t=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function It(e){return _t.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Nt(){}var Dt=null;function Mt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var At=null,Lt=null;function Ut(e){var t=Ye(e);if(t&&(e=t.stateNode)){var n=e[Ve]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+vt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=i[Ve]||null;if(!r)throw Error(a(90));yt(i,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)(i=n[t]).form===e.form&&ft(i)}break e;case"textarea":Tt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&St(e,!!n.multiple,t,!1)}}}var jt=!1;function Ft(e,t,n){if(jt)return e(t,n);jt=!0;try{return e(t)}finally{if(jt=!1,(null!==At||null!==Lt)&&(Zl(),At&&(t=At,e=Lt,Lt=At=null,Ut(t),e)))for(t=0;t<e.length;t++)Ut(e[t])}}function Bt(e,t){var n=e.stateNode;if(null===n)return null;var i=n[Ve]||null;if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var zt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Vt=!1;if(zt)try{var qt={};Object.defineProperty(qt,"passive",{get:function(){Vt=!0}}),window.addEventListener("test",qt,qt),window.removeEventListener("test",qt,qt)}catch(Yh){Vt=!1}var Ht=null,Wt=null,Gt=null;function Kt(){if(Gt)return Gt;var e,t,n=Wt,i=n.length,r="value"in Ht?Ht.value:Ht.textContent,o=r.length;for(e=0;e<i&&n[e]===r[e];e++);var a=i-e;for(t=1;t<=a&&n[i-t]===r[o-t];t++);return Gt=r.slice(e,1<t?1-t:void 0)}function Jt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Qt(){return!0}function $t(){return!1}function Yt(e){function t(t,n,i,r,o){for(var a in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?Qt:$t,this.isPropagationStopped=$t,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Qt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Qt)},persist:function(){},isPersistent:Qt}),t}var Xt,Zt,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Yt(tn),rn=p({},tn,{view:0,detail:0}),on=Yt(rn),an=p({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Xt=e.screenX-en.screenX,Zt=e.screenY-en.screenY):Zt=Xt=0,en=e),Xt)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),sn=Yt(an),cn=Yt(p({},an,{dataTransfer:0})),ln=Yt(p({},rn,{relatedTarget:0})),un=Yt(p({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),dn=Yt(p({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),hn=Yt(p({},tn,{data:0})),pn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mn[e])&&!!t[e]}function vn(){return gn}var yn=Yt(p({},rn,{key:function(e){if(e.key){var t=pn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Jt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vn,charCode:function(e){return"keypress"===e.type?Jt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Jt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),bn=Yt(p({},an,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=Yt(p({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vn})),Sn=Yt(p({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=Yt(p({},an,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),wn=Yt(p({},tn,{newState:0,oldState:0})),Cn=[9,13,27,32],En=zt&&"CompositionEvent"in window,Pn=null;zt&&"documentMode"in document&&(Pn=document.documentMode);var Rn=zt&&"TextEvent"in window&&!Pn,xn=zt&&(!En||Pn&&8<Pn&&11>=Pn),On=String.fromCharCode(32),_n=!1;function In(e,t){switch(e){case"keyup":return-1!==Cn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Dn=!1;var Mn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function An(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Mn[e.type]:"textarea"===t}function Ln(e,t,n,i){At?Lt?Lt.push(i):Lt=[i]:At=i,0<(t=id(t,"onChange")).length&&(n=new nn("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Un=null,jn=null;function Fn(e){Qu(e,0)}function Bn(e){if(ft(Xe(e)))return e}function zn(e,t){if("change"===e)return t}var Vn=!1;if(zt){var qn;if(zt){var Hn="oninput"in document;if(!Hn){var Wn=document.createElement("div");Wn.setAttribute("oninput","return;"),Hn="function"===typeof Wn.oninput}qn=Hn}else qn=!1;Vn=qn&&(!document.documentMode||9<document.documentMode)}function Gn(){Un&&(Un.detachEvent("onpropertychange",Kn),jn=Un=null)}function Kn(e){if("value"===e.propertyName&&Bn(jn)){var t=[];Ln(t,jn,e,Mt(e)),Ft(Fn,t)}}function Jn(e,t,n){"focusin"===e?(Gn(),jn=n,(Un=t).attachEvent("onpropertychange",Kn)):"focusout"===e&&Gn()}function Qn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Bn(jn)}function $n(e,t){if("click"===e)return Bn(t)}function Yn(e,t){if("input"===e||"change"===e)return Bn(t)}var Xn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Zn(e,t){if(Xn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!ie.call(t,r)||!Xn(e[r],t[r]))return!1}return!0}function ei(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ti(e,t){var n,i=ei(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ei(i)}}function ni(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ni(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ii(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=mt((e=t.contentWindow).document)}return t}function ri(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var oi=zt&&"documentMode"in document&&11>=document.documentMode,ai=null,si=null,ci=null,li=!1;function ui(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;li||null==ai||ai!==mt(i)||("selectionStart"in(i=ai)&&ri(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},ci&&Zn(ci,i)||(ci=i,0<(i=id(si,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=ai)))}function di(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var hi={animationend:di("Animation","AnimationEnd"),animationiteration:di("Animation","AnimationIteration"),animationstart:di("Animation","AnimationStart"),transitionrun:di("Transition","TransitionRun"),transitionstart:di("Transition","TransitionStart"),transitioncancel:di("Transition","TransitionCancel"),transitionend:di("Transition","TransitionEnd")},pi={},fi={};function mi(e){if(pi[e])return pi[e];if(!hi[e])return e;var t,n=hi[e];for(t in n)if(n.hasOwnProperty(t)&&t in fi)return pi[e]=n[t];return e}zt&&(fi=document.createElement("div").style,"AnimationEvent"in window||(delete hi.animationend.animation,delete hi.animationiteration.animation,delete hi.animationstart.animation),"TransitionEvent"in window||delete hi.transitionend.transition);var gi=mi("animationend"),vi=mi("animationiteration"),yi=mi("animationstart"),bi=mi("transitionrun"),ki=mi("transitionstart"),Si=mi("transitioncancel"),Ti=mi("transitionend"),wi=new Map,Ci="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ei(e,t){wi.set(e,t),it(t,[e])}Ci.push("scrollEnd");var Pi="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Ri=[],xi=0,Oi=0;function _i(){for(var e=xi,t=Oi=xi=0;t<e;){var n=Ri[t];Ri[t++]=null;var i=Ri[t];Ri[t++]=null;var r=Ri[t];Ri[t++]=null;var o=Ri[t];if(Ri[t++]=null,null!==i&&null!==r){var a=i.pending;null===a?r.next=r:(r.next=a.next,a.next=r),i.pending=r}0!==o&&Mi(n,r,o)}}function Ii(e,t,n,i){Ri[xi++]=e,Ri[xi++]=t,Ri[xi++]=n,Ri[xi++]=i,Oi|=i,e.lanes|=i,null!==(e=e.alternate)&&(e.lanes|=i)}function Ni(e,t,n,i){return Ii(e,t,n,i),Ai(e)}function Di(e,t){return Ii(e,null,null,t),Ai(e)}function Mi(e,t,n){e.lanes|=n;var i=e.alternate;null!==i&&(i.lanes|=n);for(var r=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(i=o.alternate)&&(i.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(r=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,r&&null!==t&&(r=31-ke(n),null===(i=(e=o.hiddenUpdates)[r])?e[r]=[t]:i.push(t),t.lane=536870912|n),o):null}function Ai(e){if(50<Hl)throw Hl=0,Wl=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Li={};function Ui(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ji(e,t,n,i){return new Ui(e,t,n,i)}function Fi(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Bi(e,t){var n=e.alternate;return null===n?((n=ji(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function zi(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Vi(e,t,n,i,r,o){var s=0;if(i=e,"function"===typeof e)Fi(e)&&(s=1);else if("string"===typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,H.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case R:return(e=ji(31,n,t,r)).elementType=R,e.lanes=o,e;case v:return qi(n.children,r,o,t);case y:s=8,r|=24;break;case b:return(e=ji(12,n,t,2|r)).elementType=b,e.lanes=o,e;case w:return(e=ji(13,n,t,r)).elementType=w,e.lanes=o,e;case C:return(e=ji(19,n,t,r)).elementType=C,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:s=10;break e;case k:s=9;break e;case T:s=11;break e;case E:s=14;break e;case P:s=16,i=null;break e}s=29,n=Error(a(130,null===e?"null":typeof e,"")),i=null}return(t=ji(s,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function qi(e,t,n,i){return(e=ji(7,e,i,t)).lanes=n,e}function Hi(e,t,n){return(e=ji(6,e,null,t)).lanes=n,e}function Wi(e){var t=ji(18,null,null,0);return t.stateNode=e,t}function Gi(e,t,n){return(t=ji(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Ki=new WeakMap;function Ji(e,t){if("object"===typeof e&&null!==e){var n=Ki.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Ki.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var Qi=[],$i=0,Yi=null,Xi=0,Zi=[],er=0,tr=null,nr=1,ir="";function rr(e,t){Qi[$i++]=Xi,Qi[$i++]=Yi,Yi=e,Xi=t}function or(e,t,n){Zi[er++]=nr,Zi[er++]=ir,Zi[er++]=tr,tr=e;var i=nr;e=ir;var r=32-ke(i)-1;i&=~(1<<r),n+=1;var o=32-ke(t)+r;if(30<o){var a=r-r%5;o=(i&(1<<a)-1).toString(32),i>>=a,r-=a,nr=1<<32-ke(t)+r|n<<r|i,ir=o+e}else nr=1<<o|n<<r|i,ir=e}function ar(e){null!==e.return&&(rr(e,1),or(e,1,0))}function sr(e){for(;e===Yi;)Yi=Qi[--$i],Qi[$i]=null,Xi=Qi[--$i],Qi[$i]=null;for(;e===tr;)tr=Zi[--er],Zi[er]=null,ir=Zi[--er],Zi[er]=null,nr=Zi[--er],Zi[er]=null}function cr(e,t){Zi[er++]=nr,Zi[er++]=ir,Zi[er++]=tr,nr=t.id,ir=t.overflow,tr=e}var lr=null,ur=null,dr=!1,hr=null,pr=!1,fr=Error(a(519));function mr(e){throw Sr(Ji(Error(a(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),fr}function gr(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[ze]=e,t[Ve]=i,n){case"dialog":$u("cancel",t),$u("close",t);break;case"iframe":case"object":case"embed":$u("load",t);break;case"video":case"audio":for(n=0;n<Ku.length;n++)$u(Ku[n],t);break;case"source":$u("error",t);break;case"img":case"image":case"link":$u("error",t),$u("load",t);break;case"details":$u("toggle",t);break;case"input":$u("invalid",t),bt(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":$u("invalid",t);break;case"textarea":$u("invalid",t),wt(t,i.value,i.defaultValue,i.children)}"string"!==typeof(n=i.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===i.suppressHydrationWarning||ld(t.textContent,n)?(null!=i.popover&&($u("beforetoggle",t),$u("toggle",t)),null!=i.onScroll&&$u("scroll",t),null!=i.onScrollEnd&&$u("scrollend",t),null!=i.onClick&&(t.onclick=Nt),t=!0):t=!1,t||mr(e,!0)}function vr(e){for(lr=e.return;lr;)switch(lr.tag){case 5:case 31:case 13:return void(pr=!1);case 27:case 3:return void(pr=!0);default:lr=lr.return}}function yr(e){if(e!==lr)return!1;if(!dr)return vr(e),dr=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||bd(e.type,e.memoizedProps)),t=!t),t&&ur&&mr(e),vr(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));ur=Ad(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));ur=Ad(e)}else 27===n?(n=ur,Pd(e.type)?(e=Md,Md=null,ur=e):ur=n):ur=lr?Dd(e.stateNode.nextSibling):null;return!0}function br(){ur=lr=null,dr=!1}function kr(){var e=hr;return null!==e&&(null===_l?_l=e:_l.push.apply(_l,e),hr=null),e}function Sr(e){null===hr?hr=[e]:hr.push(e)}var Tr=F(null),wr=null,Cr=null;function Er(e,t,n){z(Tr,t._currentValue),t._currentValue=n}function Pr(e){e._currentValue=Tr.current,B(Tr)}function Rr(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function xr(e,t,n,i){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var o=r.dependencies;if(null!==o){var s=r.child;o=o.firstContext;e:for(;null!==o;){var c=o;o=r;for(var l=0;l<t.length;l++)if(c.context===t[l]){o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Rr(o.return,n,e),i||(s=null);break e}o=c.next}}else if(18===r.tag){if(null===(s=r.return))throw Error(a(341));s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),Rr(s,n,e),s=null}else s=r.child;if(null!==s)s.return=r;else for(s=r;null!==s;){if(s===e){s=null;break}if(null!==(r=s.sibling)){r.return=s.return,s=r;break}s=s.return}r=s}}function Or(e,t,n,i){e=null;for(var r=t,o=!1;null!==r;){if(!o)if(0!==(524288&r.flags))o=!0;else if(0!==(262144&r.flags))break;if(10===r.tag){var s=r.alternate;if(null===s)throw Error(a(387));if(null!==(s=s.memoizedProps)){var c=r.type;Xn(r.pendingProps.value,s.value)||(null!==e?e.push(c):e=[c])}}else if(r===K.current){if(null===(s=r.alternate))throw Error(a(387));s.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==e?e.push(uh):e=[uh])}r=r.return}null!==e&&xr(t,e,n,i),t.flags|=262144}function _r(e){for(e=e.firstContext;null!==e;){if(!Xn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ir(e){wr=e,Cr=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Nr(e){return Mr(wr,e)}function Dr(e,t){return null===wr&&Ir(e),Mr(e,t)}function Mr(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Cr){if(null===e)throw Error(a(308));Cr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Cr=Cr.next=t;return n}var Ar="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Lr=i.unstable_scheduleCallback,Ur=i.unstable_NormalPriority,jr={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fr(){return{controller:new Ar,data:new Map,refCount:0}}function Br(e){e.refCount--,0===e.refCount&&Lr(Ur,function(){e.controller.abort()})}var zr=null,Vr=0,qr=0,Hr=null;function Wr(){if(0===--Vr&&null!==zr){null!==Hr&&(Hr.status="fulfilled");var e=zr;zr=null,qr=0,Hr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Gr=M.S;M.S=function(e,t){Dl=ce(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===zr){var n=zr=[];Vr=0,qr=Vu(),Hr={status:"pending",value:void 0,then:function(e){n.push(e)}}}Vr++,t.then(Wr,Wr)}(0,t),null!==Gr&&Gr(e,t)};var Kr=F(null);function Jr(){var e=Kr.current;return null!==e?e:fl.pooledCache}function Qr(e,t){z(Kr,null===t?Kr.current:t.pool)}function $r(){var e=Jr();return null===e?null:{parent:jr._currentValue,pool:e}}var Yr=Error(a(460)),Xr=Error(a(474)),Zr=Error(a(542)),eo={then:function(){}};function to(e){return"fulfilled"===(e=e.status)||"rejected"===e}function no(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Nt,Nt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ao(e=t.reason),e;default:if("string"===typeof t.status)t.then(Nt,Nt);else{if(null!==(e=fl)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ao(e=t.reason),e}throw ro=t,Yr}}function io(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw ro=t,Yr;throw t}}var ro=null;function oo(){if(null===ro)throw Error(a(459));var e=ro;return ro=null,e}function ao(e){if(e===Yr||e===Zr)throw Error(a(483))}var so=null,co=0;function lo(e){var t=co;return co+=1,null===so&&(so=[]),no(so,e,t)}function uo(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function ho(e,t){if(t.$$typeof===f)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function po(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(e,t){return(e=Bi(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=67108866,n):i:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function c(e,t,n,i){return null===t||6!==t.tag?((t=Hi(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function l(e,t,n,i){var o=n.type;return o===v?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===P&&io(o)===t.type)?(uo(t=r(t,n.props),n),t.return=e,t):(uo(t=Vi(n.type,n.key,n.props,null,e.mode,i),n),t.return=e,t)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Gi(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,i,o){return null===t||7!==t.tag?((t=qi(n,e.mode,i,o)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Hi(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case m:return uo(n=Vi(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=Gi(t,e.mode,n)).return=e,t;case P:return h(e,t=io(t),n)}if(D(t)||_(t))return(t=qi(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,lo(t),n);if(t.$$typeof===S)return h(e,Dr(e,t),n);ho(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==r?null:c(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case m:return n.key===r?l(e,t,n,i):null;case g:return n.key===r?u(e,t,n,i):null;case P:return p(e,t,n=io(n),i)}if(D(n)||_(n))return null!==r?null:d(e,t,n,i,null);if("function"===typeof n.then)return p(e,t,lo(n),i);if(n.$$typeof===S)return p(e,t,Dr(e,n),i);ho(e,n)}return null}function f(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i||"bigint"===typeof i)return c(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case m:return l(t,e=e.get(null===i.key?n:i.key)||null,i,r);case g:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case P:return f(e,t,n,i=io(i),r)}if(D(i)||_(i))return d(t,e=e.get(n)||null,i,r,null);if("function"===typeof i.then)return f(e,t,n,lo(i),r);if(i.$$typeof===S)return f(e,t,n,Dr(t,i),r);ho(t,i)}return null}function y(c,l,u,d){if("object"===typeof u&&null!==u&&u.type===v&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case m:e:{for(var b=u.key;null!==l;){if(l.key===b){if((b=u.type)===v){if(7===l.tag){n(c,l.sibling),(d=r(l,u.props.children)).return=c,c=d;break e}}else if(l.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===P&&io(b)===l.type){n(c,l.sibling),uo(d=r(l,u.props),u),d.return=c,c=d;break e}n(c,l);break}t(c,l),l=l.sibling}u.type===v?((d=qi(u.props.children,c.mode,d,u.key)).return=c,c=d):(uo(d=Vi(u.type,u.key,u.props,null,c.mode,d),u),d.return=c,c=d)}return s(c);case g:e:{for(b=u.key;null!==l;){if(l.key===b){if(4===l.tag&&l.stateNode.containerInfo===u.containerInfo&&l.stateNode.implementation===u.implementation){n(c,l.sibling),(d=r(l,u.children||[])).return=c,c=d;break e}n(c,l);break}t(c,l),l=l.sibling}(d=Gi(u,c.mode,d)).return=c,c=d}return s(c);case P:return y(c,l,u=io(u),d)}if(D(u))return function(r,a,s,c){for(var l=null,u=null,d=a,m=a=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(r,d,s[m],c);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(r,d),a=o(v,a,m),null===u?l=v:u.sibling=v,u=v,d=g}if(m===s.length)return n(r,d),dr&&rr(r,m),l;if(null===d){for(;m<s.length;m++)null!==(d=h(r,s[m],c))&&(a=o(d,a,m),null===u?l=d:u.sibling=d,u=d);return dr&&rr(r,m),l}for(d=i(d);m<s.length;m++)null!==(g=f(d,r,m,s[m],c))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),a=o(g,a,m),null===u?l=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(r,e)}),dr&&rr(r,m),l}(c,l,u,d);if(_(u)){if("function"!==typeof(b=_(u)))throw Error(a(150));return function(r,s,c,l){if(null==c)throw Error(a(151));for(var u=null,d=null,m=s,g=s=0,v=null,y=c.next();null!==m&&!y.done;g++,y=c.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(r,m,y.value,l);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(r,m),s=o(b,s,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(r,m),dr&&rr(r,g),u;if(null===m){for(;!y.done;g++,y=c.next())null!==(y=h(r,y.value,l))&&(s=o(y,s,g),null===d?u=y:d.sibling=y,d=y);return dr&&rr(r,g),u}for(m=i(m);!y.done;g++,y=c.next())null!==(y=f(m,r,g,y.value,l))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=o(y,s,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach(function(e){return t(r,e)}),dr&&rr(r,g),u}(c,l,u=b.call(u),d)}if("function"===typeof u.then)return y(c,l,lo(u),d);if(u.$$typeof===S)return y(c,l,Dr(c,u),d);ho(c,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==l&&6===l.tag?(n(c,l.sibling),(d=r(l,u)).return=c,c=d):(n(c,l),(d=Hi(u,c.mode,d)).return=c,c=d),s(c)):n(c,l)}return function(e,t,n,i){try{co=0;var r=y(e,t,n,i);return so=null,r}catch(a){if(a===Yr||a===Zr)throw a;var o=ji(29,a,null,e.mode);return o.lanes=i,o.return=e,o}}}var fo=po(!0),mo=po(!1),go=!1;function vo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bo(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ko(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&pl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,t=Ai(e),Mi(e,null,n),t}return Ii(e,i,t,n),Ai(e)}function So(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Me(e,n)}}function To(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?r=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?r=o=t:o=o.next=t}else r=o=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,callbacks:i.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var wo=!1;function Co(){if(wo){if(null!==Hr)throw Hr}}function Eo(e,t,n,i){wo=!1;var r=e.updateQueue;go=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var c=s,l=c.next;c.next=null,null===a?o=l:a.next=l,a=c;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(null!==o){var d=r.baseState;for(a=0,u=l=c=null,s=o;;){var h=-536870913&s.lane,f=h!==s.lane;if(f?(gl&h)===h:(i&h)===h){0!==h&&h===qr&&(wo=!0),null!==u&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var m=e,g=s;h=t;var v=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){d=m.call(v,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=g.payload)?m.call(v,d,h):m)||void 0===h)break e;d=p({},d,h);break e;case 2:go=!0}}null!==(h=s.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=r.callbacks)?r.callbacks=[h]:f.push(h))}else f={lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(l=u=f,c=d):u=u.next=f,a|=h;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(f=s).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}null===u&&(c=d),r.baseState=c,r.firstBaseUpdate=l,r.lastBaseUpdate=u,null===o&&(r.shared.lanes=0),Cl|=a,e.lanes=a,e.memoizedState=d}}function Po(e,t){if("function"!==typeof e)throw Error(a(191,e));e.call(t)}function Ro(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Po(n[e],t)}var xo=F(null),Oo=F(0);function _o(e,t){z(Oo,e=Tl),z(xo,t),Tl=e|t.baseLanes}function Io(){z(Oo,Tl),z(xo,xo.current)}function No(){Tl=Oo.current,B(xo),B(Oo)}var Do=F(null),Mo=null;function Ao(e){var t=e.alternate;z(Bo,1&Bo.current),z(Do,e),null===Mo&&(null===t||null!==xo.current||null!==t.memoizedState)&&(Mo=e)}function Lo(e){z(Bo,Bo.current),z(Do,e),null===Mo&&(Mo=e)}function Uo(e){22===e.tag?(z(Bo,Bo.current),z(Do,e),null===Mo&&(Mo=e)):jo()}function jo(){z(Bo,Bo.current),z(Do,Do.current)}function Fo(e){B(Do),Mo===e&&(Mo=null),B(Bo)}var Bo=F(0);function zo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Id(n)||Nd(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vo=0,qo=null,Ho=null,Wo=null,Go=!1,Ko=!1,Jo=!1,Qo=0,$o=0,Yo=null,Xo=0;function Zo(){throw Error(a(321))}function ea(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Xn(e[n],t[n]))return!1;return!0}function ta(e,t,n,i,r,o){return Vo=o,qo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,M.H=null===e||null===e.memoizedState?gs:vs,Jo=!1,o=n(i,r),Jo=!1,Ko&&(o=ia(t,n,i,r)),na(e),o}function na(e){M.H=ms;var t=null!==Ho&&null!==Ho.next;if(Vo=0,Wo=Ho=qo=null,Go=!1,$o=0,Yo=null,t)throw Error(a(300));null===e||Ds||null!==(e=e.dependencies)&&_r(e)&&(Ds=!0)}function ia(e,t,n,i){qo=e;var r=0;do{if(Ko&&(Yo=null),$o=0,Ko=!1,25<=r)throw Error(a(301));if(r+=1,Wo=Ho=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}M.H=ys,o=t(n,i)}while(Ko);return o}function ra(){var e=M.H,t=e.useState()[0];return t="function"===typeof t.then?ua(t):t,e=e.useState()[0],(null!==Ho?Ho.memoizedState:null)!==e&&(qo.flags|=1024),t}function oa(){var e=0!==Qo;return Qo=0,e}function aa(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function sa(e){if(Go){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Go=!1}Vo=0,Wo=Ho=qo=null,Ko=!1,$o=Qo=0,Yo=null}function ca(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Wo?qo.memoizedState=Wo=e:Wo=Wo.next=e,Wo}function la(){if(null===Ho){var e=qo.alternate;e=null!==e?e.memoizedState:null}else e=Ho.next;var t=null===Wo?qo.memoizedState:Wo.next;if(null!==t)Wo=t,Ho=e;else{if(null===e){if(null===qo.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(Ho=e).memoizedState,baseState:Ho.baseState,baseQueue:Ho.baseQueue,queue:Ho.queue,next:null},null===Wo?qo.memoizedState=Wo=e:Wo=Wo.next=e}return Wo}function ua(e){var t=$o;return $o+=1,null===Yo&&(Yo=[]),e=no(Yo,e,t),t=qo,null===(null===Wo?t.memoizedState:Wo.next)&&(t=t.alternate,M.H=null===t||null===t.memoizedState?gs:vs),e}function da(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return ua(e);if(e.$$typeof===S)return Nr(e)}throw Error(a(438,String(e)))}function ha(e){var t=null,n=qo.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var i=qo.alternate;null!==i&&(null!==(i=i.updateQueue)&&(null!=(i=i.memoCache)&&(t={data:i.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},qo.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=x;return t.index++,n}function pa(e,t){return"function"===typeof t?t(e):t}function fa(e){return ma(la(),Ho,e)}function ma(e,t,n){var i=e.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=n;var r=e.baseQueue,o=i.pending;if(null!==o){if(null!==r){var s=r.next;r.next=o.next,o.next=s}t.baseQueue=r=o,i.pending=null}if(o=e.baseState,null===r)e.memoizedState=o;else{var c=s=null,l=null,u=t=r.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(gl&h)===h:(Vo&h)===h){var p=u.revertLane;if(0===p)null!==l&&(l=l.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===qr&&(d=!0);else{if((Vo&p)===p){u=u.next,p===qr&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===l?(c=l=h,s=o):l=l.next=h,qo.lanes|=p,Cl|=p}h=u.action,Jo&&n(o,h),o=u.hasEagerState?u.eagerState:n(o,h)}else p={lane:h,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===l?(c=l=p,s=o):l=l.next=p,qo.lanes|=h,Cl|=h;u=u.next}while(null!==u&&u!==t);if(null===l?s=o:l.next=c,!Xn(o,e.memoizedState)&&(Ds=!0,d&&null!==(n=Hr)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=l,i.lastRenderedState=o}return null===r&&(i.lanes=0),[e.memoizedState,i.dispatch]}function ga(e){var t=la(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{o=e(o,s.action),s=s.next}while(s!==r);Xn(o,t.memoizedState)||(Ds=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function va(e,t,n){var i=qo,r=la(),o=dr;if(o){if(void 0===n)throw Error(a(407));n=n()}else n=t();var s=!Xn((Ho||r).memoizedState,n);if(s&&(r.memoizedState=n,Ds=!0),r=r.queue,Va(ka.bind(null,i,r,e),[e]),r.getSnapshot!==t||s||null!==Wo&&1&Wo.memoizedState.tag){if(i.flags|=2048,Ua(9,{destroy:void 0},ba.bind(null,i,r,n,t),null),null===fl)throw Error(a(349));o||0!==(127&Vo)||ya(i,t,n)}return n}function ya(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=qo.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},qo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ba(e,t,n,i){t.value=n,t.getSnapshot=i,Sa(t)&&Ta(e)}function ka(e,t,n){return n(function(){Sa(t)&&Ta(e)})}function Sa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Xn(e,n)}catch(i){return!0}}function Ta(e){var t=Di(e,2);null!==t&&Jl(t,e,2)}function wa(e){var t=ca();if("function"===typeof e){var n=e;if(e=n(),Jo){be(!0);try{n()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:e},t}function Ca(e,t,n,i){return e.baseState=n,ma(e,Ho,"function"===typeof i?i:pa)}function Ea(e,t,n,i,r){if(hs(e))throw Error(a(485));if(null!==(e=t.action)){var o={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==M.T?n(!0):o.isTransition=!1,i(o),null===(n=t.pending)?(o.next=t.pending=o,Pa(t,o)):(o.next=n.next,t.pending=n.next=o)}}function Pa(e,t){var n=t.action,i=t.payload,r=e.state;if(t.isTransition){var o=M.T,a={};M.T=a;try{var s=n(r,i),c=M.S;null!==c&&c(a,s),Ra(e,t,s)}catch(l){Oa(e,t,l)}finally{null!==o&&null!==a.types&&(o.types=a.types),M.T=o}}else try{Ra(e,t,o=n(r,i))}catch(u){Oa(e,t,u)}}function Ra(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){xa(e,t,n)},function(n){return Oa(e,t,n)}):xa(e,t,n)}function xa(e,t,n){t.status="fulfilled",t.value=n,_a(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Pa(e,n)))}function Oa(e,t,n){var i=e.pending;if(e.pending=null,null!==i){i=i.next;do{t.status="rejected",t.reason=n,_a(t),t=t.next}while(t!==i)}e.action=null}function _a(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ia(e,t){return t}function Na(e,t){if(dr){var n=fl.formState;if(null!==n){e:{var i=qo;if(dr){if(ur){t:{for(var r=ur,o=pr;8!==r.nodeType;){if(!o){r=null;break t}if(null===(r=Dd(r.nextSibling))){r=null;break t}}r="F!"===(o=r.data)||"F"===o?r:null}if(r){ur=Dd(r.nextSibling),i="F!"===r.data;break e}}mr(i)}i=!1}i&&(t=n[0])}}return(n=ca()).memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:t},n.queue=i,n=ls.bind(null,qo,i),i.dispatch=n,i=wa(!1),o=ds.bind(null,qo,!1,i.queue),r={state:t,dispatch:null,action:e,pending:null},(i=ca()).queue=r,n=Ea.bind(null,qo,r,o,n),r.dispatch=n,i.memoizedState=e,[t,n,!1]}function Da(e){return Ma(la(),Ho,e)}function Ma(e,t,n){if(t=ma(e,t,Ia)[0],e=fa(pa)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var i=ua(t)}catch(a){if(a===Yr)throw Zr;throw a}else i=t;var r=(t=la()).queue,o=r.dispatch;return n!==t.memoizedState&&(qo.flags|=2048,Ua(9,{destroy:void 0},Aa.bind(null,r,n),null)),[i,o,e]}function Aa(e,t){e.action=t}function La(e){var t=la(),n=Ho;if(null!==n)return Ma(t,n,e);la(),t=t.memoizedState;var i=(n=la()).queue.dispatch;return n.memoizedState=e,[t,i,!1]}function Ua(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},null===(t=qo.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},qo.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function ja(){return la().memoizedState}function Fa(e,t,n,i){var r=ca();qo.flags|=e,r.memoizedState=Ua(1|t,{destroy:void 0},n,void 0===i?null:i)}function Ba(e,t,n,i){var r=la();i=void 0===i?null:i;var o=r.memoizedState.inst;null!==Ho&&null!==i&&ea(i,Ho.memoizedState.deps)?r.memoizedState=Ua(t,o,n,i):(qo.flags|=e,r.memoizedState=Ua(1|t,o,n,i))}function za(e,t){Fa(8390656,8,e,t)}function Va(e,t){Ba(2048,8,e,t)}function qa(e){var t=la().memoizedState;return function(e){qo.flags|=4;var t=qo.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},qo.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&pl))throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Ha(e,t){return Ba(4,2,e,t)}function Wa(e,t){return Ba(4,4,e,t)}function Ga(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ka(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Ba(4,4,Ga.bind(null,t,e),n)}function Ja(){}function Qa(e,t){var n=la();t=void 0===t?null:t;var i=n.memoizedState;return null!==t&&ea(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function $a(e,t){var n=la();t=void 0===t?null:t;var i=n.memoizedState;if(null!==t&&ea(t,i[1]))return i[0];if(i=e(),Jo){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[i,t],i}function Ya(e,t,n){return void 0===n||0!==(1073741824&Vo)&&0===(261930&gl)?e.memoizedState=t:(e.memoizedState=n,e=Kl(),qo.lanes|=e,Cl|=e,n)}function Xa(e,t,n,i){return Xn(n,t)?n:null!==xo.current?(e=Ya(e,n,i),Xn(e,t)||(Ds=!0),e):0===(42&Vo)||0!==(1073741824&Vo)&&0===(261930&gl)?(Ds=!0,e.memoizedState=n):(e=Kl(),qo.lanes|=e,Cl|=e,t)}function Za(e,t,n,i,r){var o=A.p;A.p=0!==o&&8>o?o:8;var a=M.T,s={};M.T=s,ds(e,!1,t,n);try{var c=r(),l=M.S;if(null!==l&&l(s,c),null!==c&&"object"===typeof c&&"function"===typeof c.then)us(e,t,function(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(i.status="rejected",i.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),i}(c,i),Gl());else us(e,t,i,Gl())}catch(u){us(e,t,{then:function(){},status:"rejected",reason:u},Gl())}finally{A.p=o,null!==a&&null!==s.types&&(a.types=s.types),M.T=a}}function es(){}function ts(e,t,n,i){if(5!==e.tag)throw Error(a(476));var r=ns(e).queue;Za(e,r,t,L,null===n?es:function(){return is(e),n(i)})}function ns(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:L},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function is(e){var t=ns(e);null===t.next&&(t=e.alternate.memoizedState),us(e,t.next.queue,{},Gl())}function rs(){return Nr(uh)}function os(){return la().memoizedState}function as(){return la().memoizedState}function ss(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Gl(),i=ko(t,e=bo(n),n);return null!==i&&(Jl(i,t,n),So(i,t,n)),t={cache:Fr()},void(e.payload=t)}t=t.return}}function cs(e,t,n){var i=Gl();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},hs(e)?ps(t,n):null!==(n=Ni(e,t,n,i))&&(Jl(n,e,i),fs(n,t,i))}function ls(e,t,n){us(e,t,n,Gl())}function us(e,t,n,i){var r={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(hs(e))ps(t,r);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(r.hasEagerState=!0,r.eagerState=s,Xn(s,a))return Ii(e,t,r,0),null===fl&&_i(),!1}catch(c){}if(null!==(n=Ni(e,t,r,i)))return Jl(n,e,i),fs(n,t,i),!0}return!1}function ds(e,t,n,i){if(i={lane:2,revertLane:Vu(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},hs(e)){if(t)throw Error(a(479))}else null!==(t=Ni(e,n,i,2))&&Jl(t,e,2)}function hs(e){var t=e.alternate;return e===qo||null!==t&&t===qo}function ps(e,t){Ko=Go=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function fs(e,t,n){if(0!==(4194048&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Me(e,n)}}var ms={readContext:Nr,use:da,useCallback:Zo,useContext:Zo,useEffect:Zo,useImperativeHandle:Zo,useLayoutEffect:Zo,useInsertionEffect:Zo,useMemo:Zo,useReducer:Zo,useRef:Zo,useState:Zo,useDebugValue:Zo,useDeferredValue:Zo,useTransition:Zo,useSyncExternalStore:Zo,useId:Zo,useHostTransitionStatus:Zo,useFormState:Zo,useActionState:Zo,useOptimistic:Zo,useMemoCache:Zo,useCacheRefresh:Zo};ms.useEffectEvent=Zo;var gs={readContext:Nr,use:da,useCallback:function(e,t){return ca().memoizedState=[e,void 0===t?null:t],e},useContext:Nr,useEffect:za,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Fa(4194308,4,Ga.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fa(4194308,4,e,t)},useInsertionEffect:function(e,t){Fa(4,2,e,t)},useMemo:function(e,t){var n=ca();t=void 0===t?null:t;var i=e();if(Jo){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=ca();if(void 0!==n){var r=n(t);if(Jo){be(!0);try{n(t)}finally{be(!1)}}}else r=t;return i.memoizedState=i.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},i.queue=e,e=e.dispatch=cs.bind(null,qo,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},ca().memoizedState=e},useState:function(e){var t=(e=wa(e)).queue,n=ls.bind(null,qo,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ja,useDeferredValue:function(e,t){return Ya(ca(),e,t)},useTransition:function(){var e=wa(!1);return e=Za.bind(null,qo,e.queue,!0,!1),ca().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=qo,r=ca();if(dr){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===fl)throw Error(a(349));0!==(127&gl)||ya(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,za(ka.bind(null,i,o,e),[e]),i.flags|=2048,Ua(9,{destroy:void 0},ba.bind(null,i,o,n,t),null),n},useId:function(){var e=ca(),t=fl.identifierPrefix;if(dr){var n=ir;t="_"+t+"R_"+(n=(nr&~(1<<32-ke(nr)-1)).toString(32)+n),0<(n=Qo++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Xo++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:rs,useFormState:Na,useActionState:Na,useOptimistic:function(e){var t=ca();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ds.bind(null,qo,!0,n),n.dispatch=t,[e,t]},useMemoCache:ha,useCacheRefresh:function(){return ca().memoizedState=ss.bind(null,qo)},useEffectEvent:function(e){var t=ca(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&pl))throw Error(a(440));return n.impl.apply(void 0,arguments)}}},vs={readContext:Nr,use:da,useCallback:Qa,useContext:Nr,useEffect:Va,useImperativeHandle:Ka,useInsertionEffect:Ha,useLayoutEffect:Wa,useMemo:$a,useReducer:fa,useRef:ja,useState:function(){return fa(pa)},useDebugValue:Ja,useDeferredValue:function(e,t){return Xa(la(),Ho.memoizedState,e,t)},useTransition:function(){var e=fa(pa)[0],t=la().memoizedState;return["boolean"===typeof e?e:ua(e),t]},useSyncExternalStore:va,useId:os,useHostTransitionStatus:rs,useFormState:Da,useActionState:Da,useOptimistic:function(e,t){return Ca(la(),0,e,t)},useMemoCache:ha,useCacheRefresh:as};vs.useEffectEvent=qa;var ys={readContext:Nr,use:da,useCallback:Qa,useContext:Nr,useEffect:Va,useImperativeHandle:Ka,useInsertionEffect:Ha,useLayoutEffect:Wa,useMemo:$a,useReducer:ga,useRef:ja,useState:function(){return ga(pa)},useDebugValue:Ja,useDeferredValue:function(e,t){var n=la();return null===Ho?Ya(n,e,t):Xa(n,Ho.memoizedState,e,t)},useTransition:function(){var e=ga(pa)[0],t=la().memoizedState;return["boolean"===typeof e?e:ua(e),t]},useSyncExternalStore:va,useId:os,useHostTransitionStatus:rs,useFormState:La,useActionState:La,useOptimistic:function(e,t){var n=la();return null!==Ho?Ca(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ha,useCacheRefresh:as};function bs(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:p({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}ys.useEffectEvent=qa;var ks={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Gl(),r=bo(i);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=ko(e,r,i))&&(Jl(t,e,i),So(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Gl(),r=bo(i);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=ko(e,r,i))&&(Jl(t,e,i),So(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Gl(),i=bo(n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=ko(e,i,n))&&(Jl(t,e,n),So(t,e,n))}};function Ss(e,t,n,i,r,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!Zn(n,i)||!Zn(r,o))}function Ts(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&ks.enqueueReplaceState(t,t.state,null)}function ws(e,t){var n=t;if("ref"in t)for(var i in n={},t)"ref"!==i&&(n[i]=t[i]);if(e=e.defaultProps)for(var r in n===t&&(n=p({},n)),e)void 0===n[r]&&(n[r]=e[r]);return n}function Cs(e){Pi(e)}function Es(e){console.error(e)}function Ps(e){Pi(e)}function Rs(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function xs(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function Os(e,t,n){return(n=bo(n)).tag=3,n.payload={element:null},n.callback=function(){Rs(e,t)},n}function _s(e){return(e=bo(e)).tag=3,e}function Is(e,t,n,i){var r=n.type.getDerivedStateFromError;if("function"===typeof r){var o=i.value;e.payload=function(){return r(o)},e.callback=function(){xs(t,n,i)}}var a=n.stateNode;null!==a&&"function"===typeof a.componentDidCatch&&(e.callback=function(){xs(t,n,i),"function"!==typeof r&&(null===Ll?Ll=new Set([this]):Ll.add(this));var e=i.stack;this.componentDidCatch(i.value,{componentStack:null!==e?e:""})})}var Ns=Error(a(461)),Ds=!1;function Ms(e,t,n,i){t.child=null===e?mo(t,null,n,i):fo(t,e.child,n,i)}function As(e,t,n,i,r){n=n.render;var o=t.ref;if("ref"in i){var a={};for(var s in i)"ref"!==s&&(a[s]=i[s])}else a=i;return Ir(t),i=ta(e,t,n,a,o,r),s=oa(),null===e||Ds?(dr&&s&&ar(t),t.flags|=1,Ms(e,t,i,r),t.child):(aa(e,t,r),rc(e,t,r))}function Ls(e,t,n,i,r){if(null===e){var o=n.type;return"function"!==typeof o||Fi(o)||void 0!==o.defaultProps||null!==n.compare?((e=Vi(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Us(e,t,o,i,r))}if(o=e.child,!oc(e,r)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:Zn)(a,i)&&e.ref===t.ref)return rc(e,t,r)}return t.flags|=1,(e=Bi(o,i)).ref=t.ref,e.return=t,t.child=e}function Us(e,t,n,i,r){if(null!==e){var o=e.memoizedProps;if(Zn(o,i)&&e.ref===t.ref){if(Ds=!1,t.pendingProps=i=o,!oc(e,r))return t.lanes=e.lanes,rc(e,t,r);0!==(131072&e.flags)&&(Ds=!0)}}return Hs(e,t,n,i,r)}function js(e,t,n,i){var r=i.children,o=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===i.mode){if(0!==(128&t.flags)){if(o=null!==o?o.baseLanes|n:n,null!==e){for(i=t.child=e.child,r=0;null!==i;)r=r|i.lanes|i.childLanes,i=i.sibling;i=r&~o}else i=0,t.child=null;return Bs(e,t,o,n,i)}if(0===(536870912&n))return i=t.lanes=536870912,Bs(e,t,null!==o?o.baseLanes|n:n,n,i);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Qr(0,null!==o?o.cachePool:null),null!==o?_o(t,o):Io(),Uo(t)}else null!==o?(Qr(0,o.cachePool),_o(t,o),jo(),t.memoizedState=null):(null!==e&&Qr(0,null),Io(),jo());return Ms(e,t,r,n),t.child}function Fs(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Bs(e,t,n,i,r){var o=Jr();return o=null===o?null:{parent:jr._currentValue,pool:o},t.memoizedState={baseLanes:n,cachePool:o},null!==e&&Qr(0,null),Io(),Uo(t),null!==e&&Or(e,t,i,!0),t.childLanes=r,null}function zs(e,t){return(t=Zs({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Vs(e,t,n){return fo(t,e.child,null,n),(e=zs(t,t.pendingProps)).flags|=2,Fo(t),t.memoizedState=null,e}function qs(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Hs(e,t,n,i,r){return Ir(t),n=ta(e,t,n,i,void 0,r),i=oa(),null===e||Ds?(dr&&i&&ar(t),t.flags|=1,Ms(e,t,n,r),t.child):(aa(e,t,r),rc(e,t,r))}function Ws(e,t,n,i,r,o){return Ir(t),t.updateQueue=null,n=ia(t,i,n,r),na(e),i=oa(),null===e||Ds?(dr&&i&&ar(t),t.flags|=1,Ms(e,t,n,o),t.child):(aa(e,t,o),rc(e,t,o))}function Gs(e,t,n,i,r){if(Ir(t),null===t.stateNode){var o=Li,a=n.contextType;"object"===typeof a&&null!==a&&(o=Nr(a)),o=new n(i,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=ks,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=i,o.state=t.memoizedState,o.refs={},vo(t),a=n.contextType,o.context="object"===typeof a&&null!==a?Nr(a):Li,o.state=t.memoizedState,"function"===typeof(a=n.getDerivedStateFromProps)&&(bs(t,n,a,i),o.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(a=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),a!==o.state&&ks.enqueueReplaceState(o,o.state,null),Eo(t,i,o,r),Co(),o.state=t.memoizedState),"function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!0}else if(null===e){o=t.stateNode;var s=t.memoizedProps,c=ws(n,s);o.props=c;var l=o.context,u=n.contextType;a=Li,"object"===typeof u&&null!==u&&(a=Nr(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate,s=t.pendingProps!==s,u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s||l!==a)&&Ts(t,o,i,a),go=!1;var h=t.memoizedState;o.state=h,Eo(t,i,o,r),Co(),l=t.memoizedState,s||h!==l||go?("function"===typeof d&&(bs(t,n,d,i),l=t.memoizedState),(c=go||Ss(t,n,c,i,h,l,a))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=a,i=c):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,yo(e,t),u=ws(n,a=t.memoizedProps),o.props=u,d=t.pendingProps,h=o.context,l=n.contextType,c=Li,"object"===typeof l&&null!==l&&(c=Nr(l)),(l="function"===typeof(s=n.getDerivedStateFromProps)||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==d||h!==c)&&Ts(t,o,i,c),go=!1,h=t.memoizedState,o.state=h,Eo(t,i,o,r),Co();var p=t.memoizedState;a!==d||h!==p||go||null!==e&&null!==e.dependencies&&_r(e.dependencies)?("function"===typeof s&&(bs(t,n,s,i),p=t.memoizedState),(u=go||Ss(t,n,u,i,h,p,c)||null!==e&&null!==e.dependencies&&_r(e.dependencies))?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,p,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,p,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),o.props=i,o.state=p,o.context=c,i=u):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return o=i,qs(e,t),i=0!==(128&t.flags),o||i?(o=t.stateNode,n=i&&"function"!==typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&i?(t.child=fo(t,e.child,null,r),t.child=fo(t,null,n,r)):Ms(e,t,n,r),t.memoizedState=o.state,e=t.child):e=rc(e,t,r),e}function Ks(e,t,n,i){return br(),t.flags|=256,Ms(e,t,n,i),t.child}var Js={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qs(e){return{baseLanes:e,cachePool:$r()}}function $s(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Rl),e}function Ys(e,t,n){var i,r=t.pendingProps,o=!1,s=0!==(128&t.flags);if((i=s)||(i=(null===e||null!==e.memoizedState)&&0!==(2&Bo.current)),i&&(o=!0,t.flags&=-129),i=0!==(32&t.flags),t.flags&=-33,null===e){if(dr){if(o?Ao(t):jo(),(e=ur)?null!==(e=null!==(e=_d(e,pr))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==tr?{id:nr,overflow:ir}:null,retryLane:536870912,hydrationErrors:null},(n=Wi(e)).return=t,t.child=n,lr=t,ur=null):e=null,null===e)throw mr(t);return Nd(e)?t.lanes=32:t.lanes=536870912,null}var c=r.children;return r=r.fallback,o?(jo(),c=Zs({mode:"hidden",children:c},o=t.mode),r=qi(r,o,n,null),c.return=t,r.return=t,c.sibling=r,t.child=c,(r=t.child).memoizedState=Qs(n),r.childLanes=$s(e,i,n),t.memoizedState=Js,Fs(null,r)):(Ao(t),Xs(t,c))}var l=e.memoizedState;if(null!==l&&null!==(c=l.dehydrated)){if(s)256&t.flags?(Ao(t),t.flags&=-257,t=ec(e,t,n)):null!==t.memoizedState?(jo(),t.child=e.child,t.flags|=128,t=null):(jo(),c=r.fallback,o=t.mode,r=Zs({mode:"visible",children:r.children},o),(c=qi(c,o,n,null)).flags|=2,r.return=t,c.return=t,r.sibling=c,t.child=r,fo(t,e.child,null,n),(r=t.child).memoizedState=Qs(n),r.childLanes=$s(e,i,n),t.memoizedState=Js,t=Fs(null,r));else if(Ao(t),Nd(c)){if(i=c.nextSibling&&c.nextSibling.dataset)var u=i.dgst;i=u,(r=Error(a(419))).stack="",r.digest=i,Sr({value:r,source:null,stack:null}),t=ec(e,t,n)}else if(Ds||Or(e,t,n,!1),i=0!==(n&e.childLanes),Ds||i){if(null!==(i=fl)&&(0!==(r=Ae(i,n))&&r!==l.retryLane))throw l.retryLane=r,Di(e,r),Jl(i,e,r),Ns;Id(c)||au(),t=ec(e,t,n)}else Id(c)?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,ur=Dd(c.nextSibling),lr=t,dr=!0,hr=null,pr=!1,null!==e&&cr(t,e),(t=Xs(t,r.children)).flags|=4096);return t}return o?(jo(),c=r.fallback,o=t.mode,u=(l=e.child).sibling,(r=Bi(l,{mode:"hidden",children:r.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?c=Bi(u,c):(c=qi(c,o,n,null)).flags|=2,c.return=t,r.return=t,r.sibling=c,t.child=r,Fs(null,r),r=t.child,null===(c=e.child.memoizedState)?c=Qs(n):(null!==(o=c.cachePool)?(l=jr._currentValue,o=o.parent!==l?{parent:l,pool:l}:o):o=$r(),c={baseLanes:c.baseLanes|n,cachePool:o}),r.memoizedState=c,r.childLanes=$s(e,i,n),t.memoizedState=Js,Fs(e.child,r)):(Ao(t),e=(n=e.child).sibling,(n=Bi(n,{mode:"visible",children:r.children})).return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n)}function Xs(e,t){return(t=Zs({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Zs(e,t){return(e=ji(22,e,null,t)).lanes=0,e}function ec(e,t,n){return fo(t,e.child,null,n),(e=Xs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tc(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Rr(e.return,t,n)}function nc(e,t,n,i,r,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r,treeForkCount:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=r,a.treeForkCount=o)}function ic(e,t,n){var i=t.pendingProps,r=i.revealOrder,o=i.tail;i=i.children;var a=Bo.current,s=0!==(2&a);if(s?(a=1&a|2,t.flags|=128):a&=1,z(Bo,a),Ms(e,t,i,n),i=dr?Xi:0,!s&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tc(e,n,t);else if(19===e.tag)tc(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===zo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),nc(t,!1,r,n,o,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===zo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}nc(t,!0,n,null,o,i);break;case"together":nc(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function rc(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Cl|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Or(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Bi(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Bi(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function oc(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!_r(e))}function ac(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ds=!0;else{if(!oc(e,n)&&0===(128&t.flags))return Ds=!1,function(e,t,n){switch(t.tag){case 3:J(t,t.stateNode.containerInfo),Er(0,jr,e.memoizedState.cache),br();break;case 27:case 5:$(t);break;case 4:J(t,t.stateNode.containerInfo);break;case 10:Er(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Lo(t),null;break;case 13:var i=t.memoizedState;if(null!==i)return null!==i.dehydrated?(Ao(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Ys(e,t,n):(Ao(t),null!==(e=rc(e,t,n))?e.sibling:null);Ao(t);break;case 19:var r=0!==(128&e.flags);if((i=0!==(n&t.childLanes))||(Or(e,t,n,!1),i=0!==(n&t.childLanes)),r){if(i)return ic(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),z(Bo,Bo.current),i)break;return null;case 22:return t.lanes=0,js(e,t,n,t.pendingProps);case 24:Er(0,jr,e.memoizedState.cache)}return rc(e,t,n)}(e,t,n);Ds=0!==(131072&e.flags)}else Ds=!1,dr&&0!==(1048576&t.flags)&&or(t,Xi,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=io(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var r=e.$$typeof;if(r===T){t.tag=11,t=As(null,t,e,i,n);break e}if(r===E){t.tag=14,t=Ls(null,t,e,i,n);break e}}throw t=N(e)||e,Error(a(306,t,""))}Fi(e)?(i=ws(e,i),t.tag=1,t=Gs(null,t,e,i,n)):(t.tag=0,t=Hs(null,t,e,i,n))}return t;case 0:return Hs(e,t,t.type,t.pendingProps,n);case 1:return Gs(e,t,i=t.type,r=ws(i,t.pendingProps),n);case 3:e:{if(J(t,t.stateNode.containerInfo),null===e)throw Error(a(387));i=t.pendingProps;var o=t.memoizedState;r=o.element,yo(e,t),Eo(t,i,null,n);var s=t.memoizedState;if(i=s.cache,Er(0,jr,i),i!==o.cache&&xr(t,[jr],n,!0),Co(),i=s.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ks(e,t,i,n);break e}if(i!==r){Sr(r=Ji(Error(a(424)),t)),t=Ks(e,t,i,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ur=Dd(e.firstChild),lr=t,dr=!0,hr=null,pr=!0,n=mo(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(br(),i===r){t=rc(e,t,n);break e}Ms(e,t,i,n)}t=t.child}return t;case 26:return qs(e,t),null===e?(n=Wd(t.type,null,t.pendingProps,null))?t.memoizedState=n:dr||(n=t.type,e=t.pendingProps,(i=gd(G.current).createElement(n))[ze]=t,i[Ve]=e,hd(i,n,e),et(i),t.stateNode=i):t.memoizedState=Wd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return $(t),null===e&&dr&&(i=t.stateNode=Ud(t.type,t.pendingProps,G.current),lr=t,pr=!0,r=ur,Pd(t.type)?(Md=r,ur=Dd(i.firstChild)):ur=r),Ms(e,t,t.pendingProps.children,n),qs(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&dr&&((r=i=ur)&&(null!==(i=function(e,t,n,i){for(;1===e.nodeType;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(i){if(!e[Je])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==r.rel||e.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||e.getAttribute("title")!==(null==r.title?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==r.src?null:r.src)||e.getAttribute("type")!==(null==r.type?null:r.type)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==r.name?null:""+r.name;if("hidden"===r.type&&e.getAttribute("name")===o)return e}if(null===(e=Dd(e.nextSibling)))break}return null}(i,t.type,t.pendingProps,pr))?(t.stateNode=i,lr=t,ur=Dd(i.firstChild),pr=!1,r=!0):r=!1),r||mr(t)),$(t),r=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,i=o.children,bd(r,o)?i=null:null!==s&&bd(r,s)&&(t.flags|=32),null!==t.memoizedState&&(r=ta(e,t,ra,null,null,n),uh._currentValue=r),qs(e,t),Ms(e,t,i,n),t.child;case 6:return null===e&&dr&&((e=n=ur)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Dd(e.nextSibling)))return null}return e}(n,t.pendingProps,pr))?(t.stateNode=n,lr=t,ur=null,e=!0):e=!1),e||mr(t)),null;case 13:return Ys(e,t,n);case 4:return J(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=fo(t,null,i,n):Ms(e,t,i,n),t.child;case 11:return As(e,t,t.type,t.pendingProps,n);case 7:return Ms(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ms(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,Er(0,t.type,i.value),Ms(e,t,i.children,n),t.child;case 9:return r=t.type._context,i=t.pendingProps.children,Ir(t),i=i(r=Nr(r)),t.flags|=1,Ms(e,t,i,n),t.child;case 14:return Ls(e,t,t.type,t.pendingProps,n);case 15:return Us(e,t,t.type,t.pendingProps,n);case 19:return ic(e,t,n);case 31:return function(e,t,n){var i=t.pendingProps,r=0!==(128&t.flags);if(t.flags&=-129,null===e){if(dr){if("hidden"===i.mode)return e=zs(t,i),t.lanes=536870912,Fs(null,e);if(Lo(t),(e=ur)?null!==(e=null!==(e=_d(e,pr))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==tr?{id:nr,overflow:ir}:null,retryLane:536870912,hydrationErrors:null},(n=Wi(e)).return=t,t.child=n,lr=t,ur=null):e=null,null===e)throw mr(t);return t.lanes=536870912,null}return zs(t,i)}var o=e.memoizedState;if(null!==o){var s=o.dehydrated;if(Lo(t),r)if(256&t.flags)t.flags&=-257,t=Vs(e,t,n);else{if(null===t.memoizedState)throw Error(a(558));t.child=e.child,t.flags|=128,t=null}else if(Ds||Or(e,t,n,!1),r=0!==(n&e.childLanes),Ds||r){if(null!==(i=fl)&&0!==(s=Ae(i,n))&&s!==o.retryLane)throw o.retryLane=s,Di(e,s),Jl(i,e,s),Ns;au(),t=Vs(e,t,n)}else e=o.treeContext,ur=Dd(s.nextSibling),lr=t,dr=!0,hr=null,pr=!1,null!==e&&cr(t,e),(t=zs(t,i)).flags|=4096;return t}return(e=Bi(e.child,{mode:i.mode,children:i.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return js(e,t,n,t.pendingProps);case 24:return Ir(t),i=Nr(jr),null===e?(null===(r=Jr())&&(r=fl,o=Fr(),r.pooledCache=o,o.refCount++,null!==o&&(r.pooledCacheLanes|=n),r=o),t.memoizedState={parent:i,cache:r},vo(t),Er(0,jr,r)):(0!==(e.lanes&n)&&(yo(e,t),Eo(t,null,null,n),Co()),r=e.memoizedState,o=t.memoizedState,r.parent!==i?(r={parent:i,cache:i},t.memoizedState=r,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=r),Er(0,jr,i)):(i=o.cache,Er(0,jr,i),i!==r.cache&&xr(t,[jr],n,!0))),Ms(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function sc(e){e.flags|=4}function cc(e,t,n,i,r){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&r)===r)if(e.stateNode.complete)e.flags|=8192;else{if(!iu())throw ro=eo,Xr;e.flags|=8192}}else e.flags&=-16777217}function lc(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!rh(t)){if(!iu())throw ro=eo,Xr;e.flags|=8192}}function uc(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?_e():536870912,e.lanes|=t,xl|=t)}function dc(e,t){if(!dr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function hc(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=65011712&r.subtreeFlags,i|=65011712&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function pc(e,t,n){var i=t.pendingProps;switch(sr(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hc(t),null;case 3:return n=t.stateNode,i=null,null!==e&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Pr(jr),Q(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(yr(t)?sc(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,kr())),hc(t),null;case 26:var r=t.type,o=t.memoizedState;return null===e?(sc(t),null!==o?(hc(t),lc(t,o)):(hc(t),cc(t,r,0,0,n))):o?o!==e.memoizedState?(sc(t),hc(t),lc(t,o)):(hc(t),t.flags&=-16777217):((e=e.memoizedProps)!==i&&sc(t),hc(t),cc(t,r,0,0,n)),null;case 27:if(Y(t),n=G.current,r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&sc(t);else{if(!i){if(null===t.stateNode)throw Error(a(166));return hc(t),null}e=H.current,yr(t)?gr(t):(e=Ud(r,i,n),t.stateNode=e,sc(t))}return hc(t),null;case 5:if(Y(t),r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&sc(t);else{if(!i){if(null===t.stateNode)throw Error(a(166));return hc(t),null}if(o=H.current,yr(t))gr(t);else{var s=gd(G.current);switch(o){case 1:o=s.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:o=s.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":o=s.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":o=s.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":(o=s.createElement("div")).innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o="string"===typeof i.is?s.createElement("select",{is:i.is}):s.createElement("select"),i.multiple?o.multiple=!0:i.size&&(o.size=i.size);break;default:o="string"===typeof i.is?s.createElement(r,{is:i.is}):s.createElement(r)}}o[ze]=t,o[Ve]=i;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)o.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=o;e:switch(hd(o,r,i),r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&sc(t)}}return hc(t),cc(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==i&&sc(t);else{if("string"!==typeof i&&null===t.stateNode)throw Error(a(166));if(e=G.current,yr(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,null!==(r=lr))switch(r.tag){case 27:case 5:i=r.memoizedProps}e[ze]=t,(e=!!(e.nodeValue===n||null!==i&&!0===i.suppressHydrationWarning||ld(e.nodeValue,n)))||mr(t,!0)}else(e=gd(e).createTextNode(i))[ze]=t,t.stateNode=e}return hc(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(i=yr(t),null!==n){if(null===e){if(!i)throw Error(a(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(557));e[ze]=t}else br(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hc(t),e=!1}else n=kr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Fo(t),t):(Fo(t),null);if(0!==(128&t.flags))throw Error(a(558))}return hc(t),null;case 13:if(i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(r=yr(t),null!==i&&null!==i.dehydrated){if(null===e){if(!r)throw Error(a(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(a(317));r[ze]=t}else br(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hc(t),r=!1}else r=kr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&t.flags?(Fo(t),t):(Fo(t),null)}return Fo(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==i,e=null!==e&&null!==e.memoizedState,n&&(r=null,null!==(i=t.child).alternate&&null!==i.alternate.memoizedState&&null!==i.alternate.memoizedState.cachePool&&(r=i.alternate.memoizedState.cachePool.pool),o=null,null!==i.memoizedState&&null!==i.memoizedState.cachePool&&(o=i.memoizedState.cachePool.pool),o!==r&&(i.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),uc(t,t.updateQueue),hc(t),null);case 4:return Q(),null===e&&Zu(t.stateNode.containerInfo),hc(t),null;case 10:return Pr(t.type),hc(t),null;case 19:if(B(Bo),null===(i=t.memoizedState))return hc(t),null;if(r=0!==(128&t.flags),null===(o=i.rendering))if(r)dc(i,!1);else{if(0!==wl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=zo(e))){for(t.flags|=128,dc(i,!1),e=o.updateQueue,t.updateQueue=e,uc(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)zi(n,e),n=n.sibling;return z(Bo,1&Bo.current|2),dr&&rr(t,i.treeForkCount),t.child}e=e.sibling}null!==i.tail&&ce()>Ml&&(t.flags|=128,r=!0,dc(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=zo(o))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,uc(t,e),dc(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!dr)return hc(t),null}else 2*ce()-i.renderingStartTime>Ml&&536870912!==n&&(t.flags|=128,r=!0,dc(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=i.last)?e.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ce(),e.sibling=null,n=Bo.current,z(Bo,r?1&n|2:1&n),dr&&rr(t,i.treeForkCount),e):(hc(t),null);case 22:case 23:return Fo(t),No(),i=null!==t.memoizedState,null!==e?null!==e.memoizedState!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?0!==(536870912&n)&&0===(128&t.flags)&&(hc(t),6&t.subtreeFlags&&(t.flags|=8192)):hc(t),null!==(n=t.updateQueue)&&uc(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),i=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),null!==e&&B(Kr),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Pr(jr),hc(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function fc(e,t){switch(sr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Pr(jr),Q(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Y(t),null;case 31:if(null!==t.memoizedState){if(Fo(t),null===t.alternate)throw Error(a(340));br()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Fo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));br()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(Bo),null;case 4:return Q(),null;case 10:return Pr(t.type),null;case 22:case 23:return Fo(t),No(),null!==e&&B(Kr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Pr(jr),null;default:return null}}function mc(e,t){switch(sr(t),t.tag){case 3:Pr(jr),Q();break;case 26:case 27:case 5:Y(t);break;case 4:Q();break;case 31:null!==t.memoizedState&&Fo(t);break;case 13:Fo(t);break;case 19:B(Bo);break;case 10:Pr(t.type);break;case 22:case 23:Fo(t),No(),null!==e&&B(Kr);break;case 24:Pr(jr)}}function gc(e,t){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var r=i.next;n=r;do{if((n.tag&e)===e){i=void 0;var o=n.create,a=n.inst;i=o(),a.destroy=i}n=n.next}while(n!==r)}}catch(s){wu(t,t.return,s)}}function vc(e,t,n){try{var i=t.updateQueue,r=null!==i?i.lastEffect:null;if(null!==r){var o=r.next;i=o;do{if((i.tag&e)===e){var a=i.inst,s=a.destroy;if(void 0!==s){a.destroy=void 0,r=t;var c=n,l=s;try{l()}catch(u){wu(r,c,u)}}}i=i.next}while(i!==o)}}catch(u){wu(t,t.return,u)}}function yc(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ro(t,n)}catch(i){wu(e,e.return,i)}}}function bc(e,t,n){n.props=ws(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){wu(e,t,i)}}function kc(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;default:i=e.stateNode}"function"===typeof n?e.refCleanup=n(i):n.current=i}}catch(r){wu(e,t,r)}}function Sc(e,t){var n=e.ref,i=e.refCleanup;if(null!==n)if("function"===typeof i)try{i()}catch(r){wu(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(o){wu(e,t,o)}else n.current=null}function Tc(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(r){wu(e,e.return,r)}}function wc(e,t,n){try{var i=e.stateNode;!function(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,o=null,s=null,c=null,l=null,u=null,d=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&null!=h)switch(f){case"checked":case"value":break;case"defaultValue":l=h;default:i.hasOwnProperty(f)||ud(e,t,f,null,i,h)}}for(var p in i){var f=i[p];if(h=n[p],i.hasOwnProperty(p)&&(null!=f||null!=h))switch(p){case"type":o=f;break;case"name":r=f;break;case"checked":u=f;break;case"defaultChecked":d=f;break;case"value":s=f;break;case"defaultValue":c=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(a(137,t));break;default:f!==h&&ud(e,t,p,f,i,h)}}return void yt(e,s,c,l,u,d,o,r);case"select":for(o in f=s=c=p=null,n)if(l=n[o],n.hasOwnProperty(o)&&null!=l)switch(o){case"value":break;case"multiple":f=l;default:i.hasOwnProperty(o)||ud(e,t,o,null,i,l)}for(r in i)if(o=i[r],l=n[r],i.hasOwnProperty(r)&&(null!=o||null!=l))switch(r){case"value":p=o;break;case"defaultValue":c=o;break;case"multiple":s=o;default:o!==l&&ud(e,t,r,o,i,l)}return t=c,n=s,i=f,void(null!=p?St(e,!!n,p,!1):!!i!==!!n&&(null!=t?St(e,!!n,t,!0):St(e,!!n,n?[]:"",!1)));case"textarea":for(c in f=p=null,n)if(r=n[c],n.hasOwnProperty(c)&&null!=r&&!i.hasOwnProperty(c))switch(c){case"value":case"children":break;default:ud(e,t,c,null,i,r)}for(s in i)if(r=i[s],o=n[s],i.hasOwnProperty(s)&&(null!=r||null!=o))switch(s){case"value":p=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(a(91));break;default:r!==o&&ud(e,t,s,r,i,o)}return void Tt(e,p,f);case"option":for(var m in n)if(p=n[m],n.hasOwnProperty(m)&&null!=p&&!i.hasOwnProperty(m))if("selected"===m)e.selected=!1;else ud(e,t,m,null,i,p);for(l in i)if(p=i[l],f=n[l],i.hasOwnProperty(l)&&p!==f&&(null!=p||null!=f))if("selected"===l)e.selected=p&&"function"!==typeof p&&"symbol"!==typeof p;else ud(e,t,l,p,i,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)p=n[g],n.hasOwnProperty(g)&&null!=p&&!i.hasOwnProperty(g)&&ud(e,t,g,null,i,p);for(u in i)if(p=i[u],f=n[u],i.hasOwnProperty(u)&&p!==f&&(null!=p||null!=f))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(a(137,t));break;default:ud(e,t,u,p,i,f)}return;default:if(xt(t)){for(var v in n)p=n[v],n.hasOwnProperty(v)&&void 0!==p&&!i.hasOwnProperty(v)&&dd(e,t,v,void 0,i,p);for(d in i)p=i[d],f=n[d],!i.hasOwnProperty(d)||p===f||void 0===p&&void 0===f||dd(e,t,d,p,i,f);return}}for(var y in n)p=n[y],n.hasOwnProperty(y)&&null!=p&&!i.hasOwnProperty(y)&&ud(e,t,y,null,i,p);for(h in i)p=i[h],f=n[h],!i.hasOwnProperty(h)||p===f||null==p&&null==f||ud(e,t,h,p,i,f)}(i,e.type,n,t),i[Ve]=t}catch(r){wu(e,e.return,r)}}function Cc(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Pd(e.type)||4===e.tag}function Ec(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Cc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Pd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Pc(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Nt));else if(4!==i&&(27===i&&Pd(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Pc(e,t,n),e=e.sibling;null!==e;)Pc(e,t,n),e=e.sibling}function Rc(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&(27===i&&Pd(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Rc(e,t,n),e=e.sibling;null!==e;)Rc(e,t,n),e=e.sibling}function xc(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);hd(t,i,n),t[ze]=e,t[Ve]=n}catch(o){wu(e,e.return,o)}}var Oc=!1,_c=!1,Ic=!1,Nc="function"===typeof WeakSet?WeakSet:Set,Dc=null;function Mc(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Jc(e,n),4&i&&gc(5,n);break;case 1:if(Jc(e,n),4&i)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(a){wu(n,n.return,a)}else{var r=ws(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){wu(n,n.return,s)}}64&i&&yc(n),512&i&&kc(n,n.return);break;case 3:if(Jc(e,n),64&i&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Ro(e,t)}catch(a){wu(n,n.return,a)}}break;case 27:null===t&&4&i&&xc(n);case 26:case 5:Jc(e,n),null===t&&4&i&&Tc(n),512&i&&kc(n,n.return);break;case 12:Jc(e,n);break;case 31:Jc(e,n),4&i&&Bc(e,n);break;case 13:Jc(e,n),4&i&&zc(e,n),64&i&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}(e,n=Ru.bind(null,n))));break;case 22:if(!(i=null!==n.memoizedState||Oc)){t=null!==t&&null!==t.memoizedState||_c,r=Oc;var o=_c;Oc=i,(_c=t)&&!o?$c(e,n,0!==(8772&n.subtreeFlags)):Jc(e,n),Oc=r,_c=o}break;case 30:break;default:Jc(e,n)}}function Ac(e){var t=e.alternate;null!==t&&(e.alternate=null,Ac(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Qe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Lc=null,Uc=!1;function jc(e,t,n){for(n=n.child;null!==n;)Fc(e,t,n),n=n.sibling}function Fc(e,t,n){if(ye&&"function"===typeof ye.onCommitFiberUnmount)try{ye.onCommitFiberUnmount(ve,n)}catch(o){}switch(n.tag){case 26:_c||Sc(n,t),jc(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:_c||Sc(n,t);var i=Lc,r=Uc;Pd(n.type)&&(Lc=n.stateNode,Uc=!1),jc(e,t,n),jd(n.stateNode),Lc=i,Uc=r;break;case 5:_c||Sc(n,t);case 6:if(i=Lc,r=Uc,Lc=null,jc(e,t,n),Uc=r,null!==(Lc=i))if(Uc)try{(9===Lc.nodeType?Lc.body:"HTML"===Lc.nodeName?Lc.ownerDocument.body:Lc).removeChild(n.stateNode)}catch(a){wu(n,t,a)}else try{Lc.removeChild(n.stateNode)}catch(a){wu(n,t,a)}break;case 18:null!==Lc&&(Uc?(Rd(9===(e=Lc).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Hh(e)):Rd(Lc,n.stateNode));break;case 4:i=Lc,r=Uc,Lc=n.stateNode.containerInfo,Uc=!0,jc(e,t,n),Lc=i,Uc=r;break;case 0:case 11:case 14:case 15:vc(2,n,t),_c||vc(4,n,t),jc(e,t,n);break;case 1:_c||(Sc(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount&&bc(n,t,i)),jc(e,t,n);break;case 21:jc(e,t,n);break;case 22:_c=(i=_c)||null!==n.memoizedState,jc(e,t,n),_c=i;break;default:jc(e,t,n)}}function Bc(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Hh(e)}catch(n){wu(t,t.return,n)}}}function zc(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Hh(e)}catch(n){wu(t,t.return,n)}}function Vc(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Nc),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Nc),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var i=xu.bind(null,e,t);t.then(i,i)}})}function qc(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i],o=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 27:if(Pd(c.type)){Lc=c.stateNode,Uc=!1;break e}break;case 5:Lc=c.stateNode,Uc=!1;break e;case 3:case 4:Lc=c.stateNode.containerInfo,Uc=!0;break e}c=c.return}if(null===Lc)throw Error(a(160));Fc(o,s,r),Lc=null,Uc=!1,null!==(o=r.alternate)&&(o.return=null),r.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Wc(t,e),t=t.sibling}var Hc=null;function Wc(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:qc(t,e),Gc(e),4&i&&(vc(3,e,e.return),gc(3,e),vc(5,e,e.return));break;case 1:qc(t,e),Gc(e),512&i&&(_c||null===n||Sc(n,n.return)),64&i&&Oc&&(null!==(e=e.updateQueue)&&(null!==(i=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?i:n.concat(i))));break;case 26:var r=Hc;if(qc(t,e),Gc(e),512&i&&(_c||null===n||Sc(n,n.return)),4&i){var o=null!==n?n.memoizedState:null;if(i=e.memoizedState,null===n)if(null===i)if(null===e.stateNode){e:{i=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(i){case"title":(!(o=r.getElementsByTagName("title")[0])||o[Je]||o[ze]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=r.createElement(i),r.head.insertBefore(o,r.querySelector("head > title"))),hd(o,i,n),o[ze]=e,et(o),i=o;break e;case"link":var s=nh("link","href",r).get(i+(n.href||""));if(s)for(var c=0;c<s.length;c++)if((o=s[c]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(c,1);break t}hd(o=r.createElement(i),i,n),r.head.appendChild(o);break;case"meta":if(s=nh("meta","content",r).get(i+(n.content||"")))for(c=0;c<s.length;c++)if((o=s[c]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(c,1);break t}hd(o=r.createElement(i),i,n),r.head.appendChild(o);break;default:throw Error(a(468,i))}o[ze]=e,et(o),i=o}e.stateNode=i}else ih(r,e.type,e.stateNode);else e.stateNode=Yd(r,i,e.memoizedProps);else o!==i?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===i?ih(r,e.type,e.stateNode):Yd(r,i,e.memoizedProps)):null===i&&null!==e.stateNode&&wc(e,e.memoizedProps,n.memoizedProps)}break;case 27:qc(t,e),Gc(e),512&i&&(_c||null===n||Sc(n,n.return)),null!==n&&4&i&&wc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(qc(t,e),Gc(e),512&i&&(_c||null===n||Sc(n,n.return)),32&e.flags){r=e.stateNode;try{Ct(r,"")}catch(m){wu(e,e.return,m)}}4&i&&null!=e.stateNode&&wc(e,r=e.memoizedProps,null!==n?n.memoizedProps:r),1024&i&&(Ic=!0);break;case 6:if(qc(t,e),Gc(e),4&i){if(null===e.stateNode)throw Error(a(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(m){wu(e,e.return,m)}}break;case 3:if(th=null,r=Hc,Hc=zd(t.containerInfo),qc(t,e),Hc=r,Gc(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Hh(t.containerInfo)}catch(m){wu(e,e.return,m)}Ic&&(Ic=!1,Kc(e));break;case 4:i=Hc,Hc=zd(e.stateNode.containerInfo),qc(t,e),Gc(e),Hc=i;break;case 12:default:qc(t,e),Gc(e);break;case 31:case 19:qc(t,e),Gc(e),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,Vc(e,i)));break;case 13:qc(t,e),Gc(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Nl=ce()),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,Vc(e,i)));break;case 22:r=null!==e.memoizedState;var l=null!==n&&null!==n.memoizedState,u=Oc,d=_c;if(Oc=u||r,_c=d||l,qc(t,e),_c=d,Oc=u,Gc(e),8192&i)e:for(t=e.stateNode,t._visibility=r?-2&t._visibility:1|t._visibility,r&&(null===n||l||Oc||_c||Qc(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){l=n=t;try{if(o=l.stateNode,r)"function"===typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{c=l.stateNode;var h=l.memoizedProps.style,p=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;c.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(m){wu(l,l.return,m)}}}else if(6===t.tag){if(null===n){l=t;try{l.stateNode.nodeValue=r?"":l.memoizedProps}catch(m){wu(l,l.return,m)}}}else if(18===t.tag){if(null===n){l=t;try{var f=l.stateNode;r?xd(f,!0):xd(l.stateNode,!1)}catch(m){wu(l,l.return,m)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&i&&(null!==(i=e.updateQueue)&&(null!==(n=i.retryQueue)&&(i.retryQueue=null,Vc(e,n))));case 30:case 21:}}function Gc(e){var t=e.flags;if(2&t){try{for(var n,i=e.return;null!==i;){if(Cc(i)){n=i;break}i=i.return}if(null==n)throw Error(a(160));switch(n.tag){case 27:var r=n.stateNode;Rc(e,Ec(e),r);break;case 5:var o=n.stateNode;32&n.flags&&(Ct(o,""),n.flags&=-33),Rc(e,Ec(e),o);break;case 3:case 4:var s=n.stateNode.containerInfo;Pc(e,Ec(e),s);break;default:throw Error(a(161))}}catch(c){wu(e,e.return,c)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Kc(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Kc(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Jc(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Mc(e,t.alternate,t),t=t.sibling}function Qc(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:vc(4,t,t.return),Qc(t);break;case 1:Sc(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&bc(t,t.return,n),Qc(t);break;case 27:jd(t.stateNode);case 26:case 5:Sc(t,t.return),Qc(t);break;case 22:null===t.memoizedState&&Qc(t);break;default:Qc(t)}e=e.sibling}}function $c(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var i=t.alternate,r=e,o=t,a=o.flags;switch(o.tag){case 0:case 11:case 15:$c(r,o,n),gc(4,o);break;case 1:if($c(r,o,n),"function"===typeof(r=(i=o).stateNode).componentDidMount)try{r.componentDidMount()}catch(l){wu(i,i.return,l)}if(null!==(r=(i=o).updateQueue)){var s=i.stateNode;try{var c=r.shared.hiddenCallbacks;if(null!==c)for(r.shared.hiddenCallbacks=null,r=0;r<c.length;r++)Po(c[r],s)}catch(l){wu(i,i.return,l)}}n&&64&a&&yc(o),kc(o,o.return);break;case 27:xc(o);case 26:case 5:$c(r,o,n),n&&null===i&&4&a&&Tc(o),kc(o,o.return);break;case 12:$c(r,o,n);break;case 31:$c(r,o,n),n&&4&a&&Bc(r,o);break;case 13:$c(r,o,n),n&&4&a&&zc(r,o);break;case 22:null===o.memoizedState&&$c(r,o,n),kc(o,o.return);break;case 30:break;default:$c(r,o,n)}t=t.sibling}}function Yc(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Br(n))}function Xc(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Br(e))}function Zc(e,t,n,i){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)el(e,t,n,i),t=t.sibling}function el(e,t,n,i){var r=t.flags;switch(t.tag){case 0:case 11:case 15:Zc(e,t,n,i),2048&r&&gc(9,t);break;case 1:case 31:case 13:default:Zc(e,t,n,i);break;case 3:Zc(e,t,n,i),2048&r&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Br(e)));break;case 12:if(2048&r){Zc(e,t,n,i),e=t.stateNode;try{var o=t.memoizedProps,a=o.id,s=o.onPostCommit;"function"===typeof s&&s(a,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(c){wu(t,t.return,c)}}else Zc(e,t,n,i);break;case 23:break;case 22:o=t.stateNode,a=t.alternate,null!==t.memoizedState?2&o._visibility?Zc(e,t,n,i):nl(e,t):2&o._visibility?Zc(e,t,n,i):(o._visibility|=2,tl(e,t,n,i,0!==(10256&t.subtreeFlags)||!1)),2048&r&&Yc(a,t);break;case 24:Zc(e,t,n,i),2048&r&&Xc(t.alternate,t)}}function tl(e,t,n,i,r){for(r=r&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var o=e,a=t,s=n,c=i,l=a.flags;switch(a.tag){case 0:case 11:case 15:tl(o,a,s,c,r),gc(8,a);break;case 23:break;case 22:var u=a.stateNode;null!==a.memoizedState?2&u._visibility?tl(o,a,s,c,r):nl(o,a):(u._visibility|=2,tl(o,a,s,c,r)),r&&2048&l&&Yc(a.alternate,a);break;case 24:tl(o,a,s,c,r),r&&2048&l&&Xc(a.alternate,a);break;default:tl(o,a,s,c,r)}t=t.sibling}}function nl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,i=t,r=i.flags;switch(i.tag){case 22:nl(n,i),2048&r&&Yc(i.alternate,i);break;case 24:nl(n,i),2048&r&&Xc(i.alternate,i);break;default:nl(n,i)}t=t.sibling}}var il=8192;function rl(e,t,n){if(e.subtreeFlags&il)for(e=e.child;null!==e;)ol(e,t,n),e=e.sibling}function ol(e,t,n){switch(e.tag){case 26:rl(e,t,n),e.flags&il&&null!==e.memoizedState&&function(e,t,n,i){if("stylesheet"===n.type&&("string"!==typeof i.media||!1!==matchMedia(i.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var r=Gd(i.href),o=t.querySelector(Kd(r));if(o)return null!==(t=o._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=ah.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=o,void et(o);o=t.ownerDocument||t,i=Jd(i),(r=Fd.get(r))&&Zd(i,r),et(o=o.createElement("link"));var a=o;a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),hd(o,"link",i),n.instance=o}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=ah.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Hc,e.memoizedState,e.memoizedProps);break;case 5:default:rl(e,t,n);break;case 3:case 4:var i=Hc;Hc=zd(e.stateNode.containerInfo),rl(e,t,n),Hc=i;break;case 22:null===e.memoizedState&&(null!==(i=e.alternate)&&null!==i.memoizedState?(i=il,il=16777216,rl(e,t,n),il=i):rl(e,t,n))}}function al(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function sl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Dc=i,ul(i,e)}al(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)cl(e),e=e.sibling}function cl(e){switch(e.tag){case 0:case 11:case 15:sl(e),2048&e.flags&&vc(9,e,e.return);break;case 3:case 12:default:sl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,ll(e)):sl(e)}}function ll(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Dc=i,ul(i,e)}al(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:vc(8,t,t.return),ll(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,ll(t));break;default:ll(t)}e=e.sibling}}function ul(e,t){for(;null!==Dc;){var n=Dc;switch(n.tag){case 0:case 11:case 15:vc(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var i=n.memoizedState.cachePool.pool;null!=i&&i.refCount++}break;case 24:Br(n.memoizedState.cache)}if(null!==(i=n.child))i.return=n,Dc=i;else e:for(n=e;null!==Dc;){var r=(i=Dc).sibling,o=i.return;if(Ac(i),i===n){Dc=null;break e}if(null!==r){r.return=o,Dc=r;break e}Dc=o}}}var dl={getCacheForType:function(e){var t=Nr(jr),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Nr(jr).controller.signal}},hl="function"===typeof WeakMap?WeakMap:Map,pl=0,fl=null,ml=null,gl=0,vl=0,yl=null,bl=!1,kl=!1,Sl=!1,Tl=0,wl=0,Cl=0,El=0,Pl=0,Rl=0,xl=0,Ol=null,_l=null,Il=!1,Nl=0,Dl=0,Ml=1/0,Al=null,Ll=null,Ul=0,jl=null,Fl=null,Bl=0,zl=0,Vl=null,ql=null,Hl=0,Wl=null;function Gl(){return 0!==(2&pl)&&0!==gl?gl&-gl:null!==M.T?Vu():je()}function Kl(){if(0===Rl)if(0===(536870912&gl)||dr){var e=Ce;0===(3932160&(Ce<<=1))&&(Ce=262144),Rl=e}else Rl=536870912;return null!==(e=Do.current)&&(e.flags|=32),Rl}function Jl(e,t,n){(e!==fl||2!==vl&&9!==vl)&&null===e.cancelPendingCommit||(tu(e,0),Xl(e,gl,Rl,!1)),Ne(e,n),0!==(2&pl)&&e===fl||(e===fl&&(0===(2&pl)&&(El|=n),4===wl&&Xl(e,gl,Rl,!1)),Au(e))}function Ql(e,t,n){if(0!==(6&pl))throw Error(a(327));for(var i=!n&&0===(127&t)&&0===(t&e.expiredLanes)||xe(e,t),r=i?function(e,t){var n=pl;pl|=2;var i=ru(),r=ou();fl!==e||gl!==t?(Al=null,Ml=ce()+500,tu(e,t)):kl=xe(e,t);e:for(;;)try{if(0!==vl&&null!==ml){t=ml;var o=yl;t:switch(vl){case 1:vl=0,yl=null,hu(e,t,o,1);break;case 2:case 9:if(to(o)){vl=0,yl=null,du(t);break}t=function(){2!==vl&&9!==vl||fl!==e||(vl=7),Au(e)},o.then(t,t);break e;case 3:vl=7;break e;case 4:vl=5;break e;case 7:to(o)?(vl=0,yl=null,du(t)):(vl=0,yl=null,hu(e,t,o,7));break;case 5:var s=null;switch(ml.tag){case 26:s=ml.memoizedState;case 5:case 27:var c=ml;if(s?rh(s):c.stateNode.complete){vl=0,yl=null;var l=c.sibling;if(null!==l)ml=l;else{var u=c.return;null!==u?(ml=u,pu(u)):ml=null}break t}}vl=0,yl=null,hu(e,t,o,5);break;case 6:vl=0,yl=null,hu(e,t,o,6);break;case 8:eu(),wl=6;break e;default:throw Error(a(462))}}lu();break}catch(d){nu(e,d)}return Cr=wr=null,M.H=i,M.A=r,pl=n,null!==ml?0:(fl=null,gl=0,_i(),wl)}(e,t):su(e,t,!0),o=i;;){if(0===r){kl&&!i&&Xl(e,t,0,!1);break}if(n=e.current.alternate,!o||Yl(n)){if(2===r){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var c=e;r=Ol;var l=c.current.memoizedState.isDehydrated;if(l&&(tu(c,s).flags|=256),2!==(s=su(c,s,!1))){if(Sl&&!l){c.errorRecoveryDisabledLanes|=o,El|=o,r=4;break e}o=_l,_l=r,null!==o&&(null===_l?_l=o:_l.push.apply(_l,o))}r=s}if(o=!1,2!==r)continue}}if(1===r){tu(e,0),Xl(e,t,0,!0);break}e:{switch(i=e,o=r){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:Xl(i,t,Rl,!bl);break e;case 2:_l=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(r=Nl+300-ce())){if(Xl(i,t,Rl,!bl),0!==Re(i,0,!0))break e;Bl=t,i.timeoutHandle=Sd($l.bind(null,i,n,_l,Al,Il,t,Rl,El,xl,bl,o,"Throttled",-0,0),r)}else $l(i,n,_l,Al,Il,t,Rl,El,xl,bl,o,null,-0,0)}break}r=su(e,t,!1),o=!1}Au(e)}function $l(e,t,n,i,r,o,a,s,c,l,u,d,h,p){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||16785408===(16785408&d)){ol(t,o,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Nt});var f=(62914560&o)===o?Nl-ce():(4194048&o)===o?Dl-ce():0;if(null!==(f=function(e,t){return e.stylesheets&&0===e.count&&ch(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var i=setTimeout(function(){if(e.stylesheets&&ch(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===oh&&(oh=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var r=n[i],o=r.transferSize,a=r.initiatorType,s=r.duration;if(o&&s&&pd(a)){for(a=0,s=r.responseEnd,i+=1;i<n.length;i++){var c=n[i],l=c.startTime;if(l>s)break;var u=c.transferSize,d=c.initiatorType;u&&pd(d)&&(a+=u*((c=c.responseEnd)<s?1:(s-l)/(c-l)))}if(--i,t+=8*(o+a)/(r.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var r=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&ch(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>oh?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(r)}}:null}(d,f)))return Bl=o,e.cancelPendingCommit=f(mu.bind(null,e,t,o,n,i,r,a,s,c,u,d,null,h,p)),void Xl(e,o,a,!l)}mu(e,t,o,n,i,r,a,s,c)}function Yl(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!Xn(o(),r))return!1}catch(a){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xl(e,t,n,i){t&=~Pl,t&=~El,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var r=t;0<r;){var o=31-ke(r),a=1<<o;i[o]=-1,r&=~a}0!==n&&De(e,n,t)}function Zl(){return 0!==(6&pl)||(Lu(0,!1),!1)}function eu(){if(null!==ml){if(0===vl)var e=ml.return;else Cr=wr=null,sa(e=ml),so=null,co=0,e=ml;for(;null!==e;)mc(e.alternate,e),e=e.return;ml=null}}function tu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,Td(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Bl=0,eu(),fl=e,ml=n=Bi(e.current,null),gl=t,vl=0,yl=null,bl=!1,kl=xe(e,t),Sl=!1,xl=Rl=Pl=El=Cl=wl=0,_l=Ol=null,Il=!1,0!==(8&t)&&(t|=32&t);var i=e.entangledLanes;if(0!==i)for(e=e.entanglements,i&=t;0<i;){var r=31-ke(i),o=1<<r;t|=e[r],i&=~o}return Tl=t,_i(),n}function nu(e,t){qo=null,M.H=ms,t===Yr||t===Zr?(t=oo(),vl=3):t===Xr?(t=oo(),vl=4):vl=t===Ns?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,yl=t,null===ml&&(wl=1,Rs(e,Ji(t,e.current)))}function iu(){var e=Do.current;return null===e||((4194048&gl)===gl?null===Mo:((62914560&gl)===gl||0!==(536870912&gl))&&e===Mo)}function ru(){var e=M.H;return M.H=ms,null===e?ms:e}function ou(){var e=M.A;return M.A=dl,e}function au(){wl=4,bl||(4194048&gl)!==gl&&null!==Do.current||(kl=!0),0===(134217727&Cl)&&0===(134217727&El)||null===fl||Xl(fl,gl,Rl,!1)}function su(e,t,n){var i=pl;pl|=2;var r=ru(),o=ou();fl===e&&gl===t||(Al=null,tu(e,t)),t=!1;var a=wl;e:for(;;)try{if(0!==vl&&null!==ml){var s=ml,c=yl;switch(vl){case 8:eu(),a=6;break e;case 3:case 2:case 9:case 6:null===Do.current&&(t=!0);var l=vl;if(vl=0,yl=null,hu(e,s,c,l),n&&kl){a=0;break e}break;default:l=vl,vl=0,yl=null,hu(e,s,c,l)}}cu(),a=wl;break}catch(u){nu(e,u)}return t&&e.shellSuspendCounter++,Cr=wr=null,pl=i,M.H=r,M.A=o,null===ml&&(fl=null,gl=0,_i()),a}function cu(){for(;null!==ml;)uu(ml)}function lu(){for(;null!==ml&&!ae();)uu(ml)}function uu(e){var t=ac(e.alternate,e,Tl);e.memoizedProps=e.pendingProps,null===t?pu(e):ml=t}function du(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ws(n,t,t.pendingProps,t.type,void 0,gl);break;case 11:t=Ws(n,t,t.pendingProps,t.type.render,t.ref,gl);break;case 5:sa(t);default:mc(n,t),t=ac(n,t=ml=zi(t,Tl),Tl)}e.memoizedProps=e.pendingProps,null===t?pu(e):ml=t}function hu(e,t,n,i){Cr=wr=null,sa(t),so=null,co=0;var r=t.return;try{if(function(e,t,n,i,r){if(n.flags|=32768,null!==i&&"object"===typeof i&&"function"===typeof i.then){if(null!==(t=n.alternate)&&Or(t,n,r,!0),null!==(n=Do.current)){switch(n.tag){case 31:case 13:return null===Mo?au():null===n.alternate&&0===wl&&(wl=3),n.flags&=-257,n.flags|=65536,n.lanes=r,i===eo?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([i]):t.add(i),Cu(e,i,r)),!1;case 22:return n.flags|=65536,i===eo?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([i]):n.add(i),Cu(e,i,r)),!1}throw Error(a(435,n.tag))}return Cu(e,i,r),au(),!1}if(dr)return null!==(t=Do.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=r,i!==fr&&Sr(Ji(e=Error(a(422),{cause:i}),n))):(i!==fr&&Sr(Ji(t=Error(a(423),{cause:i}),n)),(e=e.current.alternate).flags|=65536,r&=-r,e.lanes|=r,i=Ji(i,n),To(e,r=Os(e.stateNode,i,r)),4!==wl&&(wl=2)),!1;var o=Error(a(520),{cause:i});if(o=Ji(o,n),null===Ol?Ol=[o]:Ol.push(o),4!==wl&&(wl=2),null===t)return!0;i=Ji(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,To(n,e=Os(n.stateNode,i,e)),!1;case 1:if(t=n.type,o=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==o&&"function"===typeof o.componentDidCatch&&(null===Ll||!Ll.has(o))))return n.flags|=65536,r&=-r,n.lanes|=r,Is(r=_s(r),e,n,i),To(n,r),!1}n=n.return}while(null!==n);return!1}(e,r,t,n,gl))return wl=1,Rs(e,Ji(n,e.current)),void(ml=null)}catch(o){if(null!==r)throw ml=r,o;return wl=1,Rs(e,Ji(n,e.current)),void(ml=null)}32768&t.flags?(dr||1===i?e=!0:kl||0!==(536870912&gl)?e=!1:(bl=e=!0,(2===i||9===i||3===i||6===i)&&(null!==(i=Do.current)&&13===i.tag&&(i.flags|=16384))),fu(t,e)):pu(t)}function pu(e){var t=e;do{if(0!==(32768&t.flags))return void fu(t,bl);e=t.return;var n=pc(t.alternate,t,Tl);if(null!==n)return void(ml=n);if(null!==(t=t.sibling))return void(ml=t);ml=t=e}while(null!==t);0===wl&&(wl=5)}function fu(e,t){do{var n=fc(e.alternate,e);if(null!==n)return n.flags&=32767,void(ml=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(ml=e);ml=e=n}while(null!==e);wl=6,ml=null}function mu(e,t,n,i,r,o,s,c,l){e.cancelPendingCommit=null;do{ku()}while(0!==Ul);if(0!==(6&pl))throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(o=t.lanes|t.childLanes,function(e,t,n,i,r,o){var a=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,c=e.expirationTimes,l=e.hiddenUpdates;for(n=a&~n;0<n;){var u=31-ke(n),d=1<<u;s[u]=0,c[u]=-1;var h=l[u];if(null!==h)for(l[u]=null,u=0;u<h.length;u++){var p=h[u];null!==p&&(p.lane&=-536870913)}n&=~d}0!==i&&De(e,i,0),0!==o&&0===r&&0!==e.tag&&(e.suspendedLanes|=o&~(a&~t))}(e,n,o|=Oi,s,c,l),e===fl&&(ml=fl=null,gl=0),Fl=t,jl=e,Bl=n,zl=o,Vl=r,ql=i,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,re(he,function(){return Su(),null})):(e.callbackNode=null,e.callbackPriority=0),i=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||i){i=M.T,M.T=null,r=A.p,A.p=2,s=pl,pl|=4;try{!function(e,t){if(e=e.containerInfo,fd=bh,ri(e=ii(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(g){n=null;break e}var s=0,c=-1,l=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==r&&3!==h.nodeType||(c=s+r),h!==o||0!==i&&3!==h.nodeType||(l=s+i),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===r&&(c=s),p===o&&++d===i&&(l=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(md={focusedElem:e,selectionRange:n},bh=!1,Dc=t;null!==Dc;)if(e=(t=Dc).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Dc=e;else for(;null!==Dc;){switch(o=(t=Dc).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(r=e[n]).ref.impl=r.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==o){e=void 0,n=t,r=o.memoizedProps,o=o.memoizedState,i=n.stateNode;try{var m=ws(n.type,r);e=i.getSnapshotBeforeUpdate(m,o),i.__reactInternalSnapshotBeforeUpdate=e}catch(v){wu(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))Od(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Od(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,Dc=e;break}Dc=t.return}}(e,t)}finally{pl=s,A.p=r,M.T=i}}Ul=1,gu(),vu(),yu()}}function gu(){if(1===Ul){Ul=0;var e=jl,t=Fl,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=M.T,M.T=null;var i=A.p;A.p=2;var r=pl;pl|=4;try{Wc(t,e);var o=md,a=ii(e.containerInfo),s=o.focusedElem,c=o.selectionRange;if(a!==s&&s&&s.ownerDocument&&ni(s.ownerDocument.documentElement,s)){if(null!==c&&ri(s)){var l=c.start,u=c.end;if(void 0===u&&(u=l),"selectionStart"in s)s.selectionStart=l,s.selectionEnd=Math.min(u,s.value.length);else{var d=s.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var p=h.getSelection(),f=s.textContent.length,m=Math.min(c.start,f),g=void 0===c.end?m:Math.min(c.end,f);!p.extend&&m>g&&(a=g,g=m,m=a);var v=ti(s,m),y=ti(s,g);if(v&&y&&(1!==p.rangeCount||p.anchorNode!==v.node||p.anchorOffset!==v.offset||p.focusNode!==y.node||p.focusOffset!==y.offset)){var b=d.createRange();b.setStart(v.node,v.offset),p.removeAllRanges(),m>g?(p.addRange(b),p.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),p.addRange(b))}}}}for(d=[],p=s;p=p.parentNode;)1===p.nodeType&&d.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<d.length;s++){var k=d[s];k.element.scrollLeft=k.left,k.element.scrollTop=k.top}}bh=!!fd,md=fd=null}finally{pl=r,A.p=i,M.T=n}}e.current=t,Ul=2}}function vu(){if(2===Ul){Ul=0;var e=jl,t=Fl,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=M.T,M.T=null;var i=A.p;A.p=2;var r=pl;pl|=4;try{Mc(e,t.alternate,t)}finally{pl=r,A.p=i,M.T=n}}Ul=3}}function yu(){if(4===Ul||3===Ul){Ul=0,se();var e=jl,t=Fl,n=Bl,i=ql;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Ul=5:(Ul=0,Fl=jl=null,bu(e,e.pendingLanes));var r=e.pendingLanes;if(0===r&&(Ll=null),Ue(n),t=t.stateNode,ye&&"function"===typeof ye.onCommitFiberRoot)try{ye.onCommitFiberRoot(ve,t,void 0,128===(128&t.current.flags))}catch(c){}if(null!==i){t=M.T,r=A.p,A.p=2,M.T=null;try{for(var o=e.onRecoverableError,a=0;a<i.length;a++){var s=i[a];o(s.value,{componentStack:s.stack})}}finally{M.T=t,A.p=r}}0!==(3&Bl)&&ku(),Au(e),r=e.pendingLanes,0!==(261930&n)&&0!==(42&r)?e===Wl?Hl++:(Hl=0,Wl=e):Hl=0,Lu(0,!1)}}function bu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Br(t)))}function ku(){return gu(),vu(),yu(),Su()}function Su(){if(5!==Ul)return!1;var e=jl,t=zl;zl=0;var n=Ue(Bl),i=M.T,r=A.p;try{A.p=32>n?32:n,M.T=null,n=Vl,Vl=null;var o=jl,s=Bl;if(Ul=0,Fl=jl=null,Bl=0,0!==(6&pl))throw Error(a(331));var c=pl;if(pl|=4,cl(o.current),el(o,o.current,s,n),pl=c,Lu(0,!1),ye&&"function"===typeof ye.onPostCommitFiberRoot)try{ye.onPostCommitFiberRoot(ve,o)}catch(l){}return!0}finally{A.p=r,M.T=i,bu(e,t)}}function Tu(e,t,n){t=Ji(n,t),null!==(e=ko(e,t=Os(e.stateNode,t,2),2))&&(Ne(e,2),Au(e))}function wu(e,t,n){if(3===e.tag)Tu(e,e,n);else for(;null!==t;){if(3===t.tag){Tu(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Ll||!Ll.has(i))){e=Ji(n,e),null!==(i=ko(t,n=_s(2),2))&&(Is(n,i,t,e),Ne(i,2),Au(i));break}}t=t.return}}function Cu(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new hl;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(Sl=!0,r.add(n),e=Eu.bind(null,e,t,n),t.then(e,e))}function Eu(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,fl===e&&(gl&n)===n&&(4===wl||3===wl&&(62914560&gl)===gl&&300>ce()-Nl?0===(2&pl)&&tu(e,0):Pl|=n,xl===gl&&(xl=0)),Au(e)}function Pu(e,t){0===t&&(t=_e()),null!==(e=Di(e,t))&&(Ne(e,t),Au(e))}function Ru(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Pu(e,n)}function xu(e,t){var n=0;switch(e.tag){case 31:case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==i&&i.delete(t),Pu(e,n)}var Ou=null,_u=null,Iu=!1,Nu=!1,Du=!1,Mu=0;function Au(e){e!==_u&&null===e.next&&(null===_u?Ou=_u=e:_u=_u.next=e),Nu=!0,Iu||(Iu=!0,Cd(function(){0!==(6&pl)?re(ue,Uu):ju()}))}function Lu(e,t){if(!Du&&Nu){Du=!0;do{for(var n=!1,i=Ou;null!==i;){if(!t)if(0!==e){var r=i.pendingLanes;if(0===r)var o=0;else{var a=i.suspendedLanes,s=i.pingedLanes;o=(1<<31-ke(42|e)+1)-1,o=201326741&(o&=r&~(a&~s))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,zu(i,o))}else o=gl,0===(3&(o=Re(i,i===fl?o:0,null!==i.cancelPendingCommit||-1!==i.timeoutHandle)))||xe(i,o)||(n=!0,zu(i,o));i=i.next}}while(n);Du=!1}}function Uu(){ju()}function ju(){Nu=Iu=!1;var e=0;0!==Mu&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==kd&&(kd=e,!0);return kd=null,!1}()&&(e=Mu);for(var t=ce(),n=null,i=Ou;null!==i;){var r=i.next,o=Fu(i,t);0===o?(i.next=null,null===n?Ou=r:n.next=r,null===r&&(_u=n)):(n=i,(0!==e||0!==(3&o))&&(Nu=!0)),i=r}0!==Ul&&5!==Ul||Lu(e,!1),0!==Mu&&(Mu=0)}function Fu(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var a=31-ke(o),s=1<<a,c=r[a];-1===c?0!==(s&n)&&0===(s&i)||(r[a]=Oe(s,t)):c<=t&&(e.expiredLanes|=s),o&=~s}if(n=gl,n=Re(e,e===(t=fl)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),i=e.callbackNode,0===n||e===t&&(2===vl||9===vl)||null!==e.cancelPendingCommit)return null!==i&&null!==i&&oe(i),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||xe(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==i&&oe(i),Ue(n)){case 2:case 8:n=de;break;case 32:default:n=he;break;case 268435456:n=fe}return i=Bu.bind(null,e),n=re(n,i),e.callbackPriority=t,e.callbackNode=n,t}return null!==i&&null!==i&&oe(i),e.callbackPriority=2,e.callbackNode=null,2}function Bu(e,t){if(0!==Ul&&5!==Ul)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(ku()&&e.callbackNode!==n)return null;var i=gl;return 0===(i=Re(e,e===fl?i:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Ql(e,i,t),Fu(e,ce()),null!=e.callbackNode&&e.callbackNode===n?Bu.bind(null,e):null)}function zu(e,t){if(ku())return null;Ql(e,t,!0)}function Vu(){if(0===Mu){var e=qr;0===e&&(e=we,0===(261888&(we<<=1))&&(we=256)),Mu=e}return Mu}function qu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:It(""+e)}function Hu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Wu=0;Wu<Ci.length;Wu++){var Gu=Ci[Wu];Ei(Gu.toLowerCase(),"on"+(Gu[0].toUpperCase()+Gu.slice(1)))}Ei(gi,"onAnimationEnd"),Ei(vi,"onAnimationIteration"),Ei(yi,"onAnimationStart"),Ei("dblclick","onDoubleClick"),Ei("focusin","onFocus"),Ei("focusout","onBlur"),Ei(bi,"onTransitionRun"),Ei(ki,"onTransitionStart"),Ei(Si,"onTransitionCancel"),Ei(Ti,"onTransitionEnd"),rt("onMouseEnter",["mouseout","mouseover"]),rt("onMouseLeave",["mouseout","mouseover"]),rt("onPointerEnter",["pointerout","pointerover"]),rt("onPointerLeave",["pointerout","pointerover"]),it("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),it("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),it("onBeforeInput",["compositionend","keypress","textInput","paste"]),it("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ju=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ku));function Qu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var o=void 0;if(t)for(var a=i.length-1;0<=a;a--){var s=i[a],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==o&&r.isPropagationStopped())break e;o=s,r.currentTarget=l;try{o(r)}catch(u){Pi(u)}r.currentTarget=null,o=c}else for(a=0;a<i.length;a++){if(c=(s=i[a]).instance,l=s.currentTarget,s=s.listener,c!==o&&r.isPropagationStopped())break e;o=s,r.currentTarget=l;try{o(r)}catch(u){Pi(u)}r.currentTarget=null,o=c}}}}function $u(e,t){var n=t[He];void 0===n&&(n=t[He]=new Set);var i=e+"__bubble";n.has(i)||(ed(t,e,2,!1),n.add(i))}function Yu(e,t,n){var i=0;t&&(i|=4),ed(n,e,i,t)}var Xu="_reactListening"+Math.random().toString(36).slice(2);function Zu(e){if(!e[Xu]){e[Xu]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Ju.has(t)||Yu(t,!1,e),Yu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Xu]||(t[Xu]=!0,Yu("selectionchange",!1,t))}}function ed(e,t,n,i){switch(Ph(t)){case 2:var r=kh;break;case 8:r=Sh;break;default:r=Th}n=r.bind(null,t,n,e),r=void 0,!Vt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function td(e,t,n,i,r){var o=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var s=i.stateNode.containerInfo;if(s===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&a.stateNode.containerInfo===r)return;a=a.return}for(;null!==s;){if(null===(a=$e(s)))return;if(5===(l=a.tag)||6===l||26===l||27===l){i=o=a;continue e}s=s.parentNode}}i=i.return}Ft(function(){var i=o,r=Mt(n),a=[];e:{var s=wi.get(e);if(void 0!==s){var l=nn,u=e;switch(e){case"keypress":if(0===Jt(n))break e;case"keydown":case"keyup":l=yn;break;case"focusin":u="focus",l=ln;break;case"focusout":u="blur",l=ln;break;case"beforeblur":case"afterblur":l=ln;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=sn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=cn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kn;break;case gi:case vi:case yi:l=un;break;case Ti:l=Sn;break;case"scroll":case"scrollend":l=on;break;case"wheel":l=Tn;break;case"copy":case"cut":case"paste":l=dn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=bn;break;case"toggle":case"beforetoggle":l=wn}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),p=d?null!==s?s+"Capture":null:s;d=[];for(var f,m=i;null!==m;){var g=m;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===p||null!=(g=Bt(m,p))&&d.push(nd(m,g,f)),h)break;m=m.return}0<d.length&&(s=new l(s,u,null,n,r),a.push({event:s,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===Dt||!(u=n.relatedTarget||n.fromElement)||!$e(u)&&!u[qe])&&(l||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=i,null!==(u=(u=n.relatedTarget||n.toElement)?$e(u):null)&&(h=c(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(l=null,u=i),l!==u)){if(d=sn,g="onMouseLeave",p="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=bn,g="onPointerLeave",p="onPointerEnter",m="pointer"),h=null==l?s:Xe(l),f=null==u?s:Xe(u),(s=new d(g,m+"leave",l,n,r)).target=h,s.relatedTarget=f,g=null,$e(r)===i&&((d=new d(p,m+"enter",u,n,r)).target=f,d.relatedTarget=h,g=d),h=g,l&&u)e:{for(d=rd,m=u,f=0,g=p=l;g;g=d(g))f++;g=0;for(var v=m;v;v=d(v))g++;for(;0<f-g;)p=d(p),f--;for(;0<g-f;)m=d(m),g--;for(;f--;){if(p===m||null!==m&&p===m.alternate){d=p;break e}p=d(p),m=d(m)}d=null}else d=null;null!==l&&od(a,s,l,d,!1),null!==u&&null!==h&&od(a,h,u,d,!0)}if("select"===(l=(s=i?Xe(i):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var y=zn;else if(An(s))if(Vn)y=Yn;else{y=Qn;var b=Jn}else!(l=s.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type?i&&xt(i.elementType)&&(y=zn):y=$n;switch(y&&(y=y(e,i))?Ln(a,y,n,r):(b&&b(e,s,i),"focusout"===e&&i&&"number"===s.type&&null!=i.memoizedProps.value&&kt(s,"number",s.value)),b=i?Xe(i):window,e){case"focusin":(An(b)||"true"===b.contentEditable)&&(ai=b,si=i,ci=null);break;case"focusout":ci=si=ai=null;break;case"mousedown":li=!0;break;case"contextmenu":case"mouseup":case"dragend":li=!1,ui(a,n,r);break;case"selectionchange":if(oi)break;case"keydown":case"keyup":ui(a,n,r)}var k;if(En)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Dn?In(e,n)&&(S="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(S="onCompositionStart");S&&(xn&&"ko"!==n.locale&&(Dn||"onCompositionStart"!==S?"onCompositionEnd"===S&&Dn&&(k=Kt()):(Wt="value"in(Ht=r)?Ht.value:Ht.textContent,Dn=!0)),0<(b=id(i,S)).length&&(S=new hn(S,e,null,n,r),a.push({event:S,listeners:b}),k?S.data=k:null!==(k=Nn(n))&&(S.data=k))),(k=Rn?function(e,t){switch(e){case"compositionend":return Nn(t);case"keypress":return 32!==t.which?null:(_n=!0,On);case"textInput":return(e=t.data)===On&&_n?null:e;default:return null}}(e,n):function(e,t){if(Dn)return"compositionend"===e||!En&&In(e,t)?(e=Kt(),Gt=Wt=Ht=null,Dn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return xn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(S=id(i,"onBeforeInput")).length&&(b=new hn("onBeforeInput","beforeinput",null,n,r),a.push({event:b,listeners:S}),b.data=k)),function(e,t,n,i,r){if("submit"===t&&n&&n.stateNode===r){var o=qu((r[Ve]||null).action),a=i.submitter;a&&null!==(t=(t=a[Ve]||null)?qu(t.formAction):a.getAttribute("formAction"))&&(o=t,a=null);var s=new nn("action","action",null,i,r);e.push({event:s,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(0!==Mu){var e=a?Hu(r,a):new FormData(r);ts(n,{pending:!0,data:e,method:r.method,action:o},null,e)}}else"function"===typeof o&&(s.preventDefault(),e=a?Hu(r,a):new FormData(r),ts(n,{pending:!0,data:e,method:r.method,action:o},o,e))},currentTarget:r}]})}}(a,e,i,n,r)}Qu(a,t)})}function nd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function id(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,o=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===o||(null!=(r=Bt(e,n))&&i.unshift(nd(e,r,o)),null!=(r=Bt(e,t))&&i.push(nd(e,r,o))),3===e.tag)return i;e=e.return}return[]}function rd(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function od(e,t,n,i,r){for(var o=t._reactName,a=[];null!==n&&n!==i;){var s=n,c=s.alternate,l=s.stateNode;if(s=s.tag,null!==c&&c===i)break;5!==s&&26!==s&&27!==s||null===l||(c=l,r?null!=(l=Bt(n,o))&&a.unshift(nd(n,l,c)):r||null!=(l=Bt(n,o))&&a.push(nd(n,l,c))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var ad=/\r\n?/g,sd=/\u0000|\uFFFD/g;function cd(e){return("string"===typeof e?e:""+e).replace(ad,"\n").replace(sd,"")}function ld(e,t){return t=cd(t),cd(e)===t}function ud(e,t,n,i,r,o){switch(n){case"children":"string"===typeof i?"body"===t||"textarea"===t&&""===i||Ct(e,i):("number"===typeof i||"bigint"===typeof i)&&"body"!==t&&Ct(e,""+i);break;case"className":lt(e,"class",i);break;case"tabIndex":lt(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":lt(e,n,i);break;case"style":Rt(e,i,o);break;case"data":if("object"!==t){lt(e,"data",i);break}case"src":case"href":if(""===i&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==i||"function"===typeof i||"symbol"===typeof i||"boolean"===typeof i){e.removeAttribute(n);break}i=It(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if("function"===typeof i){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof o&&("formAction"===n?("input"!==t&&ud(e,t,"name",r.name,r,null),ud(e,t,"formEncType",r.formEncType,r,null),ud(e,t,"formMethod",r.formMethod,r,null),ud(e,t,"formTarget",r.formTarget,r,null)):(ud(e,t,"encType",r.encType,r,null),ud(e,t,"method",r.method,r,null),ud(e,t,"target",r.target,r,null))),null==i||"symbol"===typeof i||"boolean"===typeof i){e.removeAttribute(n);break}i=It(""+i),e.setAttribute(n,i);break;case"onClick":null!=i&&(e.onclick=Nt);break;case"onScroll":null!=i&&$u("scroll",e);break;case"onScrollEnd":null!=i&&$u("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!==typeof i||!("__html"in i))throw Error(a(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(a(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&"function"!==typeof i&&"symbol"!==typeof i;break;case"muted":e.muted=i&&"function"!==typeof i&&"symbol"!==typeof i;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==i||"function"===typeof i||"boolean"===typeof i||"symbol"===typeof i){e.removeAttribute("xlink:href");break}n=It(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===i?e.setAttribute(n,""):!1!==i&&null!=i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":null==i||"function"===typeof i||"symbol"===typeof i||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":$u("beforetoggle",e),$u("toggle",e),ct(e,"popover",i);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":ct(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ct(e,n=Ot.get(n)||n,i)}}function dd(e,t,n,i,r,o){switch(n){case"style":Rt(e,i,o);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!==typeof i||!("__html"in i))throw Error(a(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(a(60));e.innerHTML=n}}break;case"children":"string"===typeof i?Ct(e,i):("number"===typeof i||"bigint"===typeof i)&&Ct(e,""+i);break;case"onScroll":null!=i&&$u("scroll",e);break;case"onScrollEnd":null!=i&&$u("scrollend",e);break;case"onClick":null!=i&&(e.onclick=Nt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),"function"===typeof(o=null!=(o=e[Ve]||null)?o[n]:null)&&e.removeEventListener(t,o,r),"function"!==typeof i)?n in e?e[n]=i:!0===i?e.setAttribute(n,""):ct(e,n,i):("function"!==typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,r)))}}function hd(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$u("error",e),$u("load",e);var i,r=!1,o=!1;for(i in n)if(n.hasOwnProperty(i)){var s=n[i];if(null!=s)switch(i){case"src":r=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:ud(e,t,i,s,n,null)}}return o&&ud(e,t,"srcSet",n.srcSet,n,null),void(r&&ud(e,t,"src",n.src,n,null));case"input":$u("invalid",e);var c=i=s=o=null,l=null,u=null;for(r in n)if(n.hasOwnProperty(r)){var d=n[r];if(null!=d)switch(r){case"name":o=d;break;case"type":s=d;break;case"checked":l=d;break;case"defaultChecked":u=d;break;case"value":i=d;break;case"defaultValue":c=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(a(137,t));break;default:ud(e,t,r,d,n,null)}}return void bt(e,i,c,l,u,s,o,!1);case"select":for(o in $u("invalid",e),r=s=i=null,n)if(n.hasOwnProperty(o)&&null!=(c=n[o]))switch(o){case"value":i=c;break;case"defaultValue":s=c;break;case"multiple":r=c;default:ud(e,t,o,c,n,null)}return t=i,n=s,e.multiple=!!r,void(null!=t?St(e,!!r,t,!1):null!=n&&St(e,!!r,n,!0));case"textarea":for(s in $u("invalid",e),i=o=r=null,n)if(n.hasOwnProperty(s)&&null!=(c=n[s]))switch(s){case"value":r=c;break;case"defaultValue":o=c;break;case"children":i=c;break;case"dangerouslySetInnerHTML":if(null!=c)throw Error(a(91));break;default:ud(e,t,s,c,n,null)}return void wt(e,r,o,i);case"option":for(l in n)if(n.hasOwnProperty(l)&&null!=(r=n[l]))if("selected"===l)e.selected=r&&"function"!==typeof r&&"symbol"!==typeof r;else ud(e,t,l,r,n,null);return;case"dialog":$u("beforetoggle",e),$u("toggle",e),$u("cancel",e),$u("close",e);break;case"iframe":case"object":$u("load",e);break;case"video":case"audio":for(r=0;r<Ku.length;r++)$u(Ku[r],e);break;case"image":$u("error",e),$u("load",e);break;case"details":$u("toggle",e);break;case"embed":case"source":case"link":$u("error",e),$u("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(r=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:ud(e,t,u,r,n,null)}return;default:if(xt(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(r=n[d])&&dd(e,t,d,r,n,void 0));return}}for(c in n)n.hasOwnProperty(c)&&(null!=(r=n[c])&&ud(e,t,c,r,n,null))}function pd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var fd=null,md=null;function gd(e){return 9===e.nodeType?e:e.ownerDocument}function vd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function bd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var kd=null;var Sd="function"===typeof setTimeout?setTimeout:void 0,Td="function"===typeof clearTimeout?clearTimeout:void 0,wd="function"===typeof Promise?Promise:void 0,Cd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof wd?function(e){return wd.resolve(null).then(e).catch(Ed)}:Sd;function Ed(e){setTimeout(function(){throw e})}function Pd(e){return"head"===e}function Rd(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)||"/&"===n){if(0===i)return e.removeChild(r),void Hh(t);i--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)i++;else if("html"===n)jd(e.ownerDocument.documentElement);else if("head"===n){jd(n=e.ownerDocument.head);for(var o=n.firstChild;o;){var a=o.nextSibling,s=o.nodeName;o[Je]||"SCRIPT"===s||"STYLE"===s||"LINK"===s&&"stylesheet"===o.rel.toLowerCase()||n.removeChild(o),o=a}}else"body"===n&&jd(e.ownerDocument.body);n=r}while(n);Hh(t)}function xd(e,t){var n=e;e=0;do{var i=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=i}while(n)}function Od(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Od(n),Qe(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function _d(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Dd(e.nextSibling)))return null}return e}function Id(e){return"$?"===e.data||"$~"===e.data}function Nd(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Dd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Md=null;function Ad(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Dd(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Ld(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Ud(e,t,n){switch(t=gd(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function jd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Qe(e)}var Fd=new Map,Bd=new Set;function zd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Vd=A.d;A.d={f:function(){var e=Vd.f(),t=Zl();return e||t},r:function(e){var t=Ye(e);null!==t&&5===t.tag&&"form"===t.type?is(t):Vd.r(e)},D:function(e){Vd.D(e),Hd("dns-prefetch",e,null)},C:function(e,t){Vd.C(e,t),Hd("preconnect",e,t)},L:function(e,t,n){Vd.L(e,t,n);var i=qd;if(i&&e&&t){var r='link[rel="preload"][as="'+vt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(r+='[imagesrcset="'+vt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(r+='[imagesizes="'+vt(n.imageSizes)+'"]')):r+='[href="'+vt(e)+'"]';var o=r;switch(t){case"style":o=Gd(e);break;case"script":o=Qd(e)}Fd.has(o)||(e=p({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Fd.set(o,e),null!==i.querySelector(r)||"style"===t&&i.querySelector(Kd(o))||"script"===t&&i.querySelector($d(o))||(hd(t=i.createElement("link"),"link",e),et(t),i.head.appendChild(t)))}},m:function(e,t){Vd.m(e,t);var n=qd;if(n&&e){var i=t&&"string"===typeof t.as?t.as:"script",r='link[rel="modulepreload"][as="'+vt(i)+'"][href="'+vt(e)+'"]',o=r;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Qd(e)}if(!Fd.has(o)&&(e=p({rel:"modulepreload",href:e},t),Fd.set(o,e),null===n.querySelector(r))){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector($d(o)))return}hd(i=n.createElement("link"),"link",e),et(i),n.head.appendChild(i)}}},X:function(e,t){Vd.X(e,t);var n=qd;if(n&&e){var i=Ze(n).hoistableScripts,r=Qd(e),o=i.get(r);o||((o=n.querySelector($d(r)))||(e=p({src:e,async:!0},t),(t=Fd.get(r))&&eh(e,t),et(o=n.createElement("script")),hd(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(r,o))}},S:function(e,t,n){Vd.S(e,t,n);var i=qd;if(i&&e){var r=Ze(i).hoistableStyles,o=Gd(e);t=t||"default";var a=r.get(o);if(!a){var s={loading:0,preload:null};if(a=i.querySelector(Kd(o)))s.loading=5;else{e=p({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Fd.get(o))&&Zd(e,n);var c=a=i.createElement("link");et(c),hd(c,"link",e),c._p=new Promise(function(e,t){c.onload=e,c.onerror=t}),c.addEventListener("load",function(){s.loading|=1}),c.addEventListener("error",function(){s.loading|=2}),s.loading|=4,Xd(a,t,i)}a={type:"stylesheet",instance:a,count:1,state:s},r.set(o,a)}}},M:function(e,t){Vd.M(e,t);var n=qd;if(n&&e){var i=Ze(n).hoistableScripts,r=Qd(e),o=i.get(r);o||((o=n.querySelector($d(r)))||(e=p({src:e,async:!0,type:"module"},t),(t=Fd.get(r))&&eh(e,t),et(o=n.createElement("script")),hd(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(r,o))}}};var qd="undefined"===typeof document?null:document;function Hd(e,t,n){var i=qd;if(i&&"string"===typeof t&&t){var r=vt(t);r='link[rel="'+e+'"][href="'+r+'"]',"string"===typeof n&&(r+='[crossorigin="'+n+'"]'),Bd.has(r)||(Bd.add(r),e={rel:e,crossOrigin:n,href:t},null===i.querySelector(r)&&(hd(t=i.createElement("link"),"link",e),et(t),i.head.appendChild(t)))}}function Wd(e,t,n,i){var r,o,s,c,l=(l=G.current)?zd(l):null;if(!l)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Gd(n.href),(i=(n=Ze(l).hoistableStyles).get(t))||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Gd(n.href);var u=Ze(l).hoistableStyles,d=u.get(e);if(d||(l=l.ownerDocument||l,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=l.querySelector(Kd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Fd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Fd.set(e,n),u||(r=l,o=e,s=n,c=d.state,r.querySelector('link[rel="preload"][as="style"]['+o+"]")?c.loading=1:(o=r.createElement("link"),c.preload=o,o.addEventListener("load",function(){return c.loading|=1}),o.addEventListener("error",function(){return c.loading|=2}),hd(o,"link",s),et(o),r.head.appendChild(o))))),t&&null===i)throw Error(a(528,""));return d}if(t&&null!==i)throw Error(a(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Qd(n),(i=(n=Ze(l).hoistableScripts).get(t))||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Gd(e){return'href="'+vt(e)+'"'}function Kd(e){return'link[rel="stylesheet"]['+e+"]"}function Jd(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function Qd(e){return'[src="'+vt(e)+'"]'}function $d(e){return"script[async]"+e}function Yd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+vt(n.href)+'"]');if(i)return t.instance=i,et(i),i;var r=p({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(i=(e.ownerDocument||e).createElement("style")),hd(i,"style",r),Xd(i,n.precedence,e),t.instance=i;case"stylesheet":r=Gd(n.href);var o=e.querySelector(Kd(r));if(o)return t.state.loading|=4,t.instance=o,et(o),o;i=Jd(n),(r=Fd.get(r))&&Zd(i,r),et(o=(e.ownerDocument||e).createElement("link"));var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),hd(o,"link",i),t.state.loading|=4,Xd(o,n.precedence,e),t.instance=o;case"script":return o=Qd(n.src),(r=e.querySelector($d(o)))?(t.instance=r,et(r),r):(i=n,(r=Fd.get(o))&&eh(i=p({},n),r),et(r=(e=e.ownerDocument||e).createElement("script")),hd(r,"link",i),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(i=t.instance,t.state.loading|=4,Xd(i,n.precedence,e));return t.instance}function Xd(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=i.length?i[i.length-1]:null,o=r,a=0;a<i.length;a++){var s=i[a];if(s.dataset.precedence===t)o=s;else if(o!==r)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Zd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var th=null;function nh(e,t,n){if(null===th){var i=new Map,r=th=new Map;r.set(n,i)}else(i=(r=th).get(n))||(i=new Map,r.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var o=n[r];if(!(o[Je]||o[ze]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var a=o.getAttribute(t)||"";a=e+a;var s=i.get(a);s?s.push(o):i.set(a,[o])}}return i}function ih(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function rh(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var oh=0;function ah(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)ch(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var sh=null;function ch(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,sh=new Map,t.forEach(lh,e),sh=null,ah.call(e))}function lh(e,t){if(!(4&t.state.loading)){var n=sh.get(e);if(n)var i=n.get(null);else{n=new Map,sh.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<r.length;o++){var a=r[o];"LINK"!==a.nodeName&&"not all"===a.getAttribute("media")||(n.set(a.dataset.precedence,a),i=a)}i&&n.set(null,i)}a=(r=t.instance).getAttribute("data-precedence"),(o=n.get(a)||i)===i&&n.set(null,r),n.set(a,r),this.count++,i=ah.bind(this),r.addEventListener("load",i),r.addEventListener("error",i),o?o.parentNode.insertBefore(r,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(r,e.firstChild),t.state.loading|=4}}var uh={$$typeof:S,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function dh(e,t,n,i,r,o,a,s,c){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ie(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ie(0),this.hiddenUpdates=Ie(null),this.identifierPrefix=i,this.onUncaughtError=r,this.onCaughtError=o,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function hh(e,t,n,i,r,o,a,s,c,l,u,d){return e=new dh(e,t,n,a,c,l,u,d,s),t=1,!0===o&&(t|=24),o=ji(3,null,null,t),e.current=o,o.stateNode=e,(t=Fr()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:i,isDehydrated:n,cache:t},vo(o),e}function ph(e){return e?e=Li:Li}function fh(e,t,n,i,r,o){r=ph(r),null===i.context?i.context=r:i.pendingContext=r,(i=bo(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(i.callback=o),null!==(n=ko(e,i,t))&&(Jl(n,0,t),So(n,e,t))}function mh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function gh(e,t){mh(e,t),(e=e.alternate)&&mh(e,t)}function vh(e){if(13===e.tag||31===e.tag){var t=Di(e,67108864);null!==t&&Jl(t,0,67108864),gh(e,67108864)}}function yh(e){if(13===e.tag||31===e.tag){var t=Gl(),n=Di(e,t=Le(t));null!==n&&Jl(n,0,t),gh(e,t)}}var bh=!0;function kh(e,t,n,i){var r=M.T;M.T=null;var o=A.p;try{A.p=2,Th(e,t,n,i)}finally{A.p=o,M.T=r}}function Sh(e,t,n,i){var r=M.T;M.T=null;var o=A.p;try{A.p=8,Th(e,t,n,i)}finally{A.p=o,M.T=r}}function Th(e,t,n,i){if(bh){var r=wh(i);if(null===r)td(e,t,i,Ch,n),Ah(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return xh=Lh(xh,e,t,n,i,r),!0;case"dragenter":return Oh=Lh(Oh,e,t,n,i,r),!0;case"mouseover":return _h=Lh(_h,e,t,n,i,r),!0;case"pointerover":var o=r.pointerId;return Ih.set(o,Lh(Ih.get(o)||null,e,t,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,Nh.set(o,Lh(Nh.get(o)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Ah(e,i),4&t&&-1<Mh.indexOf(e)){for(;null!==r;){var o=Ye(r);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var a=Pe(o.pendingLanes);if(0!==a){var s=o;for(s.pendingLanes|=2,s.entangledLanes|=2;a;){var c=1<<31-ke(a);s.entanglements[1]|=c,a&=~c}Au(o),0===(6&pl)&&(Ml=ce()+500,Lu(0,!1))}}break;case 31:case 13:null!==(s=Di(o,2))&&Jl(s,0,2),Zl(),gh(o,2)}if(null===(o=wh(i))&&td(e,t,i,Ch,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else td(e,t,i,null,n)}}function wh(e){return Eh(e=Mt(e))}var Ch=null;function Eh(e){if(Ch=null,null!==(e=$e(e))){var t=c(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=l(t)))return e;e=null}else if(31===n){if(null!==(e=u(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Ch=e,null}function Ph(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(le()){case ue:return 2;case de:return 8;case he:case pe:return 32;case fe:return 268435456;default:return 32}default:return 32}}var Rh=!1,xh=null,Oh=null,_h=null,Ih=new Map,Nh=new Map,Dh=[],Mh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ah(e,t){switch(e){case"focusin":case"focusout":xh=null;break;case"dragenter":case"dragleave":Oh=null;break;case"mouseover":case"mouseout":_h=null;break;case"pointerover":case"pointerout":Ih.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nh.delete(t.pointerId)}}function Lh(e,t,n,i,r,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==t&&(null!==(t=Ye(t))&&vh(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Uh(e){var t=$e(e.target);if(null!==t){var n=c(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=l(n)))return e.blockedOn=t,void Fe(e.priority,function(){yh(n)})}else if(31===t){if(null!==(t=u(n)))return e.blockedOn=t,void Fe(e.priority,function(){yh(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=wh(e.nativeEvent);if(null!==n)return null!==(t=Ye(n))&&vh(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);Dt=i,n.target.dispatchEvent(i),Dt=null,t.shift()}return!0}function Fh(e,t,n){jh(e)&&n.delete(t)}function Bh(){Rh=!1,null!==xh&&jh(xh)&&(xh=null),null!==Oh&&jh(Oh)&&(Oh=null),null!==_h&&jh(_h)&&(_h=null),Ih.forEach(Fh),Nh.forEach(Fh)}function zh(e,t){e.blockedOn===t&&(e.blockedOn=null,Rh||(Rh=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bh)))}var Vh=null;function qh(e){Vh!==e&&(Vh=e,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Vh===e&&(Vh=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],r=e[t+2];if("function"!==typeof i){if(null===Eh(i||n))continue;break}var o=Ye(n);null!==o&&(e.splice(t,3),t-=3,ts(o,{pending:!0,data:r,method:n.method,action:i},i,r))}}))}function Hh(e){function t(t){return zh(t,e)}null!==xh&&zh(xh,e),null!==Oh&&zh(Oh,e),null!==_h&&zh(_h,e),Ih.forEach(t),Nh.forEach(t);for(var n=0;n<Dh.length;n++){var i=Dh[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Dh.length&&null===(n=Dh[0]).blockedOn;)Uh(n),null===n.blockedOn&&Dh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(i=0;i<n.length;i+=3){var r=n[i],o=n[i+1],a=r[Ve]||null;if("function"===typeof o)a||qh(n);else if(a){var s=null;if(o&&o.hasAttribute("formAction")){if(r=o,a=o[Ve]||null)s=a.formAction;else if(null!==Eh(r))continue}else s=a.action;"function"===typeof s?n[i+1]=s:(n.splice(i,3),i-=3),qh(n)}}}function Wh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return r=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==r&&(r(),r=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var i=!1,r=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==r&&(r(),r=null)}}}function Gh(e){this._internalRoot=e}function Kh(e){this._internalRoot=e}Kh.prototype.render=Gh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));fh(t.current,Gl(),e,t,null,null)},Kh.prototype.unmount=Gh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fh(e.current,2,null,e,null,null),Zl(),t[qe]=null}},Kh.prototype.unstable_scheduleHydration=function(e){if(e){var t=je();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dh.length&&0!==t&&t<Dh[n].priority;n++);Dh.splice(n,0,e),0===n&&Uh(e)}};var Jh=r.version;if("19.2.0"!==Jh)throw Error(a(527,Jh,"19.2.0"));A.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=c(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return d(r),e;if(o===i)return d(r),t;o=o.sibling}throw Error(a(188))}if(n.return!==i.return)n=r,i=o;else{for(var s=!1,l=r.child;l;){if(l===n){s=!0,n=r,i=o;break}if(l===i){s=!0,i=r,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,i=r;break}if(l===i){s=!0,i=o,n=r;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==i)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Qh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:M,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var $h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$h.isDisabled&&$h.supportsFiber)try{ve=$h.inject(Qh),ye=$h}catch(Xh){}}t.createRoot=function(e,t){if(!s(e))throw Error(a(299));var n=!1,i="",r=Cs,o=Es,c=Ps;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(r=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(c=t.onRecoverableError)),t=hh(e,1,!1,null,0,n,i,null,r,o,c,Wh),e[qe]=t.current,Zu(e),new Gh(t)},t.hydrateRoot=function(e,t,n){if(!s(e))throw Error(a(299));var i=!1,r="",o=Cs,c=Es,l=Ps,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onUncaughtError&&(o=n.onUncaughtError),void 0!==n.onCaughtError&&(c=n.onCaughtError),void 0!==n.onRecoverableError&&(l=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=hh(e,1,!0,t,0,i,r,u,o,c,l,Wh)).context=ph(null),n=t.current,(r=bo(i=Le(i=Gl()))).callback=null,ko(n,r,i),n=i,t.current.lanes=n,Ne(t,n),Au(t),e[qe]=t.current,Zu(e),new Kh(t)},t.version="19.2.0"},43:(e,t,n)=>{e.exports=n(288)},288:(e,t)=>{var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),f=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}function b(){}function k(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var S=k.prototype=new b;S.constructor=k,g(S,y.prototype),S.isPureReactComponent=!0;var T=Array.isArray;function w(){}var C={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function P(e,t,i){var r=i.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:i}}function R(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var x=/\/+/g;function O(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function _(e,t,r,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c,l,u=!1;if(null===e)u=!0;else switch(s){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case i:u=!0;break;case h:return _((u=e._init)(e._payload),t,r,o,a)}}if(u)return a=a(e),u=""===o?"."+O(e,0):o,T(a)?(r="",null!=u&&(r=u.replace(x,"$&/")+"/"),_(a,t,r,"",function(e){return e})):null!=a&&(R(a)&&(c=a,l=r+(null==a.key||e&&e.key===a.key?"":(""+a.key).replace(x,"$&/")+"/")+u,a=P(c.type,l,c.props)),t.push(a)),1;u=0;var d,p=""===o?".":o+":";if(T(e))for(var m=0;m<e.length;m++)u+=_(o=e[m],t,r,s=p+O(o,m),a);else if("function"===typeof(m=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=m.call(e),m=0;!(o=e.next()).done;)u+=_(o=o.value,t,r,s=p+O(o,m++),a);else if("object"===s){if("function"===typeof e.then)return _(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(w,w):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,r,o,a);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function I(e,t,n){if(null==e)return e;var i=[],r=0;return _(e,i,"","",function(e){return t.call(n,e,r++)}),i}function N(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},M={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!R(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=p,t.Children=M,t.Component=y,t.Fragment=r,t.Profiler=a,t.PureComponent=k,t.StrictMode=o,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return C.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var i=g({},e.props),r=e.key;if(null!=t)for(o in void 0!==t.key&&(r=""+t.key),t)!E.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(i[o]=t[o]);var o=arguments.length-2;if(1===o)i.children=n;else if(1<o){for(var a=Array(o),s=0;s<o;s++)a[s]=arguments[s+2];i.children=a}return P(e.type,r,i)},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,n){var i,r={},o=null;if(null!=t)for(i in void 0!==t.key&&(o=""+t.key),t)E.call(t,i)&&"key"!==i&&"__self"!==i&&"__source"!==i&&(r[i]=t[i]);var a=arguments.length-2;if(1===a)r.children=n;else if(1<a){for(var s=Array(a),c=0;c<a;c++)s[c]=arguments[c+2];r.children=s}if(e&&e.defaultProps)for(i in a=e.defaultProps)void 0===r[i]&&(r[i]=a[i]);return P(e,o,r)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=R,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=C.T,n={};C.T=n;try{var i=e(),r=C.S;null!==r&&r(n,i),"object"===typeof i&&null!==i&&"function"===typeof i.then&&i.then(w,D)}catch(o){D(o)}finally{null!==t&&null!==n.types&&(t.types=n.types),C.T=t}},t.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},t.use=function(e){return C.H.use(e)},t.useActionState=function(e,t,n){return C.H.useActionState(e,t,n)},t.useCallback=function(e,t){return C.H.useCallback(e,t)},t.useContext=function(e){return C.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return C.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return C.H.useEffect(e,t)},t.useEffectEvent=function(e){return C.H.useEffectEvent(e)},t.useId=function(){return C.H.useId()},t.useImperativeHandle=function(e,t,n){return C.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return C.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return C.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return C.H.useMemo(e,t)},t.useOptimistic=function(e,t){return C.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return C.H.useReducer(e,t,n)},t.useRef=function(e){return C.H.useRef(e)},t.useState=function(e){return C.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return C.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return C.H.useTransition()},t.version="19.2.0"},391:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579:(e,t,n)=>{e.exports=n(799)},672:(e,t,n)=>{var i=n(43);function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var a={d:{f:o,r:function(){throw Error(r(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},s=Symbol.for("react.portal");var c=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(r(299));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=c.T,n=a.p;try{if(c.T=null,a.p=2,e)return e()}finally{c.T=t,a.p=n,a.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,a.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&a.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,i=l(n,t.crossOrigin),r="string"===typeof t.integrity?t.integrity:void 0,o="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?a.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:i,integrity:r,fetchPriority:o}):"script"===n&&a.d.X(e,{crossOrigin:i,integrity:r,fetchPriority:o,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=l(t.as,t.crossOrigin);a.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&a.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,i=l(n,t.crossOrigin);a.d.L(e,n,{crossOrigin:i,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=l(t.as,t.crossOrigin);a.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else a.d.m(e)},t.requestFormReset=function(e){a.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return c.H.useFormState(e,t,n)},t.useFormStatus=function(){return c.H.useHostTransitionStatus()},t.version="19.2.0"},799:(e,t)=>{var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.fragment");function r(e,t,i){var r=null;if(void 0!==i&&(r=""+i),void 0!==t.key&&(r=""+t.key),"key"in t)for(var o in i={},t)"key"!==o&&(i[o]=t[o]);else i=t;return t=i.ref,{$$typeof:n,type:e,key:r,ref:void 0!==t?t:null,props:i}}t.Fragment=i,t.jsx=r,t.jsxs=r},853:(e,t,n)=>{e.exports=n(896)},896:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<o(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,a=r>>>1;i<a;){var s=2*(i+1)-1,c=e[s],l=s+1,u=e[l];if(0>o(c,n))l<r&&0>o(u,c)?(e[i]=u,e[l]=n,i=l):(e[i]=c,e[s]=n,i=s);else{if(!(l<r&&0>o(u,n)))break e;e[i]=u,e[l]=n,i=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var l=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,k="undefined"!==typeof setImmediate?setImmediate:null;function S(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(l,t)}t=i(u)}}function T(e){if(g=!1,S(e),!m)if(null!==i(l))m=!0,C||(C=!0,w());else{var t=i(u);null!==t&&N(T,t.startTime-e)}}var w,C=!1,E=-1,P=5,R=-1;function x(){return!!v||!(t.unstable_now()-R<P)}function O(){if(v=!1,C){var e=t.unstable_now();R=e;var n=!0;try{e:{m=!1,g&&(g=!1,b(E),E=-1),f=!0;var o=p;try{t:{for(S(e),h=i(l);null!==h&&!(h.expirationTime>e&&x());){var a=h.callback;if("function"===typeof a){h.callback=null,p=h.priorityLevel;var s=a(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof s){h.callback=s,S(e),n=!0;break t}h===i(l)&&r(l),S(e)}else r(l);h=i(l)}if(null!==h)n=!0;else{var c=i(u);null!==c&&N(T,c.startTime-e),n=!1}}break e}finally{h=null,p=o,f=!1}n=void 0}}finally{n?w():C=!1}}}if("function"===typeof k)w=function(){k(O)};else if("undefined"!==typeof MessageChannel){var _=new MessageChannel,I=_.port2;_.port1.onmessage=O,w=function(){I.postMessage(null)}}else w=function(){y(O,0)};function N(e,n){E=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(u,e),null===i(l)&&e===i(u)&&(g?(b(E),E=-1):g=!0,N(T,o-a))):(e.sortIndex=s,n(l,e),m||f||(m=!0,C||(C=!0,w()))),e},t.unstable_shouldYield=x,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.m=e,n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,i)=>(n.f[i](e,t),t),[])),n.u=e=>"static/js/"+e+".e3bb357c.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="predict2:";n.l=(i,r,o,a)=>{if(e[i])e[i].push(r);else{var s,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==t+o){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+o),s.src=i),e[i]=[r];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var r=e[i];if(delete e[i],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach(e=>e(n)),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),c&&document.head.appendChild(s)}}})(),n.p="/",(()=>{var e={792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var o=new Promise((n,i)=>r=e[t]=[n,i]);i.push(r[2]=o);var a=n.p+n.u(t),s=new Error;n.l(a,i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,r[1](s)}},"chunk-"+t,t)}};var t=(t,i)=>{var r,o,[a,s,c]=i,l=0;if(a.some(t=>0!==e[t])){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(c)c(n)}for(t&&t(i);l<a.length;l++)o=a[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},i=self.webpackChunkpredict2=self.webpackChunkpredict2||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var i=n(43),r=n(391);function o(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}function c(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const d=["sri"],h=["page"],p=["page","matches"],f=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],m=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],g=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var v="popstate";function y(){return E(function(e,t){let{pathname:n,search:i,hash:r}=e.location;return T("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:w(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function b(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function k(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function S(e,t){return{usr:e.state,key:e.key,idx:t}}function T(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return u(u({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?C(t):t),{},{state:n,key:t&&t.key||i||Math.random().toString(36).substring(2,10)})}function w(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function C(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function E(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:r=document.defaultView,v5Compat:o=!1}=i,a=r.history,s="POP",c=null,l=d();function d(){return(a.state||{idx:null}).idx}function h(){s="POP";let e=d(),t=null==e?null:e-l;l=e,c&&c({action:s,location:f.location,delta:t})}function p(e){return P(e)}null==l&&(l=0,a.replaceState(u(u({},a.state),{},{idx:l}),""));let f={get action(){return s},get location(){return e(r,a)},listen(e){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(v,h),c=e,()=>{r.removeEventListener(v,h),c=null}},createHref:e=>t(r,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){s="PUSH";let i=T(f.location,e,t);n&&n(i,e),l=d()+1;let u=S(i,l),h=f.createHref(i);try{a.pushState(u,"",h)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;r.location.assign(h)}o&&c&&c({action:s,location:f.location,delta:1})},replace:function(e,t){s="REPLACE";let i=T(f.location,e,t);n&&n(i,e),l=d();let r=S(i,l),u=f.createHref(i);a.replaceState(r,"",u),o&&c&&c({action:s,location:f.location,delta:0})},go:e=>a.go(e)};return f}function P(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),b(n,"No window.location.(origin|href) available to create URL");let i="string"===typeof e?e:w(e);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=n+i),new URL(i,n)}new WeakMap;function R(e,t){return x(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function x(e,t,n,i){let r=q(("string"===typeof t?C(t):t).pathname||"/",n);if(null==r)return null;let o=O(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(o);let a=null;for(let s=0;null==a&&s<o.length;++s){let e=V(r);a=F(o[s],e,i)}return a}function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=function(e,o){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,s=arguments.length>3?arguments[3]:void 0,c={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};if(c.relativePath.startsWith("/")){if(!c.relativePath.startsWith(i)&&a)return;b(c.relativePath.startsWith(i),'Absolute route path "'.concat(c.relativePath,'" nested under path "').concat(i,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),c.relativePath=c.relativePath.slice(i.length)}let l=J([i,c.relativePath]),u=n.concat(c);e.children&&e.children.length>0&&(b(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(l,'".')),O(e.children,t,u,l,a)),(null!=e.path||e.index)&&t.push({path:l,score:j(l,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let i of _(e.path))o(e,t,!0,i);else o(e,t)}),t}function _(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,r=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===i.length)return r?[o,""]:[o];let a=_(i.join("/")),s=[];return s.push(...a.map(e=>""===e?o:[o,e].join("/"))),r&&s.push(...a),s.map(t=>e.startsWith("/")&&""===t?"/":t)}var I=/^:[\w-]+$/,N=3,D=2,M=1,A=10,L=-2,U=e=>"*"===e;function j(e,t){let n=e.split("/"),i=n.length;return n.some(U)&&(i+=L),t&&(i+=D),n.filter(e=>!U(e)).reduce((e,t)=>e+(I.test(t)?N:""===t?M:A),i)}function F(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:i}=e,r={},o="/",a=[];for(let s=0;s<i.length;++s){let e=i[s],c=s===i.length-1,l="/"===o?t:t.slice(o.length)||"/",u=B({path:e.relativePath,caseSensitive:e.caseSensitive,end:c},l),d=e.route;if(!u&&c&&n&&!i[i.length-1].route.index&&(u=B({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},l)),!u)return null;Object.assign(r,u.params),a.push({params:r,pathname:J([o,u.pathname]),pathnameBase:Q(J([o,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(o=J([o,u.pathnameBase]))}return a}function B(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=z(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let o=r[0],a=o.replace(/(.)\/+$/,"$1"),s=r.slice(1);return{params:i.reduce((e,t,n)=>{let{paramName:i,isOptional:r}=t;if("*"===i){let e=s[n]||"";a=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const c=s[n];return e[i]=r&&!c?void 0:(c||"").replace(/%2F/g,"/"),e},{}),pathname:o,pathnameBase:a,pattern:e}}function z(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];k("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(i.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function V(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return k(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function q(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}function H(e,t,n,i){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(i),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function W(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function G(e){let t=W(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function K(e,t,n){let i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?i=C(e):(i=u({},e),b(!i.pathname||!i.pathname.includes("?"),H("?","pathname","search",i)),b(!i.pathname||!i.pathname.includes("#"),H("#","pathname","hash",i)),b(!i.search||!i.search.includes("#"),H("#","search","hash",i)));let o,a=""===e||""===i.pathname,s=a?"/":i.pathname;if(null==s)o=n;else{let e=t.length-1;if(!r&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}o=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:i="",hash:r=""}="string"===typeof e?C(e):e,o=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:o,search:$(i),hash:Y(r)}}(i,o),l=s&&"/"!==s&&s.endsWith("/"),d=(a||"."===s)&&n.endsWith("/");return c.pathname.endsWith("/")||!l&&!d||(c.pathname+="/"),c}var J=e=>e.join("/").replace(/\/\/+/g,"/"),Q=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),$=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Y=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function X(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var Z=["POST","PUT","PATCH","DELETE"],ee=(new Set(Z),["GET",...Z]);new Set(ee),Symbol("ResetLoaderData");var te=i.createContext(null);te.displayName="DataRouter";var ne=i.createContext(null);ne.displayName="DataRouterState";var ie=i.createContext(!1);var re=i.createContext({isTransitioning:!1});re.displayName="ViewTransition";var oe=i.createContext(new Map);oe.displayName="Fetchers";var ae=i.createContext(null);ae.displayName="Await";var se=i.createContext(null);se.displayName="Navigation";var ce=i.createContext(null);ce.displayName="Location";var le=i.createContext({outlet:null,matches:[],isDataRoute:!1});le.displayName="Route";var ue=i.createContext(null);ue.displayName="RouteError";function de(){return null!=i.useContext(ce)}function he(){return b(de(),"useLocation() may be used only in the context of a <Router> component."),i.useContext(ce).location}var pe="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function fe(e){i.useContext(se).static||i.useLayoutEffect(e)}function me(){let{isDataRoute:e}=i.useContext(le);return e?function(){let{router:e}=Ce("useNavigate"),t=Pe("useNavigate"),n=i.useRef(!1);fe(()=>{n.current=!0});let r=i.useCallback(async function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k(n.current,pe),n.current&&("number"===typeof i?e.navigate(i):await e.navigate(i,u({fromRouteId:t},r)))},[e,t]);return r}():function(){b(de(),"useNavigate() may be used only in the context of a <Router> component.");let e=i.useContext(te),{basename:t,navigator:n}=i.useContext(se),{matches:r}=i.useContext(le),{pathname:o}=he(),a=JSON.stringify(G(r)),s=i.useRef(!1);fe(()=>{s.current=!0});let c=i.useCallback(function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(k(s.current,pe),!s.current)return;if("number"===typeof i)return void n.go(i);let c=K(i,JSON.parse(a),o,"path"===r.relative);null==e&&"/"!==t&&(c.pathname="/"===c.pathname?t:J([t,c.pathname])),(r.replace?n.replace:n.push)(c,r.state,r)},[t,n,a,o,e]);return c}()}i.createContext(null);function ge(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=i.useContext(le),{pathname:r}=he(),o=JSON.stringify(G(n));return i.useMemo(()=>K(e,JSON.parse(o),r,"path"===t),[e,o,r,t])}function ve(e,t,n,r,o){b(de(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=i.useContext(se),{matches:s}=i.useContext(le),c=s[s.length-1],l=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let e=p&&p.path||"";Oe(d,!p||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,m=he();if(t){var g;let e="string"===typeof t?C(t):t;b("/"===h||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=m;let v=f.pathname||"/",y=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let S=R(e,{pathname:y});k(p||null!=S,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),k(null==S||void 0!==S[S.length-1].route.element||void 0!==S[S.length-1].route.Component||void 0!==S[S.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let T=Te(S&&S.map(e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:J([h,a.encodeLocation?a.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:J([h,a.encodeLocation?a.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),s,n,r,o);return t&&T?i.createElement(ce.Provider,{value:{location:u({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},T):T}function ye(){let e=Re(),t=X(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=i.createElement(i.Fragment,null,i.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),i.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",i.createElement("code",{style:a},"ErrorBoundary")," or"," ",i.createElement("code",{style:a},"errorElement")," prop on your route.")),i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:o},n):null,s)}var be=i.createElement(ye,null),ke=class extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?i.createElement(le.Provider,{value:this.props.routeContext},i.createElement(ue.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Se(e){let{routeContext:t,match:n,children:r}=e,o=i.useContext(te);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(le.Provider,{value:t},r)}function Te(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let o=e,a=null===n||void 0===n?void 0:n.errors;if(null!=a){let e=o.findIndex(e=>e.route.id&&void 0!==(null===a||void 0===a?void 0:a[e.route.id]));b(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(a).join(","))),o=o.slice(0,Math.min(o.length,e+1))}let s=!1,c=-1;if(n)for(let i=0;i<o.length;i++){let e=o[i];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(c=i),e.route.id){let{loaderData:t,errors:i}=n,r=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!i||void 0===i[e.route.id]);if(e.route.lazy||r){s=!0,o=c>=0?o.slice(0,c+1):[o[0]];break}}}return o.reduceRight((e,l,u)=>{let d,h=!1,p=null,f=null;n&&(d=a&&l.route.id?a[l.route.id]:void 0,p=l.route.errorElement||be,s&&(c<0&&0===u?(Oe("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,f=null):c===u&&(h=!0,f=l.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,u+1)),g=()=>{let t;return t=d?p:h?f:l.route.Component?i.createElement(l.route.Component,null):l.route.element?l.route.element:e,i.createElement(Se,{match:l,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===u)?i.createElement(ke,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:r}):g()},null)}function we(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Ce(e){let t=i.useContext(te);return b(t,we(e)),t}function Ee(e){let t=i.useContext(ne);return b(t,we(e)),t}function Pe(e){let t=function(e){let t=i.useContext(le);return b(t,we(e)),t}(e),n=t.matches[t.matches.length-1];return b(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function Re(){var e;let t=i.useContext(ue),n=Ee("useRouteError"),r=Pe("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[r]}var xe={};function Oe(e,t,n){t||xe[e]||(xe[e]=!0,k(!1,n))}var _e={};function Ie(e,t){e||_e[t]||(_e[t]=!0,console.warn(t))}i.memo(function(e){let{routes:t,future:n,state:i,unstable_onError:r}=e;return ve(t,void 0,i,r,n)});function Ne(e){b(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function De(e){let{basename:t="/",children:n=null,location:r,navigationType:o="POP",navigator:a,static:s=!1}=e;b(!de(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),l=i.useMemo(()=>({basename:c,navigator:a,static:s,future:{}}),[c,a,s]);"string"===typeof r&&(r=C(r));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:f="default"}=r,m=i.useMemo(()=>{let e=q(u,c);return null==e?null:{location:{pathname:e,search:d,hash:h,state:p,key:f},navigationType:o}},[c,u,d,h,p,f,o]);return k(null!=m,'<Router basename="'.concat(c,'"> is not able to match the URL "').concat(u).concat(d).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:i.createElement(se.Provider,{value:l},i.createElement(ce.Provider,{children:n,value:m}))}function Me(e){let{children:t,location:n}=e;return ve(Ae(t),n)}i.Component;function Ae(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return i.Children.forEach(e,(e,r)=>{if(!i.isValidElement(e))return;let o=[...t,r];if(e.type===i.Fragment)return void n.push.apply(n,Ae(e.props.children,o));b(e.type===Ne,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),b(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||o.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=Ae(e.props.children,o)),n.push(a)}),n}var Le="get",Ue="application/x-www-form-urlencoded";function je(e){return null!=e&&"string"===typeof e.tagName}var Fe=null;var Be=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ze(e){return null==e||Be.has(e)?e:(k(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Ue,'"')),null)}function Ve(e,t){let n,i,r,o,a;if(je(s=e)&&"form"===s.tagName.toLowerCase()){let a=e.getAttribute("action");i=a?q(a,t):null,n=e.getAttribute("method")||Le,r=ze(e.getAttribute("enctype"))||Ue,o=new FormData(e)}else if(function(e){return je(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return je(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||a.getAttribute("action");if(i=s?q(s,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||Le,r=ze(e.getAttribute("formenctype"))||ze(a.getAttribute("enctype"))||Ue,o=new FormData(a,e),!function(){if(null===Fe)try{new FormData(document.createElement("form"),0),Fe=!1}catch(e){Fe=!0}return Fe}()){let{name:t,type:n,value:i}=e;if("image"===n){let e=t?"".concat(t,"."):"";o.append("".concat(e,"x"),"0"),o.append("".concat(e,"y"),"0")}else t&&o.append(t,i)}}else{if(je(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Le,i=null,r=Ue,a=e}var s;return o&&"text/plain"===r&&(a=o,o=void 0),{action:i,method:n.toLowerCase(),encType:r,formData:o,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function qe(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function He(e,t,n){let i="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===i.pathname?i.pathname="_root.".concat(n):t&&"/"===q(i.pathname,t)?i.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):i.pathname="".concat(i.pathname.replace(/\/$/,""),".").concat(n),i}async function We(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ge(e){return null!=e&&"string"===typeof e.page}function Ke(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Je(e,t,n,i,r,o){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,s=(e,t)=>{var i;return n[t].pathname!==e.pathname||(null===(i=n[t].route.path)||void 0===i?void 0:i.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===o?t.filter((e,t)=>a(e,t)||s(e,t)):"data"===o?t.filter((t,o)=>{let c=i.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(a(t,o)||s(t,o))return!0;if(t.route.shouldRevalidate){var l;let i=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:(null===(l=n[0])||void 0===l?void 0:l.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof i)return i}return!0}):[]}function Qe(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i=e.map(e=>{let i=t.routes[e.route.id];if(!i)return[];let r=[i.module];return i.clientActionModule&&(r=r.concat(i.clientActionModule)),i.clientLoaderModule&&(r=r.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(r=r.concat(i.hydrateFallbackModule)),i.imports&&(r=r.concat(i.imports)),r}).flat(1),[...new Set(i)];var i}function $e(e,t){let n=new Set,i=new Set(t);return e.reduce((e,r)=>{if(t&&!Ge(r)&&"script"===r.as&&r.href&&i.has(r.href))return e;let o=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let i of n)t[i]=e[i];return t}(r));return n.has(o)||(n.add(o),e.push({key:o,link:r})),e},[])}function Ye(e,t){return"lazy"===e.mode&&!0===t}function Xe(){let e=i.useContext(te);return qe(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Ze(){let e=i.useContext(ne);return qe(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var et=i.createContext(void 0);function tt(){let e=i.useContext(et);return qe(e,"You must render this element inside a <HydratedRouter> element"),e}function nt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function it(e,t,n){if(n&&!st)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}et.displayName="FrameworkContext";function rt(e){let{page:t}=e,n=o(e,h),{router:r}=Xe(),a=i.useMemo(()=>R(r.routes,t,r.basename),[r.routes,t,r.basename]);return a?i.createElement(at,u({page:t,matches:a},n)):null}function ot(e){let{manifest:t,routeModules:n}=tt(),[r,o]=i.useState([]);return i.useEffect(()=>{let i=!1;return async function(e,t,n){return $e((await Promise.all(e.map(async e=>{let i=t.routes[e.route.id];if(i){let e=await We(i,n);return e.links?e.links():[]}return[]}))).flat(1).filter(Ke).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?u(u({},e),{},{rel:"prefetch",as:"style"}):u(u({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{i||o(e)}),()=>{i=!0}},[e,t,n]),r}function at(e){let{page:t,matches:n}=e,r=o(e,p),a=he(),{manifest:s,routeModules:c}=tt(),{basename:l}=Xe(),{loaderData:d,matches:h}=Ze(),f=i.useMemo(()=>Je(t,n,h,s,a,"data"),[t,n,h,s,a]),m=i.useMemo(()=>Je(t,n,h,s,a,"assets"),[t,n,h,s,a]),g=i.useMemo(()=>{if(t===a.pathname+a.search+a.hash)return[];let e=new Set,i=!1;if(n.forEach(t=>{var n;let r=s.routes[t.route.id];r&&r.hasLoader&&(!f.some(e=>e.route.id===t.route.id)&&t.route.id in d&&null!==(n=c[t.route.id])&&void 0!==n&&n.shouldRevalidate||r.hasClientLoader?i=!0:e.add(t.route.id))}),0===e.size)return[];let r=He(t,l,"data");return i&&e.size>0&&r.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[r.pathname+r.search]},[l,d,a,s,f,n,t,c]),v=i.useMemo(()=>Qe(m,s),[m,s]),y=ot(m);return i.createElement(i.Fragment,null,g.map(e=>i.createElement("link",u({key:e,rel:"prefetch",as:"fetch",href:e},r))),v.map(e=>i.createElement("link",u({key:e,rel:"modulepreload",href:e},r))),y.map(e=>{let{key:t,link:n}=e;return i.createElement("link",u({key:t,nonce:r.nonce},n))}))}var st=!1;function ct(e){let{manifest:t,serverHandoffString:n,isSpaMode:r,renderMeta:a,routeDiscovery:s,ssr:c}=tt(),{router:l,static:h,staticContext:p}=Xe(),{matches:f}=Ze(),m=i.useContext(ie),g=Ye(s,c);a&&(a.didRenderScripts=!0);let v=it(f,null,r);i.useEffect(()=>{st=!0},[]);let y=i.useMemo(()=>{var r;if(m)return null;let a=p?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",s=h?"".concat(null!==(r=t.hmr)&&void 0!==r&&r.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(v.map((e,n)=>{let i="route".concat(n),r=t.routes[e.route.id];qe(r,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:o,clientLoaderModule:a,clientMiddlewareModule:s,hydrateFallbackModule:c,module:l}=r,u=[...o?[{module:o,varName:"".concat(i,"_clientAction")}]:[],...a?[{module:a,varName:"".concat(i,"_clientLoader")}]:[],...s?[{module:s,varName:"".concat(i,"_clientMiddleware")}]:[],...c?[{module:c,varName:"".concat(i,"_HydrateFallback")}]:[],{module:l,varName:"".concat(i,"_main")}];return 1===u.length?"import * as ".concat(i," from ").concat(JSON.stringify(l),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(i," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,i=o(e,d),r=new Set(t.state.matches.map(e=>e.route.id)),a=t.state.location.pathname.split("/").filter(Boolean),s=["/"];for(a.pop();a.length>0;)s.push("/".concat(a.join("/"))),a.pop();s.forEach(e=>{let n=R(t.routes,e,t.basename);n&&n.forEach(e=>r.add(e.route.id))});let c=[...r].reduce((e,t)=>Object.assign(e,{[t]:i.routes[t]}),{});return u(u({},i),{},{routes:c,sri:!!n||void 0})}(t,l),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return i.createElement(i.Fragment,null,i.createElement("script",u(u({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:a},type:void 0})),i.createElement("script",u(u({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:s},type:"module",async:!0})))},[]),b=st||m?[]:(k=t.entry.imports.concat(Qe(v,t,{includeHydrateFallback:!0})),[...new Set(k)]);var k;let S="object"===typeof t.sri?t.sri:{};return Ie(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),st||m?null:i.createElement(i.Fragment,null,"object"===typeof t.sri?i.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:S})}}):null,g?null:i.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:S[t.url],suppressHydrationWarning:!0}),i.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:S[t.entry.module],suppressHydrationWarning:!0}),b.map(t=>i.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:S[t],suppressHydrationWarning:!0})),y)}function lt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}i.Component;function ut(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let r,o=i.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(X(t))return i.createElement(dt,{title:"Unhandled Thrown Response!"},i.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),o);if(t instanceof Error)r=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);r=new Error(e)}return i.createElement(dt,{title:"Application Error!",isOutsideRemixApp:n},i.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),i.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),o)}function dt(e){var t;let{title:n,renderScripts:r,isOutsideRemixApp:o,children:a}=e,{routeModules:s}=tt();return null!==(t=s.root)&&void 0!==t&&t.Layout&&!o?a:i.createElement("html",{lang:"en"},i.createElement("head",null,i.createElement("meta",{charSet:"utf-8"}),i.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),i.createElement("title",null,n)),i.createElement("body",null,i.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},a,r?i.createElement(ct,null):null)))}var ht="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ht&&(window.__reactRouterVersion="7.9.4")}catch(dp){}function pt(e){let{basename:t,children:n,window:r}=e,o=i.useRef();null==o.current&&(o.current=y({window:r,v5Compat:!0}));let a=o.current,[s,c]=i.useState({action:a.action,location:a.location}),l=i.useCallback(e=>{i.startTransition(()=>c(e))},[c]);return i.useLayoutEffect(()=>a.listen(l),[a,l]),i.createElement(De,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:a})}var ft=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mt=i.forwardRef(function(e,t){let n,{onClick:r,discover:a="render",prefetch:s="none",relative:c,reloadDocument:l,replace:d,state:h,target:p,to:m,preventScrollReset:g,viewTransition:v}=e,y=o(e,f),{basename:S}=i.useContext(se),T="string"===typeof m&&ft.test(m),C=!1;if("string"===typeof m&&T&&(n=m,ht))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),n=q(t.pathname,S);t.origin===e.origin&&null!=n?m=n+t.search+t.hash:C=!0}catch(dp){k(!1,'<Link to="'.concat(m,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let E=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b(de(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=i.useContext(se),{hash:o,pathname:a,search:s}=ge(e,{relative:t}),c=a;return"/"!==n&&(c="/"===a?n:J([n,a])),r.createHref({pathname:c,search:s,hash:o})}(m,{relative:c}),[P,R,x]=function(e,t){let n=i.useContext(et),[r,o]=i.useState(!1),[a,s]=i.useState(!1),{onFocus:c,onBlur:l,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,p=i.useRef(null);i.useEffect(()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{s(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[e]),i.useEffect(()=>{if(r){let e=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(e)}}},[r]);let f=()=>{o(!0)},m=()=>{o(!1),s(!1)};return n?"intent"!==e?[a,p,{}]:[a,p,{onFocus:nt(c,f),onBlur:nt(l,m),onMouseEnter:nt(u,f),onMouseLeave:nt(d,m),onTouchStart:nt(h,f)}]:[!1,p,{}]}(s,y),O=function(e){let{target:t,replace:n,state:r,preventScrollReset:o,relative:a,viewTransition:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=me(),l=he(),u=ge(e,{relative:a});return i.useCallback(i=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(i,t)){i.preventDefault();let t=void 0!==n?n:w(l)===w(u);c(e,{replace:t,state:r,preventScrollReset:o,relative:a,viewTransition:s})}},[l,c,u,n,r,t,e,o,a,s])}(m,{replace:d,state:h,target:p,preventScrollReset:g,relative:c,viewTransition:v});let _=i.createElement("a",u(u(u({},y),x),{},{href:n||E,onClick:C||l?r:function(e){r&&r(e),e.defaultPrevented||O(e)},ref:lt(t,R),target:p,"data-discover":T||"render"!==a?void 0:"true"}));return P&&!T?i.createElement(i.Fragment,null,_,i.createElement(rt,{page:E})):_});mt.displayName="Link";var gt=i.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:r=!1,className:a="",end:s=!1,style:c,to:l,viewTransition:d,children:h}=e,p=o(e,m),f=ge(l,{relative:p.relative}),g=he(),v=i.useContext(ne),{navigator:y,basename:k}=i.useContext(se),S=null!=v&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.useContext(re);b(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=bt("useViewTransitionState"),o=ge(e,{relative:t});if(!n.isTransitioning)return!1;let a=q(n.currentLocation.pathname,r)||n.currentLocation.pathname,s=q(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=B(o.pathname,s)||null!=B(o.pathname,a)}(f)&&!0===d,T=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,w=g.pathname,C=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(w=w.toLowerCase(),C=C?C.toLowerCase():null,T=T.toLowerCase()),C&&k&&(C=q(C,k)||C);const E="/"!==T&&T.endsWith("/")?T.length-1:T.length;let P,R=w===T||!s&&w.startsWith(T)&&"/"===w.charAt(E),x=null!=C&&(C===T||!s&&C.startsWith(T)&&"/"===C.charAt(T.length)),O={isActive:R,isPending:x,isTransitioning:S},_=R?n:void 0;P="function"===typeof a?a(O):[a,R?"active":null,x?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let I="function"===typeof c?c(O):c;return i.createElement(mt,u(u({},p),{},{"aria-current":_,className:P,ref:t,style:I,to:l,viewTransition:d}),"function"===typeof h?h(O):h)});gt.displayName="NavLink";var vt=i.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:r,navigate:a,reloadDocument:s,replace:c,state:l,method:d=Le,action:h,onSubmit:p,relative:f,preventScrollReset:m,viewTransition:v}=e,y=o(e,g),k=Tt(),S=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=i.useContext(se),r=i.useContext(le);b(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),a=u({},ge(e||".",{relative:t})),s=he();if(null==e){a.search=s.search;let e=new URLSearchParams(a.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();a.search=n?"?".concat(n):""}}e&&"."!==e||!o.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(a.pathname="/"===a.pathname?n:J([n,a.pathname]));return w(a)}(h,{relative:f}),T="get"===d.toLowerCase()?"get":"post",C="string"===typeof h&&ft.test(h);return i.createElement("form",u(u({ref:t,method:T,action:S,onSubmit:s?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||d;k(t||e.currentTarget,{fetcherKey:r,method:n,navigate:a,replace:c,state:l,relative:f,preventScrollReset:m,viewTransition:v})}},y),{},{"data-discover":C||"render"!==n?void 0:"true"}))});function yt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function bt(e){let t=i.useContext(te);return b(t,yt(e)),t}vt.displayName="Form";var kt=0,St=()=>"__".concat(String(++kt),"__");function Tt(){let{router:e}=bt("useSubmit"),{basename:t}=i.useContext(se),n=Pe("useRouteId");return i.useCallback(async function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:o,method:a,encType:s,formData:c,body:l}=Ve(i,t);if(!1===r.navigate){let t=r.fetcherKey||St();await e.fetch(t,n,r.action||o,{preventScrollReset:r.preventScrollReset,formData:c,body:l,formMethod:r.method||a,formEncType:r.encType||s,flushSync:r.flushSync})}else await e.navigate(r.action||o,{preventScrollReset:r.preventScrollReset,formData:c,body:l,formMethod:r.method||a,formEncType:r.encType||s,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[e,t,n])}var wt=n(579);const Ct=function(){const e=me();return(0,wt.jsxs)("div",{className:"home-container",children:[(0,wt.jsx)("img",{src:"./plantsense-logo.png",alt:"PlantSense.AI Logo",className:"home-logo"}),(0,wt.jsx)("h1",{children:"Welcome to PlantSense.AI"}),(0,wt.jsx)("p",{children:"Detect plant diseases instantly and get insights powered by AI."}),(0,wt.jsx)("button",{onClick:()=>{e("/predict")},children:"Go to Disease Detection"})]})};function Et(e,t){return t.forEach(function(t){t&&"string"!==typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(n){if("default"!==n&&!(n in e)){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}})}),Object.freeze(e)}var Pt=Object.defineProperty,Rt=(e,t,n)=>((e,t,n)=>t in e?Pt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class xt{constructor(){Rt(this,"_locking"),Rt(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){let e;this._locks+=1;const t=new Promise(t=>e=()=>{this._locks-=1,t()}),n=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),n}}function Ot(e,t){if(!e)throw new Error(t)}function _t(e){if("number"!==typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function It(e){if("number"!==typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function Nt(e){if("number"!==typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}const Dt=Symbol("@bufbuild/protobuf/enum-type");function Mt(e){const t=e[Dt];return Ot(t,"missing enum type on enum object"),t}function At(e,t,n,i){e[Dt]=Lt(t,n.map(t=>({no:t.no,name:t.name,localName:e[t.no]})))}function Lt(e,t,n){const i=Object.create(null),r=Object.create(null),o=[];for(const a of t){const e=jt(a);o.push(e),i[a.name]=e,r[a.no]=e}return{typeName:e,values:o,findName:e=>i[e],findNumber:e=>r[e]}}function Ut(e,t,n){const i={};for(const r of t){const e=jt(r);i[e.localName]=e.no,i[e.no]=e.localName}return At(i,e,t),i}function jt(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class Ft{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType().runtime.bin,i=n.makeReadOptions(t);return n.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){const n=this.getType(),i=n.runtime.json,r=i.makeReadOptions(t);return i.readMessage(n,e,r,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(dp){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(dp instanceof Error?dp.message:String(dp)))}return this.fromJson(n,t)}toBinary(e){const t=this.getType().runtime.bin,n=t.makeWriteOptions(e),i=n.writerFactory();return t.writeMessage(this,i,n),i.finish()}toJson(e){const t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,null!==(t=null===e||void 0===e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Bt(){let e=0,t=0;for(let i=0;i<28;i+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,0==(128&n))return this.assertBounds(),[e,t];for(let i=3;i<=31;i+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function zt(e,t,n){for(let o=0;o<28;o+=7){const i=e>>>o,r=!(i>>>7==0&&0==t),a=255&(r?128|i:i);if(n.push(a),!r)return}const i=e>>>28&15|(7&t)<<4,r=!(t>>3==0);if(n.push(255&(r?128|i:i)),r){for(let e=3;e<31;e+=7){const i=t>>>e,r=!(i>>>7==0),o=255&(r?128|i:i);if(n.push(o),!r)return}n.push(t>>>31&1)}}const Vt=4294967296;function qt(e){const t="-"===e[0];t&&(e=e.slice(1));const n=1e6;let i=0,r=0;function o(t,o){const a=Number(e.slice(t,o));r*=n,i=i*n+a,i>=Vt&&(r+=i/Vt|0,i%=Vt)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),t?Gt(i,r):Wt(i,r)}function Ht(e,t){if(({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t)),t<=2097151)return String(Vt*t+e);const n=16777215&(e>>>24|t<<8),i=t>>16&65535;let r=(16777215&e)+6777216*n+6710656*i,o=n+8147497*i,a=2*i;const s=1e7;return r>=s&&(o+=Math.floor(r/s),r%=s),o>=s&&(a+=Math.floor(o/s),o%=s),a.toString()+Kt(o)+Kt(r)}function Wt(e,t){return{lo:0|e,hi:0|t}}function Gt(e,t){return t=~t,e?e=1+~e:t+=1,Wt(e,t)}const Kt=e=>{const t=String(e);return"0000000".slice(t.length)+t};function Jt(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function Qt(){let e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,0==(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let n=5;0!==(128&e)&&n<10;n++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}const $t=function(){const e=new DataView(new ArrayBuffer(8));if("function"===typeof BigInt&&"function"===typeof e.getBigInt64&&"function"===typeof e.getBigUint64&&"function"===typeof e.setBigInt64&&"function"===typeof e.setBigUint64&&("object"!=typeof process||"1"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.BUF_BIGINT_DISABLE)){const t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),i=BigInt("0"),r=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const i="bigint"==typeof e?e:BigInt(e);if(i>n||i<t)throw new Error("int64 invalid: ".concat(e));return i},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>r||t<i)throw new Error("uint64 invalid: ".concat(e));return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}const t=e=>Ot(/^-?[0-9]+$/.test(e),"int64 invalid: ".concat(e)),n=e=>Ot(/^[0-9]+$/.test(e),"uint64 invalid: ".concat(e));return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),t(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),n(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),t(e),qt(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),n(e),qt(e)),dec:(e,t)=>function(e,t){let n=Wt(e,t);const i=2147483648&n.hi;i&&(n=Gt(n.lo,n.hi));const r=Ht(n.lo,n.hi);return i?"-"+r:r}(e,t),uDec:(e,t)=>Ht(e,t)}}();var Yt,Xt,Zt;function en(e,t,n){if(t===n)return!0;if(e==Yt.BYTES){if(!(t instanceof Uint8Array)||!(n instanceof Uint8Array))return!1;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}switch(e){case Yt.UINT64:case Yt.FIXED64:case Yt.INT64:case Yt.SFIXED64:case Yt.SINT64:return t==n}return!1}function tn(e,t){switch(e){case Yt.BOOL:return!1;case Yt.UINT64:case Yt.FIXED64:case Yt.INT64:case Yt.SFIXED64:case Yt.SINT64:return 0==t?$t.zero:"0";case Yt.DOUBLE:case Yt.FLOAT:return 0;case Yt.BYTES:return new Uint8Array(0);case Yt.STRING:return"";default:return 0}}function nn(e,t){switch(e){case Yt.BOOL:return!1===t;case Yt.STRING:return""===t;case Yt.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return 0==t}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(Yt||(Yt={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING"}(Xt||(Xt={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(Zt||(Zt={}));class rn{constructor(e){this.stack=[],this.textEncoder=null!==e&&void 0!==e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let t=new Uint8Array(e),n=0;for(let i=0;i<this.chunks.length;i++)t.set(this.chunks[i],n),n+=this.chunks[i].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(It(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return _t(e),Jt(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){Nt(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){It(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){_t(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return _t(e),Jt(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=$t.enc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=$t.uEnc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=$t.enc(e);return zt(t.lo,t.hi,this.buf),this}sint64(e){let t=$t.enc(e),n=t.hi>>31;return zt(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=$t.uEnc(e);return zt(t.lo,t.hi,this.buf),this}}class on{constructor(e,t){this.varint64=Bt,this.uint32=Qt,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!==t&&void 0!==t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case Zt.Varint:for(;128&this.buf[this.pos++];);break;case Zt.Bit64:this.pos+=4;case Zt.Bit32:this.pos+=4;break;case Zt.LengthDelimited:let n=this.uint32();this.pos+=n;break;case Zt.StartGroup:for(;;){const[e,n]=this.tag();if(n===Zt.EndGroup){if(void 0!==t&&e!==t)throw new Error("invalid end group tag");break}this.skip(n,e)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return $t.dec(...this.varint64())}uint64(){return $t.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,$t.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return $t.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return $t.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function an(e){const t=e.field.localName,n=Object.create(null);return n[t]=function(e){const t=e.field;if(t.repeated)return[];if(void 0!==t.default)return t.default;switch(t.kind){case"enum":return t.T.values[0].no;case"scalar":return tn(t.T,t.L);case"message":const e=t.T,n=new e;return e.fieldWrapper?e.fieldWrapper.unwrapField(n):n;case"map":throw"map fields are not allowed to be extensions"}}(e),[n,()=>n[t]]}let sn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),cn=[];for(let hp=0;hp<sn.length;hp++)cn[sn[hp].charCodeAt(0)]=hp;cn["-".charCodeAt(0)]=sn.indexOf("+"),cn["_".charCodeAt(0)]=sn.indexOf("/");const ln={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,i=new Uint8Array(t),r=0,o=0,a=0;for(let s=0;s<e.length;s++){if(n=cn[e.charCodeAt(s)],void 0===n)switch(e[s]){case"=":o=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:a=n,o=1;break;case 1:i[r++]=a<<2|(48&n)>>4,a=n,o=2;break;case 2:i[r++]=(15&a)<<4|(60&n)>>2,a=n,o=3;break;case 3:i[r++]=(3&a)<<6|n,o=0}}if(1==o)throw Error("invalid base64 string.");return i.subarray(0,r)},enc(e){let t,n="",i=0,r=0;for(let o=0;o<e.length;o++)switch(t=e[o],i){case 0:n+=sn[t>>2],r=(3&t)<<4,i=1;break;case 1:n+=sn[r|t>>4],r=(15&t)<<2,i=2;break;case 2:n+=sn[r|t>>6],n+=sn[63&t],i=0}return i&&(n+=sn[r],n+="=",1==i&&(n+="=")),n}};function un(e,t,n){pn(t,e);const i=t.runtime.bin.makeReadOptions(n),r=function(e,t){if(!t.repeated&&("enum"==t.kind||"scalar"==t.kind)){for(let n=e.length-1;n>=0;--n)if(e[n].no==t.no)return[e[n]];return[]}return e.filter(e=>e.no===t.no)}(e.getType().runtime.bin.listUnknownFields(e),t.field),[o,a]=an(t);for(const s of r)t.runtime.bin.readField(o,i.readerFactory(s.data),t.field,s.wireType,i);return a()}function dn(e,t,n,i){pn(t,e);const r=t.runtime.bin.makeReadOptions(i),o=t.runtime.bin.makeWriteOptions(i);if(hn(e,t)){const n=e.getType().runtime.bin.listUnknownFields(e).filter(e=>e.no!=t.field.no);e.getType().runtime.bin.discardUnknownFields(e);for(const t of n)e.getType().runtime.bin.onUnknownField(e,t.no,t.wireType,t.data)}const a=o.writerFactory();let s=t.field;s.opt||s.repeated||"enum"!=s.kind&&"scalar"!=s.kind||(s=Object.assign(Object.assign({},t.field),{opt:!0})),t.runtime.bin.writeField(s,n,a,o);const c=r.readerFactory(a.finish());for(;c.pos<c.len;){const[t,n]=c.tag(),i=c.skip(n,t);e.getType().runtime.bin.onUnknownField(e,t,n,i)}}function hn(e,t){const n=e.getType();return t.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(e).find(e=>e.no==t.field.no)}function pn(e,t){Ot(e.extendee.typeName==t.getType().typeName,"extension ".concat(e.typeName," can only be applied to message ").concat(e.extendee.typeName))}function fn(e,t){const n=e.localName;if(e.repeated)return t[n].length>0;if(e.oneof)return t[e.oneof.localName].case===n;switch(e.kind){case"enum":case"scalar":return e.opt||e.req?void 0!==t[n]:"enum"==e.kind?t[n]!==e.T.values[0].no:!nn(e.T,t[n]);case"message":return void 0!==t[n];case"map":return Object.keys(t[n]).length>0}}function mn(e,t){const n=e.localName,i=!e.opt&&!e.req;if(e.repeated)t[n]=[];else if(e.oneof)t[e.oneof.localName]={case:void 0};else switch(e.kind){case"map":t[n]={};break;case"enum":t[n]=i?e.T.values[0].no:void 0;break;case"scalar":t[n]=i?tn(e.T,e.L):void 0;break;case"message":t[n]=void 0}}function gn(e,t){if(null===e||"object"!=typeof e)return!1;if(!Object.getOwnPropertyNames(Ft.prototype).every(t=>t in e&&"function"==typeof e[t]))return!1;const n=e.getType();return null!==n&&"function"==typeof n&&"typeName"in n&&"string"==typeof n.typeName&&(void 0===t||n.typeName==t.typeName)}function vn(e,t){return gn(t)||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}Yt.DOUBLE,Yt.FLOAT,Yt.INT64,Yt.UINT64,Yt.INT32,Yt.UINT32,Yt.BOOL,Yt.STRING,Yt.BYTES;const yn={ignoreUnknownFields:!1},bn={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function kn(e){return e?Object.assign(Object.assign({},yn),e):yn}function Sn(e){return e?Object.assign(Object.assign({},bn),e):bn}const Tn=Symbol(),wn=Symbol();function Cn(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return String(e)}}function En(e,t,n,i,r){let o=n.localName;if(n.repeated){if(Ot("map"!=n.kind),null===t)return;if(!Array.isArray(t))throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(Cn(t)));const a=e[o];for(const e of t){if(null===e)throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(Cn(e)));switch(n.kind){case"message":a.push(n.T.fromJson(e,i));break;case"enum":const t=xn(n.T,e,i.ignoreUnknownFields,!0);t!==wn&&a.push(t);break;case"scalar":try{a.push(Rn(n.T,e,n.L,!0))}catch(dp){let i="cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(Cn(e));throw dp instanceof Error&&dp.message.length>0&&(i+=": ".concat(dp.message)),new Error(i)}}}}else if("map"==n.kind){if(null===t)return;if("object"!=typeof t||Array.isArray(t))throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(Cn(t)));const a=e[o];for(const[e,o]of Object.entries(t)){if(null===o)throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: map value null"));let s;try{s=Pn(n.K,e)}catch(dp){let i="cannot decode map key for field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(Cn(t));throw dp instanceof Error&&dp.message.length>0&&(i+=": ".concat(dp.message)),new Error(i)}switch(n.V.kind){case"message":a[s]=n.V.T.fromJson(o,i);break;case"enum":const e=xn(n.V.T,o,i.ignoreUnknownFields,!0);e!==wn&&(a[s]=e);break;case"scalar":try{a[s]=Rn(n.V.T,o,Xt.BIGINT,!0)}catch(dp){let i="cannot decode map value for field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(Cn(t));throw dp instanceof Error&&dp.message.length>0&&(i+=": ".concat(dp.message)),new Error(i)}}}}else switch(n.oneof&&(e=e[n.oneof.localName]={case:o},o="value"),n.kind){case"message":const a=n.T;if(null===t&&"google.protobuf.Value"!=a.typeName)return;let s=e[o];gn(s)?s.fromJson(t,i):(e[o]=s=a.fromJson(t,i),a.fieldWrapper&&!n.oneof&&(e[o]=a.fieldWrapper.unwrapField(s)));break;case"enum":const c=xn(n.T,t,i.ignoreUnknownFields,!1);switch(c){case Tn:mn(n,e);break;case wn:break;default:e[o]=c}break;case"scalar":try{const i=Rn(n.T,t,n.L,!1);if(i===Tn)mn(n,e);else e[o]=i}catch(dp){let i="cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(Cn(t));throw dp instanceof Error&&dp.message.length>0&&(i+=": ".concat(dp.message)),new Error(i)}}}function Pn(e,t){if(e===Yt.BOOL)switch(t){case"true":t=!0;break;case"false":t=!1}return Rn(e,t,Xt.BIGINT,!0).toString()}function Rn(e,t,n,i){if(null===t)return i?tn(e,n):Tn;switch(e){case Yt.DOUBLE:case Yt.FLOAT:if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;const i=Number(t);if(Number.isNaN(i))break;if(!Number.isFinite(i))break;return e==Yt.FLOAT&&Nt(i),i;case Yt.INT32:case Yt.FIXED32:case Yt.SFIXED32:case Yt.SINT32:case Yt.UINT32:let r;if("number"==typeof t?r=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(r=Number(t)),void 0===r)break;return e==Yt.UINT32||e==Yt.FIXED32?It(r):_t(r),r;case Yt.INT64:case Yt.SFIXED64:case Yt.SINT64:if("number"!=typeof t&&"string"!=typeof t)break;const o=$t.parse(t);return n?o.toString():o;case Yt.FIXED64:case Yt.UINT64:if("number"!=typeof t&&"string"!=typeof t)break;const a=$t.uParse(t);return n?a.toString():a;case Yt.BOOL:if("boolean"!==typeof t)break;return t;case Yt.STRING:if("string"!==typeof t)break;try{encodeURIComponent(t)}catch(dp){throw new Error("invalid UTF8")}return t;case Yt.BYTES:if(""===t)return new Uint8Array(0);if("string"!==typeof t)break;return ln.dec(t)}throw new Error}function xn(e,t,n,i){if(null===t)return"google.protobuf.NullValue"==e.typeName?0:i?e.values[0].no:Tn;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const i=e.findName(t);if(void 0!==i)return i.no;if(n)return wn}throw new Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(Cn(t)))}function On(e){return!(!e.repeated&&"map"!=e.kind)||!e.oneof&&("message"!=e.kind&&(!e.opt&&!e.req))}function _n(e,t,n){if("map"==e.kind){Ot("object"==typeof t&&null!=t);const i={},r=Object.entries(t);switch(e.V.kind){case"scalar":for(const[n,o]of r)i[n.toString()]=Nn(e.V.T,o);break;case"message":for(const[e,o]of r)i[e.toString()]=o.toJson(n);break;case"enum":const t=e.V.T;for(const[e,o]of r)i[e.toString()]=In(t,o,n.enumAsInteger)}return n.emitDefaultValues||r.length>0?i:void 0}if(e.repeated){Ot(Array.isArray(t));const i=[];switch(e.kind){case"scalar":for(let n=0;n<t.length;n++)i.push(Nn(e.T,t[n]));break;case"enum":for(let r=0;r<t.length;r++)i.push(In(e.T,t[r],n.enumAsInteger));break;case"message":for(let e=0;e<t.length;e++)i.push(t[e].toJson(n))}return n.emitDefaultValues||i.length>0?i:void 0}switch(e.kind){case"scalar":return Nn(e.T,t);case"enum":return In(e.T,t,n.enumAsInteger);case"message":return vn(e.T,t).toJson(n)}}function In(e,t,n){var i;if(Ot("number"==typeof t),"google.protobuf.NullValue"==e.typeName)return null;if(n)return t;const r=e.findNumber(t);return null!==(i=null===r||void 0===r?void 0:r.name)&&void 0!==i?i:t}function Nn(e,t){switch(e){case Yt.INT32:case Yt.SFIXED32:case Yt.SINT32:case Yt.FIXED32:case Yt.UINT32:return Ot("number"==typeof t),t;case Yt.FLOAT:case Yt.DOUBLE:return Ot("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t;case Yt.STRING:return Ot("string"==typeof t),t;case Yt.BOOL:return Ot("boolean"==typeof t),t;case Yt.UINT64:case Yt.FIXED64:case Yt.INT64:case Yt.SFIXED64:case Yt.SINT64:return Ot("bigint"==typeof t||"string"==typeof t||"number"==typeof t),t.toString();case Yt.BYTES:return Ot(t instanceof Uint8Array),ln.enc(t)}}const Dn=Symbol("@bufbuild/protobuf/unknown-fields"),Mn={readUnknownFields:!0,readerFactory:e=>new on(e)},An={writeUnknownFields:!0,writerFactory:()=>new rn};function Ln(e){return e?Object.assign(Object.assign({},Mn),e):Mn}function Un(e){return e?Object.assign(Object.assign({},An),e):An}function jn(e,t,n,i,r){let{repeated:o,localName:a}=n;switch(n.oneof&&((e=e[n.oneof.localName]).case!=a&&delete e.value,e.case=a,a="value"),n.kind){case"scalar":case"enum":const s="enum"==n.kind?Yt.INT32:n.T;let c=zn;if("scalar"==n.kind&&n.L>0&&(c=Bn),o){let n=e[a];if(i==Zt.LengthDelimited&&s!=Yt.STRING&&s!=Yt.BYTES){let e=t.uint32()+t.pos;for(;t.pos<e;)n.push(c(t,s))}else n.push(c(t,s))}else e[a]=c(t,s);break;case"message":const l=n.T;o?e[a].push(Fn(t,new l,r,n)):gn(e[a])?Fn(t,e[a],r,n):(e[a]=Fn(t,new l,r,n),!l.fieldWrapper||n.oneof||n.repeated||(e[a]=l.fieldWrapper.unwrapField(e[a])));break;case"map":let[u,d]=function(e,t,n){const i=t.uint32(),r=t.pos+i;let o,a;for(;t.pos<r;){const[i]=t.tag();switch(i){case 1:o=zn(t,e.K);break;case 2:switch(e.V.kind){case"scalar":a=zn(t,e.V.T);break;case"enum":a=t.int32();break;case"message":a=Fn(t,new e.V.T,n,void 0)}}}void 0===o&&(o=tn(e.K,Xt.BIGINT));"string"!=typeof o&&"number"!=typeof o&&(o=o.toString());if(void 0===a)switch(e.V.kind){case"scalar":a=tn(e.V.T,Xt.BIGINT);break;case"enum":a=e.V.T.values[0].no;break;case"message":a=new e.V.T}return[o,a]}(n,t,r);e[a][u]=d}}function Fn(e,t,n,i){const r=t.getType().runtime.bin,o=null===i||void 0===i?void 0:i.delimited;return r.readMessage(t,e,o?i.no:e.uint32(),n,o),t}function Bn(e,t){const n=zn(e,t);return"bigint"==typeof n?n.toString():n}function zn(e,t){switch(t){case Yt.STRING:return e.string();case Yt.BOOL:return e.bool();case Yt.DOUBLE:return e.double();case Yt.FLOAT:return e.float();case Yt.INT32:return e.int32();case Yt.INT64:return e.int64();case Yt.UINT64:return e.uint64();case Yt.FIXED64:return e.fixed64();case Yt.BYTES:return e.bytes();case Yt.FIXED32:return e.fixed32();case Yt.SFIXED32:return e.sfixed32();case Yt.SFIXED64:return e.sfixed64();case Yt.SINT64:return e.sint64();case Yt.UINT32:return e.uint32();case Yt.SINT32:return e.sint32()}}function Vn(e,t,n,i){Ot(void 0!==t);const r=e.repeated;switch(e.kind){case"scalar":case"enum":let o="enum"==e.kind?Yt.INT32:e.T;if(r)if(Ot(Array.isArray(t)),e.packed)!function(e,t,n,i){if(!i.length)return;e.tag(n,Zt.LengthDelimited).fork();let[,r]=Gn(t);for(let o=0;o<i.length;o++)e[r](i[o]);e.join()}(n,o,e.no,t);else for(const i of t)Wn(n,o,e.no,i);else Wn(n,o,e.no,t);break;case"message":if(r){Ot(Array.isArray(t));for(const r of t)Hn(n,i,e,r)}else Hn(n,i,e,t);break;case"map":Ot("object"==typeof t&&null!=t);for(const[r,a]of Object.entries(t))qn(n,i,e,r,a)}}function qn(e,t,n,i,r){e.tag(n.no,Zt.LengthDelimited),e.fork();let o=i;switch(n.K){case Yt.INT32:case Yt.FIXED32:case Yt.UINT32:case Yt.SFIXED32:case Yt.SINT32:o=Number.parseInt(i);break;case Yt.BOOL:Ot("true"==i||"false"==i),o="true"==i}switch(Wn(e,n.K,1,o),n.V.kind){case"scalar":Wn(e,n.V.T,2,r);break;case"enum":Wn(e,Yt.INT32,2,r);break;case"message":Ot(void 0!==r),e.tag(2,Zt.LengthDelimited).bytes(r.toBinary(t))}e.join()}function Hn(e,t,n,i){const r=vn(n.T,i);n.delimited?e.tag(n.no,Zt.StartGroup).raw(r.toBinary(t)).tag(n.no,Zt.EndGroup):e.tag(n.no,Zt.LengthDelimited).bytes(r.toBinary(t))}function Wn(e,t,n,i){Ot(void 0!==i);let[r,o]=Gn(t);e.tag(n,r)[o](i)}function Gn(e){let t=Zt.Varint;switch(e){case Yt.BYTES:case Yt.STRING:t=Zt.LengthDelimited;break;case Yt.DOUBLE:case Yt.FIXED64:case Yt.SFIXED64:t=Zt.Bit64;break;case Yt.FIXED32:case Yt.SFIXED32:case Yt.FLOAT:t=Zt.Bit32}return[t,Yt[e].toLowerCase()]}function Kn(e){if(void 0===e)return e;if(gn(e))return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function Jn(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class Qn{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const e={};for(const t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){const e={};for(const t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function $n(e,t){const n=Xn(e);return t?n:ii(ni(n))}const Yn=Xn;function Xn(e){let t=!1;const n=[];for(let i=0;i<e.length;i++){let r=e.charAt(i);switch(r){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(r),t=!1;break;default:t&&(t=!1,r=r.toUpperCase()),n.push(r)}}return n.join("")}const Zn=new Set(["constructor","toString","toJSON","valueOf"]),ei=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),ti=e=>"".concat(e,"$"),ni=e=>ei.has(e)?ti(e):e,ii=e=>Zn.has(e)?ti(e):e;class ri{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=$n(e,!1)}addField(e){Ot(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}const oi=(ai=e=>new Qn(e,e=>function(e){var t,n,i,r,o,a;const s=[];let c;for(const l of"function"==typeof e?e():e){const e=l;if(e.localName=$n(l.name,void 0!==l.oneof),e.jsonName=null!==(t=l.jsonName)&&void 0!==t?t:Yn(l.name),e.repeated=null!==(n=l.repeated)&&void 0!==n&&n,"scalar"==l.kind&&(e.L=null!==(i=l.L)&&void 0!==i?i:Xt.BIGINT),e.delimited=null!==(r=l.delimited)&&void 0!==r&&r,e.req=null!==(o=l.req)&&void 0!==o&&o,e.opt=null!==(a=l.opt)&&void 0!==a&&a,void 0===l.packed&&(e.packed="enum"==l.kind||"scalar"==l.kind&&l.T!=Yt.BYTES&&l.T!=Yt.STRING),void 0!==l.oneof){const t="string"==typeof l.oneof?l.oneof:l.oneof.name;c&&c.name==t||(c=new ri(t)),e.oneof=c,c.addField(e)}s.push(e)}return s}(e)),si=e=>{for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,i=e;if(t.repeated)i[n]=[];else switch(t.kind){case"oneof":i[n]={case:void 0};break;case"enum":i[n]=0;break;case"map":i[n]={};break;case"scalar":i[n]=tn(t.T,t.L)}}},{syntax:"proto3",json:{makeReadOptions:kn,makeWriteOptions:Sn,readMessage(e,t,n,i){if(null==t||Array.isArray(t)||"object"!=typeof t)throw new Error("cannot decode message ".concat(e.typeName," from JSON: ").concat(Cn(t)));i=null!==i&&void 0!==i?i:new e;const r=new Map,o=n.typeRegistry;for(const[a,s]of Object.entries(t)){const t=e.fields.findJsonName(a);if(t){if(t.oneof){if(null===s&&"scalar"==t.kind)continue;const n=r.get(t.oneof);if(void 0!==n)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: multiple keys for oneof "').concat(t.oneof.name,'" present: "').concat(n,'", "').concat(a,'"'));r.set(t.oneof,a)}En(i,s,t,n,e)}else{let t=!1;if((null===o||void 0===o?void 0:o.findExtension)&&a.startsWith("[")&&a.endsWith("]")){const r=o.findExtension(a.substring(1,a.length-1));if(r&&r.extendee.typeName==e.typeName){t=!0;const[e,o]=an(r);En(e,s,r.field,n,r),dn(i,r,o(),n)}}if(!t&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: key "').concat(a,'" is unknown'))}}return i},writeMessage(e,t){const n=e.getType(),i={};let r;try{for(r of n.fields.byNumber()){if(!fn(r,e)){if(r.req)throw"required field not set";if(!t.emitDefaultValues)continue;if(!On(r))continue}const n=_n(r,r.oneof?e[r.oneof.localName].value:e[r.localName],t);void 0!==n&&(i[t.useProtoFieldName?r.name:r.jsonName]=n)}const o=t.typeRegistry;if(null===o||void 0===o?void 0:o.findExtensionFor)for(const r of n.runtime.bin.listUnknownFields(e)){const a=o.findExtensionFor(n.typeName,r.no);if(a&&hn(e,a)){const n=un(e,a,t),r=_n(a.field,n,t);void 0!==r&&(i[a.field.jsonName]=r)}}}catch(dp){const t=r?"cannot encode field ".concat(n.typeName,".").concat(r.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),i=dp instanceof Error?dp.message:String(dp);throw new Error(t+(i.length>0?": ".concat(i):""))}return i},readScalar:(e,t,n)=>Rn(e,t,null!==n&&void 0!==n?n:Xt.BIGINT,!0),writeScalar(e,t,n){if(void 0!==t)return n||nn(e,t)?Nn(e,t):void 0},debug:Cn},bin:{makeReadOptions:Ln,makeWriteOptions:Un,listUnknownFields(e){var t;return null!==(t=e[Dn])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[Dn]},writeUnknownFields(e,t){const n=e[Dn];if(n)for(const i of n)t.tag(i.no,i.wireType).raw(i.data)},onUnknownField(e,t,n,i){const r=e;Array.isArray(r[Dn])||(r[Dn]=[]),r[Dn].push({no:t,wireType:n,data:i})},readMessage(e,t,n,i,r){const o=e.getType(),a=r?t.len:t.pos+n;let s,c;for(;t.pos<a&&([s,c]=t.tag(),!0!==r||c!=Zt.EndGroup);){const n=o.fields.find(s);if(!n){const n=t.skip(c,s);i.readUnknownFields&&this.onUnknownField(e,s,c,n);continue}jn(e,t,n,c,i)}if(r&&(c!=Zt.EndGroup||s!==n))throw new Error("invalid end group tag")},readField:jn,writeMessage(e,t,n){const i=e.getType();for(const r of i.fields.byNumber())if(fn(r,e))Vn(r,r.oneof?e[r.oneof.localName].value:e[r.localName],t,n);else if(r.req)throw new Error("cannot encode field ".concat(i.typeName,".").concat(r.name," to binary: required field not set"));return n.writeUnknownFields&&this.writeUnknownFields(e,t),t},writeField(e,t,n,i){void 0!==t&&Vn(e,t,n,i)}},util:Object.assign(Object.assign({},{setEnumType:At,initPartial(e,t){if(void 0===e)return;const n=t.getType();for(const i of n.fields.byMember()){const n=i.localName,r=t,o=e;if(null!=o[n])switch(i.kind){case"oneof":const e=o[n].case;if(void 0===e)continue;const t=i.findField(e);let a=o[n].value;t&&"message"==t.kind&&!gn(a,t.T)?a=new t.T(a):t&&"scalar"===t.kind&&t.T===Yt.BYTES&&(a=Jn(a)),r[n]={case:e,value:a};break;case"scalar":case"enum":let s=o[n];i.T===Yt.BYTES&&(s=i.repeated?s.map(Jn):Jn(s)),r[n]=s;break;case"map":switch(i.V.kind){case"scalar":case"enum":if(i.V.T===Yt.BYTES)for(const[t,i]of Object.entries(o[n]))r[n][t]=Jn(i);else Object.assign(r[n],o[n]);break;case"message":const e=i.V.T;for(const t of Object.keys(o[n])){let i=o[n][t];e.fieldWrapper||(i=new e(i)),r[n][t]=i}}break;case"message":const c=i.T;if(i.repeated)r[n]=o[n].map(e=>gn(e,c)?e:new c(e));else{const e=o[n];c.fieldWrapper?"google.protobuf.BytesValue"===c.typeName?r[n]=Jn(e):r[n]=e:r[n]=gn(e,c)?e:new c(e)}}}},equals:(e,t,n)=>t===n||!(!t||!n)&&e.fields.byMember().every(e=>{const i=t[e.localName],r=n[e.localName];if(e.repeated){if(i.length!==r.length)return!1;switch(e.kind){case"message":return i.every((t,n)=>e.T.equals(t,r[n]));case"scalar":return i.every((t,n)=>en(e.T,t,r[n]));case"enum":return i.every((e,t)=>en(Yt.INT32,e,r[t]))}throw new Error("repeated cannot contain ".concat(e.kind))}switch(e.kind){case"message":let t=i,n=r;return e.T.fieldWrapper&&(void 0===t||gn(t)||(t=e.T.fieldWrapper.wrapField(t)),void 0===n||gn(n)||(n=e.T.fieldWrapper.wrapField(n))),e.T.equals(t,n);case"enum":return en(Yt.INT32,i,r);case"scalar":return en(e.T,i,r);case"oneof":if(i.case!==r.case)return!1;const o=e.findField(i.case);if(void 0===o)return!0;switch(o.kind){case"message":return o.T.equals(i.value,r.value);case"enum":return en(Yt.INT32,i.value,r.value);case"scalar":return en(o.T,i.value,r.value)}throw new Error("oneof cannot contain ".concat(o.kind));case"map":const a=Object.keys(i).concat(Object.keys(r));switch(e.V.kind){case"message":const t=e.V.T;return a.every(e=>t.equals(i[e],r[e]));case"enum":return a.every(e=>en(Yt.INT32,i[e],r[e]));case"scalar":const n=e.V.T;return a.every(e=>en(n,i[e],r[e]))}}}),clone(e){const t=e.getType(),n=new t,i=n;for(const r of t.fields.byMember()){const t=e[r.localName];let n;if(r.repeated)n=t.map(Kn);else if("map"==r.kind){n=i[r.localName];for(const[e,i]of Object.entries(t))n[e]=Kn(i)}else n="oneof"==r.kind?r.findField(t.case)?{case:t.case,value:Kn(t.value)}:{case:void 0}:Kn(t);i[r.localName]=n}for(const r of t.runtime.bin.listUnknownFields(e))t.runtime.bin.onUnknownField(i,r.no,r.wireType,r.data);return n}}),{newFieldList:ai,initFields:si}),makeMessageType(e,t,n){return function(e,t,n,i){var r;const o=null!==(r=null===i||void 0===i?void 0:i.localName)&&void 0!==r?r:t.substring(t.lastIndexOf(".")+1),a={[o]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[o];return Object.setPrototypeOf(a.prototype,new Ft),Object.assign(a,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:(e,t)=>(new a).fromBinary(e,t),fromJson:(e,t)=>(new a).fromJson(e,t),fromJsonString:(e,t)=>(new a).fromJsonString(e,t),equals:(t,n)=>e.util.equals(a,t,n)}),a}(this,e,t,n)},makeEnum:Ut,makeEnumType:Lt,getEnumType:Mt,makeExtension(e,t,n){return function(e,t,n,i){let r;return{typeName:t,extendee:n,get field(){if(!r){const n="function"==typeof i?i():i;n.name=t.split(".").pop(),n.jsonName="[".concat(t,"]"),r=e.util.newFieldList([n]).list()[0]}return r},runtime:e}}(this,e,t,n)}});var ai,si;class ci extends Ft{constructor(e){super(),this.seconds=$t.zero,this.nanos=0,oi.util.initPartial(e,this)}fromJson(e,t){if("string"!==typeof e)throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(oi.json.debug(e)));const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=$t.parse(i/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const e=(this.nanos+1e9).toString().substring(1);n="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return ci.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new ci({seconds:$t.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return(new ci).fromBinary(e,t)}static fromJson(e,t){return(new ci).fromJson(e,t)}static fromJsonString(e,t){return(new ci).fromJsonString(e,t)}static equals(e,t){return oi.util.equals(ci,e,t)}}ci.runtime=oi,ci.typeName="google.protobuf.Timestamp",ci.fields=oi.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const li=oi.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ci},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:ui,repeated:!0},{no:5,name:"events",kind:"message",T:hi,repeated:!0}]),ui=oi.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:di,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),di=oi.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ci},{no:3,name:"value",kind:"scalar",T:2}]),hi=oi.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:ci},{no:7,name:"normalized_end_timestamp",kind:"message",T:ci,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),pi=oi.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),fi=oi.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),mi=oi.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),gi=oi.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),vi=oi.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),yi=oi.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),bi=oi.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),ki=oi.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),Si=oi.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Ti=oi.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),wi=oi.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Ci,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:rr}]),Ci=oi.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),Ei=oi.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:oi.getEnumType(mi),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Pi=oi.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:oi.getEnumType(Ri)},{no:4,name:"tracks",kind:"message",T:Ni,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:Ei},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:oi.getEnumType(xi)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:oi.getEnumType(bi)},{no:18,name:"kind_details",kind:"enum",T:oi.getEnumType(Oi),repeated:!0}]),Ri=oi.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),xi=oi.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"}]),Oi=oi.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),_i=oi.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),Ii=oi.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Di,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:oi.getEnumType(Mi)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),Ni=oi.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:oi.getEnumType(fi)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:oi.getEnumType(mi)},{no:10,name:"layers",kind:"message",T:Di,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Ii,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:oi.getEnumType(_i)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:rr},{no:19,name:"audio_features",kind:"enum",T:oi.getEnumType(Ti),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:oi.getEnumType(pi)}]),Di=oi.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:oi.getEnumType(gi)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),Mi=oi.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),Ai=oi.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:oi.getEnumType(Li)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:zi,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Fi,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:Vi,oneof:"value"},{no:7,name:"transcription",kind:"message",T:qi,oneof:"value"},{no:8,name:"metrics",kind:"message",T:li,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Wi,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:Gi,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:Ki,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:Ji,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:cr,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:lr,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:ur,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:Ui,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),Li=oi.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),Ui=oi.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:oi.getEnumType(_i)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),ji=oi.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:zi,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:Wi,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:Gi,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:Ki,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:Ji,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:cr,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:lr,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:ur,oneof:"value"}]),Fi=oi.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:Bi,repeated:!0}]),Bi=oi.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),zi=oi.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),Vi=oi.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),qi=oi.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:Hi,repeated:!0}]),Hi=oi.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),Wi=oi.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),Gi=oi.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),Ki=oi.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),Ji=oi.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:Qi,oneof:"value"}]),Qi=oi.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),$i=oi.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),Yi=oi.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:oi.getEnumType(Xi)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),Xi=oi.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),Zi=oi.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:oi.getEnumType(er)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),er=oi.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),tr=oi.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:nr},{no:2,name:"screen",kind:"message",T:nr},{no:3,name:"resume_connection",kind:"enum",T:oi.getEnumType(yi)},{no:4,name:"disabled_codecs",kind:"message",T:ir},{no:5,name:"force_relay",kind:"enum",T:oi.getEnumType(yi)}]),nr=oi.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:oi.getEnumType(yi)}]),ir=oi.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:Ci,repeated:!0},{no:2,name:"publish",kind:"message",T:Ci,repeated:!0}]),rr=oi.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),or=oi.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),ar=oi.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:oi.getEnumType(or)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),sr=oi.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),cr=oi.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:oi.getEnumType(_i)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:ar,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:sr,oneof:"content_header"}],{localName:"DataStream_Header"}),lr=oi.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),ur=oi.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),dr=oi.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),hr=oi.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),pr=oi.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),fr=oi.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),mr=oi.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Er,oneof:"message"},{no:2,name:"answer",kind:"message",T:Er,oneof:"message"},{no:3,name:"trickle",kind:"message",T:br,oneof:"message"},{no:4,name:"add_track",kind:"message",T:yr,oneof:"message"},{no:5,name:"mute",kind:"message",T:kr,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Rr,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:xr,oneof:"message"},{no:8,name:"leave",kind:"message",T:Ir,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Dr,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Kr,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:$r,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Zr,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Mr,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:eo,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:Or,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:_r,oneof:"message"}]),gr=oi.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:Sr,oneof:"message"},{no:2,name:"answer",kind:"message",T:Er,oneof:"message"},{no:3,name:"offer",kind:"message",T:Er,oneof:"message"},{no:4,name:"trickle",kind:"message",T:br,oneof:"message"},{no:5,name:"update",kind:"message",T:Pr,oneof:"message"},{no:6,name:"track_published",kind:"message",T:wr,oneof:"message"},{no:8,name:"leave",kind:"message",T:Ir,oneof:"message"},{no:9,name:"mute",kind:"message",T:kr,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Lr,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Ur,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:Fr,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:zr,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Hr,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Jr,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:Cr,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:Tr,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:to,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:ro,oneof:"message"},{no:22,name:"request_response",kind:"message",T:oo,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:so,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:Qr,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:po,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:Wr,oneof:"message"}]),vr=oi.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Di,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:oi.getEnumType(Mi)}]),yr=oi.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:oi.getEnumType(fi)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:oi.getEnumType(mi)},{no:9,name:"layers",kind:"message",T:Di,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:vr,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:oi.getEnumType(_i)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:oi.getEnumType(pi)},{no:17,name:"audio_features",kind:"enum",T:oi.getEnumType(Ti),repeated:!0}]),br=oi.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:oi.getEnumType(hr)},{no:3,name:"final",kind:"scalar",T:8}]),kr=oi.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),Sr=oi.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:wi},{no:2,name:"participant",kind:"message",T:Pi},{no:3,name:"other_participants",kind:"message",T:Pi,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Ar,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:tr},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Yi},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:Ci,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),Tr=oi.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:Ar,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:tr},{no:3,name:"server_info",kind:"message",T:Yi},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),wr=oi.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Ni}]),Cr=oi.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Er=oi.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),Pr=oi.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Pi,repeated:!0}]),Rr=oi.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:$i,repeated:!0}]),xr=oi.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:oi.getEnumType(gi)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),Or=oi.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:oi.getEnumType(Ti),repeated:!0}]),_r=oi.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Ir=oi.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:oi.getEnumType(bi)},{no:3,name:"action",kind:"enum",T:oi.getEnumType(Nr)},{no:4,name:"regions",kind:"message",T:no}]),Nr=oi.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),Dr=oi.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Di,repeated:!0}]),Mr=oi.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),Ar=oi.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),Lr=oi.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:Bi,repeated:!0}]),Ur=oi.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:wi}]),jr=oi.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:oi.getEnumType(vi)},{no:3,name:"score",kind:"scalar",T:2}]),Fr=oi.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:jr,repeated:!0}]),Br=oi.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:oi.getEnumType(pr)}]),zr=oi.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:Br,repeated:!0}]),Vr=oi.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:oi.getEnumType(gi)},{no:2,name:"enabled",kind:"scalar",T:8}]),qr=oi.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Vr,repeated:!0}]),Hr=oi.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Vr,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:qr,repeated:!0}]),Wr=oi.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:dr,repeated:!0}]),Gr=oi.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),Kr=oi.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:Gr,repeated:!0}]),Jr=oi.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),Qr=oi.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:wi},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:Pi},{no:4,name:"other_participants",kind:"message",T:Pi,repeated:!0}]),$r=oi.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Er},{no:2,name:"subscription",kind:"message",T:Rr},{no:3,name:"publish_tracks",kind:"message",T:wr,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Xr,repeated:!0},{no:5,name:"offer",kind:"message",T:Er},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:Yr,repeated:!0}]),Yr=oi.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),Xr=oi.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:oi.getEnumType(hr)}]),Zr=oi.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:oi.getEnumType(fr),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),eo=oi.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),to=oi.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),no=oi.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:io,repeated:!0}]),io=oi.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),ro=oi.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:oi.getEnumType(Si)}]),oo=oi.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:oi.getEnumType(ao)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:br,oneof:"request"},{no:5,name:"add_track",kind:"message",T:yr,oneof:"request"},{no:6,name:"mute",kind:"message",T:kr,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:Mr,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:Or,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:_r,oneof:"request"}]),ao=oi.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"}]),so=oi.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),co=oi.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8}]),lo=oi.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:Zi},{no:2,name:"connection_settings",kind:"message",T:co},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:yr,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:Er},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:oi.getEnumType(ki)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:$r}]),uo=oi.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:oi.getEnumType(ho)},{no:2,name:"join_request",kind:"scalar",T:12}]),ho=oi.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),po=oi.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function fo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var mo,go={exports:{}},vo=go.exports;var yo,bo,ko=function(){return mo||(mo=1,e=go,function(t,n){e.exports?e.exports=n():t.log=n()}(vo,function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],r={},o=null;function a(e,t){var n=e[t];if("function"===typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(dp){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(){for(var n=this.getLevel(),r=0;r<i.length;r++){var o=i[r];this[o]=r<n?e:this.methodFactory(o,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function l(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function u(i,r,o){return function(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?s:void 0!==console[i]?a(console,i):void 0!==console.log?a(console,"log"):e)}(i)||l.apply(this,arguments)}function d(e,n){var a,s,l,d=this,h="loglevel";function p(){var e;if(typeof window!==t&&h){try{e=window.localStorage[h]}catch(o){}if(typeof e===t)try{var n=window.document.cookie,i=encodeURIComponent(h),r=n.indexOf(i+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r+i.length+1))[1])}catch(o){}return void 0===d.levels[e]&&(e=void 0),e}}function f(e){var t=e;if("string"===typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"===typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"===typeof e?h+=":"+e:"symbol"===typeof e&&(h=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||u,d.getLevel=function(){return null!=l?l:null!=s?s:a},d.setLevel=function(e,n){return l=f(e),!1!==n&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&h){try{return void(window.localStorage[h]=n)}catch(r){}try{window.document.cookie=encodeURIComponent(h)+"="+n+";"}catch(r){}}}(l),c.call(d)},d.setDefaultLevel=function(e){s=f(e),p()||d.setLevel(e,!1)},d.resetLevel=function(){l=null,function(){if(typeof window!==t&&h){try{window.localStorage.removeItem(h)}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),c.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(o!==d&&(a=f(o.getLevel())),c.call(d),o===d)for(var e in r)r[e].rebuild()},a=f(o?o.getLevel():"WARN");var m=p();null!=m&&(l=f(m)),c.call(d)}(o=new d).getLogger=function(e){if("symbol"!==typeof e&&"string"!==typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=r[e];return t||(t=r[e]=new d(e,o.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=h),o},o.getLoggers=function(){return r},o.default=o,o})),go.exports;var e}();!function(e){e[e.trace=0]="trace",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.silent=5]="silent"}(yo||(yo={})),function(e){e.Default="livekit",e.Room="livekit-room",e.TokenSource="livekit-token-source",e.Participant="livekit-participant",e.Track="livekit-track",e.Publication="livekit-track-publication",e.Engine="livekit-engine",e.Signal="livekit-signal",e.PCManager="livekit-pc-manager",e.PCTransport="livekit-pc-transport",e.E2EE="lk-e2ee"}(bo||(bo={}));let So=ko.getLogger("livekit");Object.values(bo).map(e=>ko.getLogger(e));function To(e){const t=ko.getLogger(e);return t.setDefaultLevel(So.getLevel()),t}So.setDefaultLevel(yo.info);const wo=ko.getLogger("lk-e2ee"),Co=7e3,Eo=[0,300,1200,2700,4800,Co,Co,Co,Co,Co];function Po(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function Ro(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{c(i.next(e))}catch(dp){o(dp)}}function s(e){try{c(i.throw(e))}catch(dp){o(dp)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((i=i.apply(e,t||[])).next())})}function xo(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Oo(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=xo(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,r){(function(e,t,n,i){Promise.resolve(i).then(function(t){e({value:t,done:n})},t)})(i,r,(t=e[n](t)).done,t.value)})}}}"function"===typeof SuppressedError&&SuppressedError;var _o,Io={exports:{}};var No=function(){if(_o)return Io.exports;_o=1;var e,t="object"===typeof Reflect?Reflect:null,n=t&&"function"===typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};e=t&&"function"===typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function r(){r.init.call(this)}Io.exports=r,Io.exports.once=function(e,t){return new Promise(function(n,i){function r(n){e.removeListener(t,o),i(n)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}f(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&f(e,"error",t,n)}(e,r,{once:!0})})},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function s(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var r,o,c;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),c=o[t]),void 0===c)c=o[t]=n,++e._eventsCount;else if("function"===typeof c?c=o[t]=i?[n,c]:[c,n]:i?c.unshift(n):c.push(n),(r=s(e))>0&&c.length>r&&!c.warned){c.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=c.length,function(e){console&&console.warn&&console.warn(e)}(l)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=l.bind(i);return r.listener=n,i.wrapFn=r,r}function d(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"===typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):p(r,r.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function f(e,t,n,i){if("function"===typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function r(o){i.once&&e.removeEventListener(t,r),n(o)})}}return Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),r.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return s(this)},r.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[e];if(void 0===c)return!1;if("function"===typeof c)n(c,this,t);else{var l=c.length,u=p(c,l);for(i=0;i<l;++i)n(u[i],this,t)}return!0},r.prototype.addListener=function(e,t){return c(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return c(this,e,t,!0)},r.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,i,r,o,s;if(a(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},r.prototype.listeners=function(e){return d(this,e,!0)},r.prototype.rawListeners=function(e){return d(this,e,!1)},r.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},r.prototype.listenerCount=h,r.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},Io.exports}();let Do=!0,Mo=!0;function Ao(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseFloat(i[n],10)}function Lo(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);const o=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,o),r.apply(this,[e,o])};const o=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function Uo(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Do=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function jo(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Mo=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Fo(){if("object"===typeof window){if(Do)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function Bo(e,t){Mo&&console.warn(e+" is deprecated, please use "+t+" instead.")}function zo(e){return"[object Object]"===Object.prototype.toString.call(e)}function Vo(e){return zo(e)?Object.keys(e).reduce(function(t,n){const i=zo(e[n]),r=i?Vo(e[n]):e[n],o=i&&!Object.keys(r).length;return void 0===r||o?t:Object.assign(t,{[n]:r})},{}):e}function qo(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(i=>{i.endsWith("Id")?qo(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach(t=>{qo(e,e.get(t),n)})}))}function Ho(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;const o=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(t=>{e.forEach(n=>{n.type===i&&n.trackId===t.id&&qo(e,n,r)})}),r}const Wo=Fo;function Go(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!==typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"===typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"===typeof i.exact&&(i.min=i.max=i.exact);const r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"===typeof i.ideal?(e[r("min",n)]=i.ideal,t.optional.push(e),e={},e[r("max",n)]=i.ideal,t.optional.push(e)):(e[r("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!==typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach(e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"===typeof e.video){let o=e.video.facingMode;o=o&&("object"===typeof o?o:{ideal:o});const a=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||a)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then(n=>{let a=(n=n.filter(e=>"videoinput"===e.kind)).find(e=>t.some(t=>e.label.toLowerCase().includes(t)));return!a&&n.length&&t.includes("back")&&(a=n[n.length-1]),a&&(e.video.deviceId=o.exact?{exact:a.deviceId}:{ideal:a.deviceId}),e.video=i(e.video),Wo("chrome: "+JSON.stringify(e)),r(e)})}e.video=i(e.video)}return Wo("chrome: "+JSON.stringify(e)),r(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){r(e,e=>{n.webkitGetUserMedia(e,t,e=>{i&&i(o(e))})})}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return r(t,t=>e(t).then(e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>Promise.reject(o(e))))}}}function Ko(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Jo(e){if("object"===typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.track.id):{track:n.track};const r=new Event("track");r.track=n.track,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)}),t.stream.getTracks().forEach(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.id):{track:n};const r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Lo(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Qo(e){if("object"===typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let r=n.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"===typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function $o(e){if(!("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>Ho(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),Lo(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>Ho(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach(n=>{n.track===e&&(t?i=!0:t=n)}),this.getReceivers().forEach(t=>(t.track===e&&(n?i=!0:n=t),t.track===e)),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Yo(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),r.apply(this,arguments)}}function Xo(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Yo(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const r=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(e=>e.track===t))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const r=this._streams[n.id];if(r)r.addTrack(t),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"===typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(e=>o(this,e))}};e.RTCPeerConnection.prototype[t]=i[t]});const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach(n=>{this._streams[n].getTracks().find(t=>e.track===t)&&(t=this._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Zo(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]})}function ea(e,t){Lo(e,"negotiationneeded",e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e})}var ta=Object.freeze({__proto__:null,fixNegotiationNeeded:ea,shimAddTrackRemoveTrack:Xo,shimAddTrackRemoveTrackWithNative:Yo,shimGetSendersWithDtmf:Qo,shimGetUserMedia:Go,shimMediaStream:Ko,shimOnTrack:Jo,shimPeerConnection:Zo,shimSenderReceiverGetStats:$o});function na(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){Bo("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"===typeof n&&"object"===typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"===typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function ia(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ra(e,t){if("object"!==typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,o]=arguments;return i.apply(this,[e||null]).then(e=>{if(t.version<53&&!r)try{e.forEach(e=>{e.type=n[e.type]||e.type})}catch(dp){if("TypeError"!==dp.name)throw dp;e.forEach((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(r,o)}}function oa(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function aa(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),Lo(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function sa(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){Bo("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function ca(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function la(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach(e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then(()=>{delete t.sendEncodings}).catch(()=>{delete t.sendEncodings})))}return i})}function ua(e){if("object"!==typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function da(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function ha(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var pa=Object.freeze({__proto__:null,shimAddTransceiver:la,shimCreateAnswer:ha,shimCreateOffer:da,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:ua,shimGetUserMedia:na,shimOnTrack:ia,shimPeerConnection:ra,shimRTCDataChannel:ca,shimReceiverGetStats:aa,shimRemoveStream:sa,shimSenderGetStats:oa});function fa(e){if("object"===typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(n=>t.call(this,n,e)),e.getVideoTracks().forEach(n=>t.call(this,n,e))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i&&i.forEach(e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach(e=>{n.includes(e.track)&&this.removeTrack(e)})})}}function ma(e){if("object"===typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach(e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)})}),t.apply(e,arguments)}}}function ga(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,r=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r};let s=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=s,s=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=s,s=function(e,t,n){const i=a.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=s}function va(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(ya(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function ya(e){return e&&void 0!==e.video?Object.assign({},e,{video:Vo(e.video)}):e}function ba(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];void 0===i.urls&&i.url?(Bo("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function ka(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Sa(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find(e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Ta(e){"object"!==typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var wa,Ca=Object.freeze({__proto__:null,shimAudioContext:Ta,shimCallbacksAPI:ga,shimConstraints:ya,shimCreateOfferLegacy:Sa,shimGetUserMedia:va,shimLocalStreamsAPI:fa,shimRTCIceServerUrls:ba,shimRemoteStreamsAPI:ma,shimTrackEventTransceiver:ka}),Ea={exports:{}};var Pa=(wa||(wa=1,function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map(e=>e.trim())},t.splitSections=function(e){return e.split("\nm=").map((e,t)=>(t>0?"m="+e:e).trim()+"\r\n")},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter(e=>0===e.indexOf(n))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:void 0===n[t[i]]&&(n[t[i]]=t[i+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const i=e.substring(e.indexOf(" ")+1).split(";");for(let r=0;r<i.length;r++)n=i[r].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const i=[];Object.keys(e.parameters).forEach(t=>{void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)}),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substring(t+1,i),n.value=e.substring(i+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(e=>parseInt(e,10))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],r=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&r?{usernameFragment:i.substring(12),password:r.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" ");n.profile=i[2];for(let o=3;o<i.length;o++){const r=i[o],a=t.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(a){const i=t.parseRtpMap(a),o=t.matchPrefix(e,"a=fmtp:"+r+" ");switch(i.parameters=o.length?t.parseFmtp(o[0]):{},i.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(t.parseRtcpFb),n.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(i.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach(e=>{n.headerExtensions.push(t.parseExtmap(e))});const r=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach(e=>{r.forEach(t=>{e.rtcpFeedback.find(e=>e.type===t.type&&e.parameter===t.parameter)||e.rtcpFeedback.push(t)})}),n},t.writeRtpDescription=function(e,n){let i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map(e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach(e=>{i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)});let r=0;return n.codecs.forEach(e=>{e.maxptime>r&&(r=e.maxptime)}),r>0&&(i+="a=maxptime:"+r+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach(e=>{i+=t.writeExtmap(e)}),i},t.parseRtpEncodingParameters=function(e){const n=[],i=t.parseRtpParameters(e),r=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute),s=a.length>0&&a[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map(e=>e.substring(17).split(" ").map(e=>parseInt(e,10)));l.length>0&&l[0].length>1&&l[0][0]===s&&(c=l[0][1]),i.codecs.forEach(e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&c&&(t.rtx={ssrc:c}),n.push(t),r&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:s,mechanism:o?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&s&&n.push({ssrc:s});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach(e=>{e.maxBitrate=u})),n},t.parseRtcpParameters=function(e){const n={},i=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute)[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const r=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=r.length>0,n.compound=0===r.length;const o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const i=t.matchPrefix(e,"a=msid:");if(1===i.length)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const r=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"msid"===e.attribute);return r.length>0?(n=r[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");let r;i.length>0&&(r=parseInt(i[0].substring(19),10)),isNaN(r)&&(r=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:n.fmt,maxMessageSize:r};const a=t.matchPrefix(e,"a=sctpmap:");if(a.length>0){const e=a[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,i){let r;const o=void 0!==n?n:2;return r=e||t.generateSessionId(),"v=0\r\no="+(i||"thisisadapterortc")+" "+r+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const i=t.splitLines(e);for(let t=0;t<i.length;t++)switch(i[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[t].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let t=0;t<n.length;t++)if(n[t].length<2||"="!==n[t].charAt(1))return!1;return!0},e.exports=t}(Ea)),Ea.exports),Ra=fo(Pa),xa=Et({__proto__:null,default:Ra},[Pa]);function Oa(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),i=Ra.parseCandidate(e.candidate);for(const e in i)e in n||Object.defineProperty(n,e,{value:i[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Lo(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function _a(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Lo(e,"icecandidate",e=>{if(e.candidate){const t=Ra.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function Ia(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=Ra.splitSections(e.sdp);return t.shift(),t.some(e=>{const t=Ra.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!==n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const r=Ra.matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?i=parseInt(r[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let r;r=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>r}),this._sctp=o}return n.apply(this,arguments)}}function Na(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],r=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},Lo(e,"datachannel",e=>(t(e.channel,e.target),e))}function Da(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function Ma(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t._safariVersion>=13.1)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==e.trim()).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function Aa(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function La(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!==typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}if(e.sdp||"offer"!==e.type&&"answer"!==e.type)return n.apply(this,[e]);return("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then(e=>n.apply(this,[e]))})}var Ua=Object.freeze({__proto__:null,removeExtmapAllowMixed:Ma,shimAddIceCandidateNullOrEmpty:Aa,shimConnectionState:Da,shimMaxMessageSize:Ia,shimParameterlessSetLocalDescription:La,shimRTCIceCandidate:Oa,shimRTCIceCandidateRelayProtocol:_a,shimSendThrowTypeError:Na});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Fo,i=function(e){const t={browser:null,version:null};if("undefined"===typeof e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.userAgentData&&n.userAgentData.brands){const e=n.userAgentData.brands.find(e=>"Chromium"===e.brand);if(e)return{browser:"chrome",version:parseInt(e.version,10)}}if(n.mozGetUserMedia)t.browser="firefox",t.version=parseInt(Ao(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=parseInt(Ao(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=parseInt(Ao(n.userAgent,/AppleWebKit\/(\d+)\./,1)),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,t._safariVersion=Ao(n.userAgent,/Version\/(\d+(\.?\d+))/,1)}return t}(e),r={browserDetails:i,commonShim:Ua,extractVersion:Ao,disableLog:Uo,disableWarnings:jo,sdp:xa};switch(i.browser){case"chrome":if(!ta||!Zo||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(null===i.version)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=ta,Aa(e,i),La(e),Go(e,i),Ko(e),Zo(e,i),Jo(e),Xo(e,i),Qo(e),$o(e),ea(e,i),Oa(e),_a(e),Da(e),Ia(e,i),Na(e),Ma(e,i);break;case"firefox":if(!pa||!ra||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=pa,Aa(e,i),La(e),na(e,i),ra(e,i),ia(e),sa(e),oa(e),aa(e),ca(e),la(e),ua(e),da(e),ha(e),Oa(e),Da(e),Ia(e,i),Na(e);break;case"safari":if(!Ca||!t.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=Ca,Aa(e,i),La(e),ba(e),Sa(e),ga(e),fa(e),ma(e),ka(e),va(e),Ta(e),Oa(e),_a(e),Ia(e,i),Na(e),Ma(e,i);break;default:n("Unsupported browser!")}}({window:"undefined"===typeof window?void 0:window});const ja="lk_e2ee";var Fa,Ba,za,Va;function qa(){return"undefined"!==typeof window.RTCRtpSender&&"undefined"!==typeof window.RTCRtpSender.prototype.createEncodedStreams||Ha()}function Ha(){return"undefined"!==typeof window.RTCRtpScriptTransform}!function(e){e.SetKey="setKey",e.RatchetRequest="ratchetRequest",e.KeyRatcheted="keyRatcheted"}(Fa||(Fa={})),function(e){e.KeyRatcheted="keyRatcheted"}(Ba||(Ba={})),function(e){e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError"}(za||(za={})),function(e){e.Error="cryptorError"}(Va||(Va={}));No.EventEmitter;class Wa extends Error{constructor(e,t){super(t||"an error has occured"),this.name="LiveKitError",this.code=e}}var Ga,Ka,Ja,Qa,$a,Ya,Xa,Za;!function(e){e[e.NotAllowed=0]="NotAllowed",e[e.ServerUnreachable=1]="ServerUnreachable",e[e.InternalError=2]="InternalError",e[e.Cancelled=3]="Cancelled",e[e.LeaveRequest=4]="LeaveRequest",e[e.Timeout=5]="Timeout"}(Ga||(Ga={}));class es extends Wa{constructor(e,t,n,i){super(1,e),this.name="ConnectionError",this.status=n,this.reason=t,this.context=i,this.reasonName=Ga[t]}}class ts extends Wa{constructor(e){super(21,null!==e&&void 0!==e?e:"device is unsupported"),this.name="DeviceUnsupportedError"}}class ns extends Wa{constructor(e){super(20,null!==e&&void 0!==e?e:"track is invalid"),this.name="TrackInvalidError"}}class is extends Wa{constructor(e){super(10,null!==e&&void 0!==e?e:"unsupported server"),this.name="UnsupportedServer"}}class rs extends Wa{constructor(e){super(12,null!==e&&void 0!==e?e:"unexpected connection state"),this.name="UnexpectedConnectionState"}}class os extends Wa{constructor(e){super(13,null!==e&&void 0!==e?e:"unable to negotiate"),this.name="NegotiationError"}}class as extends Wa{constructor(e,t){super(15,e),this.name="PublishTrackError",this.status=t}}class ss extends Wa{constructor(e,t){super(15,e),this.reason=t,this.reasonName="string"===typeof t?t:ao[t]}}!function(e){e[e.AlreadyOpened=0]="AlreadyOpened",e[e.AbnormalEnd=1]="AbnormalEnd",e[e.DecodeFailed=2]="DecodeFailed",e[e.LengthExceeded=3]="LengthExceeded",e[e.Incomplete=4]="Incomplete",e[e.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",e[e.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"}(Ka||(Ka={}));class cs extends Wa{constructor(e,t){super(16,e),this.name="DataStreamError",this.reason=t,this.reasonName=Ka[t]}}!function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(Ja||(Ja={})),function(e){e.getFailure=function(t){if(t&&"name"in t)return"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?e.NotFound:"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?e.PermissionDenied:"NotReadableError"===t.name||"TrackStartError"===t.name?e.DeviceInUse:e.Other}}(Ja||(Ja={})),function(e){e[e.InvalidKey=0]="InvalidKey",e[e.MissingKey=1]="MissingKey",e[e.InternalError=2]="InternalError"}(Qa||(Qa={}));!function(e){e.Connected="connected",e.Reconnecting="reconnecting",e.SignalReconnecting="signalReconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.ConnectionStateChanged="connectionStateChanged",e.Moved="moved",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalAudioSilenceDetected="localAudioSilenceDetected",e.ActiveSpeakersChanged="activeSpeakersChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.ParticipantAttributesChanged="participantAttributesChanged",e.ParticipantActive="participantActive",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.SipDTMFReceived="sipDTMFReceived",e.TranscriptionReceived="transcriptionReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.VideoPlaybackStatusChanged="videoPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.SignalConnected="signalConnected",e.RecordingStatusChanged="recordingStatusChanged",e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ActiveDeviceChanged="activeDeviceChanged",e.ChatMessage="chatMessage",e.LocalTrackSubscribed="localTrackSubscribed",e.MetricsReceived="metricsReceived"}($a||($a={})),function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalTrackCpuConstrained="localTrackCpuConstrained",e.LocalSenderCreated="localSenderCreated",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.DataReceived="dataReceived",e.SipDTMFReceived="sipDTMFReceived",e.TranscriptionReceived="transcriptionReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.TrackCpuConstrained="trackCpuConstrained",e.MediaDevicesError="mediaDevicesError",e.AudioStreamAcquired="audioStreamAcquired",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.PCTrackAdded="pcTrackAdded",e.AttributesChanged="attributesChanged",e.LocalTrackSubscribed="localTrackSubscribed",e.ChatMessage="chatMessage",e.Active="active"}(Ya||(Ya={})),function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.SignalRestarted="signalRestarted",e.Closing="closing",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived",e.RTPVideoMapUpdate="rtpVideoMapUpdate",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ParticipantUpdate="participantUpdate",e.RoomUpdate="roomUpdate",e.SpeakersChanged="speakersChanged",e.StreamStateChanged="streamStateChanged",e.ConnectionQualityUpdate="connectionQualityUpdate",e.SubscriptionError="subscriptionError",e.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",e.RemoteMute="remoteMute",e.SubscribedQualityUpdate="subscribedQualityUpdate",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalTrackSubscribed="localTrackSubscribed",e.Offline="offline",e.SignalRequestResponse="signalRequestResponse",e.SignalConnected="signalConnected",e.RoomMoved="roomMoved"}(Xa||(Xa={})),function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Restarted="restarted",e.Ended="ended",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed",e.CpuConstrained="cpuConstrained",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.AudioSilenceDetected="audioSilenceDetected",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged",e.VideoPlaybackStarted="videoPlaybackStarted",e.VideoPlaybackFailed="videoPlaybackFailed",e.ElementAttached="elementAttached",e.ElementDetached="elementDetached",e.UpstreamPaused="upstreamPaused",e.UpstreamResumed="upstreamResumed",e.SubscriptionPermissionChanged="subscriptionPermissionChanged",e.SubscriptionStatusChanged="subscriptionStatusChanged",e.SubscriptionFailed="subscriptionFailed",e.TrackProcessorUpdate="trackProcessorUpdate",e.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",e.TranscriptionReceived="transcriptionReceived",e.TimeSyncUpdate="timeSyncUpdate",e.PreConnectBufferFlushed="preConnectBufferFlushed"}(Za||(Za={}));const ls=/version\/(\d+(\.?_?\d+)+)/i;let us;function ds(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("undefined"===typeof e&&"undefined"===typeof navigator)return;const n=(null!==e&&void 0!==e?e:navigator.userAgent).toLowerCase();if(void 0===us||t){const e=hs.find(e=>{let{test:t}=e;return t.test(n)});us=null===e||void 0===e?void 0:e.describe(n)}return us}const hs=[{test:/firefox|iceweasel|fxios/i,describe:e=>({name:"Firefox",version:ps(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:fs(e)})},{test:/chrom|crios|crmo/i,describe:e=>({name:"Chrome",version:ps(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("crios")?"iOS":void 0,osVersion:fs(e)})},{test:/safari|applewebkit/i,describe:e=>({name:"Safari",version:ps(ls,e),os:e.includes("mobile/")?"iOS":"macOS",osVersion:fs(e)})}];function ps(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=t.match(e);return i&&i.length>=n&&i[n]||""}function fs(e){return e.includes("mac os")?ps(/\(.+?(\d+_\d+(:?_\d+)?)/,e,1).replace(/_/g,"."):void 0}class ms{}ms.setTimeout=function(){return setTimeout(...arguments)},ms.setInterval=function(){return setInterval(...arguments)},ms.clearTimeout=function(){return clearTimeout(...arguments)},ms.clearInterval=function(){return clearInterval(...arguments)};const gs=[];var vs;!function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH"}(vs||(vs={}));class ys extends No.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=ys.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=So,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),"hidden"===document.visibilityState?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),5e3):this.handleAppVisibilityChanged()},this.log=To(null!==(i=n.loggerName)&&void 0!==i?i:bo.Track),this.loggerContextCb=n.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=ys.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),xc(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===ys.Kind.Video&&(t="video"),0===this.attachedElements.length&&this.kind===ys.Kind.Video&&this.addAppVisibilityListener(),e||("audio"===t&&(gs.forEach(t=>{null!==t.parentElement||e||(e=t)}),e&&gs.splice(gs.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),bs(this.mediaStreamTrack,e);const n=e.srcObject.getTracks(),i=n.some(e=>"audio"===e.kind);return e.play().then(()=>{this.emit(i?Za.AudioPlaybackStarted:Za.VideoPlaybackStarted)}).catch(t=>{"NotAllowedError"===t.name?this.emit(i?Za.AudioPlaybackFailed:Za.VideoPlaybackFailed,t):"AbortError"===t.name?So.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):So.warn("could not playback ".concat(i?"audio":"video"),t),i&&e&&n.some(e=>"video"===e.kind)&&"NotAllowedError"===t.name&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(Za.ElementAttached,e),e}detach(e){try{if(e){ks(this.mediaStreamTrack,e);const t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e),this.emit(Za.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(e=>{ks(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e),this.emit(Za.ElementDetached,e)}),this.attachedElements=[],t}finally{0===this.attachedElements.length&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=To(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),gs.forEach(e=>{e.parentElement||(t=!1)}),t&&gs.push(e)}}handleAppVisibilityChanged(){return Ro(this,void 0,void 0,function*(){this.isInBackground="hidden"===document.visibilityState,this.isInBackground||this.kind!==ys.Kind.Video||setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){Vs()?(this.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Vs()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function bs(e,t){let n,i;n=t.srcObject instanceof MediaStream?t.srcObject:new MediaStream,i="audio"===e.kind?n.getAudioTracks():n.getVideoTracks(),i.includes(e)||(i.forEach(e=>{n.removeTrack(e)}),n.addTrack(e)),js()&&t instanceof HTMLVideoElement||(t.autoplay=!0),t.muted=0===n.getAudioTracks().length,t instanceof HTMLVideoElement&&(t.playsInline=!0),t.srcObject!==n&&(t.srcObject=n,(js()||Ls())&&t instanceof HTMLVideoElement&&setTimeout(()=>{t.srcObject=n,t.play().catch(()=>{})},0))}function ks(e,t){if(t.srcObject instanceof MediaStream){const n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}!function(e){let t,n,i;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(n=e.Source||(e.Source={})),function(e){e.Active="active",e.Paused="paused",e.Unknown="unknown"}(i=e.StreamState||(e.StreamState={})),e.kindToProto=function(e){switch(e){case t.Audio:return fi.AUDIO;case t.Video:return fi.VIDEO;default:return fi.DATA}},e.kindFromProto=function(e){switch(e){case fi.AUDIO:return t.Audio;case fi.VIDEO:return t.Video;default:return t.Unknown}},e.sourceToProto=function(e){switch(e){case n.Camera:return mi.CAMERA;case n.Microphone:return mi.MICROPHONE;case n.ScreenShare:return mi.SCREEN_SHARE;case n.ScreenShareAudio:return mi.SCREEN_SHARE_AUDIO;default:return mi.UNKNOWN}},e.sourceFromProto=function(e){switch(e){case mi.CAMERA:return n.Camera;case mi.MICROPHONE:return n.Microphone;case mi.SCREEN_SHARE:return n.ScreenShare;case mi.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}},e.streamStateFromProto=function(e){switch(e){case pr.ACTIVE:return i.Active;case pr.PAUSED:return i.Paused;default:return i.Unknown}}}(ys||(ys={}));class Ss{constructor(e,t,n,i,r){if("object"===typeof e)this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else{if(void 0===t||void 0===n)throw new TypeError("Unsupported options: provide at least width, height and maxBitrate");this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:n,maxFramerate:i,priority:r}}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const Ts=["vp8","h264"],ws=["vp8","h264","vp9","av1","h265"];const Cs=function(e){return!!Ts.find(t=>t===e)};var Es,Ps;!function(e){e[e.PREFER_REGRESSION=0]="PREFER_REGRESSION",e[e.SIMULCAST=1]="SIMULCAST",e[e.REGRESSION=2]="REGRESSION"}(Es||(Es={})),function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:24e3},e.music={maxBitrate:48e3},e.musicStereo={maxBitrate:64e3},e.musicHighQuality={maxBitrate:96e3},e.musicHighQualityStereo={maxBitrate:128e3}}(Ps||(Ps={}));const Rs={h90:new Ss(160,90,9e4,20),h180:new Ss(320,180,16e4,20),h216:new Ss(384,216,18e4,20),h360:new Ss(640,360,45e4,20),h540:new Ss(960,540,8e5,25),h720:new Ss(1280,720,17e5,30),h1080:new Ss(1920,1080,3e6,30),h1440:new Ss(2560,1440,5e6,30),h2160:new Ss(3840,2160,8e6,30)},xs={h120:new Ss(160,120,7e4,20),h180:new Ss(240,180,125e3,20),h240:new Ss(320,240,14e4,20),h360:new Ss(480,360,33e4,20),h480:new Ss(640,480,5e5,20),h540:new Ss(720,540,6e5,25),h720:new Ss(960,720,13e5,30),h1080:new Ss(1440,1080,23e5,30),h1440:new Ss(1920,1440,38e5,30)},Os={h360fps3:new Ss(640,360,2e5,3,"medium"),h360fps15:new Ss(640,360,4e5,15,"medium"),h720fps5:new Ss(1280,720,8e5,5,"medium"),h720fps15:new Ss(1280,720,15e5,15,"medium"),h720fps30:new Ss(1280,720,2e6,30,"medium"),h1080fps15:new Ss(1920,1080,25e5,15,"medium"),h1080fps30:new Ss(1920,1080,5e6,30,"medium"),original:new Ss(0,0,7e6,30,"medium")},_s="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function Is(e){return Ro(this,void 0,void 0,function*(){return new Promise(t=>ms.setTimeout(t,e))})}function Ns(){return"addTransceiver"in RTCPeerConnection.prototype}function Ds(){return"addTrack"in RTCPeerConnection.prototype}function Ms(e){return"av1"===e||"vp9"===e}function As(e){return!(!document||Fs())&&(e||(e=document.createElement("audio")),"setSinkId"in e)}function Ls(){var e;return"Firefox"===(null===(e=ds())||void 0===e?void 0:e.name)}function Us(){const e=ds();return!!e&&"Chrome"===e.name&&"iOS"!==e.os}function js(){var e;return"Safari"===(null===(e=ds())||void 0===e?void 0:e.name)}function Fs(){const e=ds();return"Safari"===(null===e||void 0===e?void 0:e.name)||"iOS"===(null===e||void 0===e?void 0:e.os)}function Bs(){const e=ds();return"Safari"===(null===e||void 0===e?void 0:e.name)&&e.version.startsWith("17.")||"iOS"===(null===e||void 0===e?void 0:e.os)&&!!(null===e||void 0===e?void 0:e.osVersion)&&Js(e.osVersion,"17")>=0}function zs(){var e,t;return!!Vs()&&(null!==(t=null===(e=navigator.userAgentData)||void 0===e?void 0:e.mobile)&&void 0!==t?t:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent))}function Vs(){return"undefined"!==typeof document}function qs(){return"ReactNative"==navigator.product}function Hs(e){return e.hostname.endsWith(".livekit.cloud")||e.hostname.endsWith(".livekit.run")}function Ws(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function Gs(){if(!qs())return;let e=Ws();return e?e.platform:void 0}function Ks(){if(Vs())return window.devicePixelRatio;if(qs()){let e=Ws();if(e)return e.devicePixelRatio}return 1}function Js(e,t){const n=e.split("."),i=t.split("."),r=Math.min(n.length,i.length);for(let o=0;o<r;++o){const e=parseInt(n[o],10),t=parseInt(i[o],10);if(e>t)return 1;if(e<t)return-1;if(o===r-1&&e===t)return 0}return""===e&&""!==t?-1:""===t?1:n.length==i.length?0:n.length<i.length?-1:1}function Qs(e){for(const t of e)t.target.handleResize(t)}function $s(e){for(const t of e)t.target.handleVisibilityChanged(t)}let Ys=null;const Xs=()=>(Ys||(Ys=new ResizeObserver(Qs)),Ys);let Zs=null;const ec=()=>(Zs||(Zs=new IntersectionObserver($s,{root:null,rootMargin:"0px"})),Zs);let tc;function nc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=document.createElement("canvas");r.width=e,r.height=t;const o=r.getContext("2d");null===o||void 0===o||o.fillRect(0,0,r.width,r.height),i&&o&&(o.beginPath(),o.arc(e/2,t/2,50,0,2*Math.PI,!0),o.closePath(),o.fillStyle="grey",o.fill());const a=r.captureStream(),[s]=a.getTracks();if(!s)throw Error("Could not get empty media stream video track");return s.enabled=n,s}function ic(){if(!tc){const e=new AudioContext,t=e.createOscillator(),n=e.createGain();n.gain.setValueAtTime(0,0);const i=e.createMediaStreamDestination();if(t.connect(n),n.connect(i),t.start(),[tc]=i.stream.getAudioTracks(),!tc)throw Error("Could not get empty media stream audio track");tc.enabled=!1}return tc.clone()}class rc{get isResolved(){return this._isResolved}constructor(e,t){this._isResolved=!1,this.onFinally=t,this.promise=new Promise((t,n)=>Ro(this,void 0,void 0,function*(){this.resolve=t,this.reject=n,e&&(yield e(t,n))})).finally(()=>{var e;this._isResolved=!0,null===(e=this.onFinally)||void 0===e||e.call(this)})}}function oc(e){if("string"===typeof e||"number"===typeof e)return e;if(Array.isArray(e))return e[0];if(void 0!==e.exact)return Array.isArray(e.exact)?e.exact[0]:e.exact;if(void 0!==e.ideal)return Array.isArray(e.ideal)?e.ideal[0]:e.ideal;throw Error("could not unwrap constraint")}function ac(e){return e.startsWith("ws")?e.replace(/^(ws)/,"http"):e}function sc(e){switch(e.reason){case Ga.LeaveRequest:return e.context;case Ga.Cancelled:return bi.CLIENT_INITIATED;case Ga.NotAllowed:return bi.USER_REJECTED;case Ga.ServerUnreachable:return bi.JOIN_FAILURE;default:return bi.UNKNOWN_REASON}}function cc(e){return void 0!==e?Number(e):void 0}function lc(e){return void 0!==e?BigInt(e):void 0}function uc(e){return!!e&&!(e instanceof MediaStreamTrack)&&e.isLocal}function dc(e){return!!e&&e.kind==ys.Kind.Audio}function hc(e){return!!e&&e.kind==ys.Kind.Video}function pc(e){return uc(e)&&hc(e)}function fc(e){return uc(e)&&dc(e)}function mc(e){return!!e&&!e.isLocal}function gc(e){return!!e&&!e.isLocal}function vc(e){return mc(e)&&hc(e)}function yc(e,t,n){var i,r,o,a;const{optionsWithoutProcessor:s,audioProcessor:c,videoProcessor:l}=Oc(null!==e&&void 0!==e?e:{}),u=null===t||void 0===t?void 0:t.processor,d=null===n||void 0===n?void 0:n.processor,h=null!==s&&void 0!==s?s:{};return!0===h.audio&&(h.audio={}),!0===h.video&&(h.video={}),h.audio&&(bc(h.audio,t),null!==(i=(o=h.audio).deviceId)&&void 0!==i||(o.deviceId={ideal:"default"}),(c||u)&&(h.audio.processor=null!==c&&void 0!==c?c:u)),h.video&&(bc(h.video,n),null!==(r=(a=h.video).deviceId)&&void 0!==r||(a.deviceId={ideal:"default"}),(l||d)&&(h.video.processor=null!==l&&void 0!==l?l:d)),h}function bc(e,t){return Object.keys(t).forEach(n=>{void 0===e[n]&&(e[n]=t[n])}),e}function kc(e){var t,n,i,r;const o={};if(e.video)if("object"===typeof e.video){const n={},r=n,a=e.video;Object.keys(a).forEach(e=>{if("resolution"===e)bc(r,a.resolution);else r[e]=a[e]}),o.video=n,null!==(t=(i=o.video).deviceId)&&void 0!==t||(i.deviceId={ideal:"default"})}else o.video=!!e.video&&{deviceId:{ideal:"default"}};else o.video=!1;return e.audio?"object"===typeof e.audio?(o.audio=e.audio,null!==(n=(r=o.audio).deviceId)&&void 0!==n||(r.deviceId={ideal:"default"})):o.audio={deviceId:{ideal:"default"}}:o.audio=!1,o}function Sc(e){return Ro(this,arguments,void 0,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return function*(){const n=Tc();if(n){const i=n.createAnalyser();i.fftSize=2048;const r=i.frequencyBinCount,o=new Uint8Array(r);n.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield Is(t),i.getByteTimeDomainData(o);const a=o.some(e=>128!==e&&0!==e);return n.close(),!a}return!1}()})}function Tc(){var e;const t="undefined"!==typeof window&&(window.AudioContext||window.webkitAudioContext);if(t){const n=new t({latencyHint:"interactive"});if("suspended"===n.state&&"undefined"!==typeof window&&(null===(e=window.document)||void 0===e?void 0:e.body)){const e=()=>Ro(this,void 0,void 0,function*(){var t;try{"suspended"===n.state&&(yield n.resume())}catch(dp){console.warn("Error trying to auto-resume audio context",dp)}finally{null===(t=window.document.body)||void 0===t||t.removeEventListener("click",e)}});n.addEventListener("statechange",()=>{var t;"closed"===n.state&&(null===(t=window.document.body)||void 0===t||t.removeEventListener("click",e))}),window.document.body.addEventListener("click",e)}return n}}function wc(e){return"audioinput"===e?ys.Source.Microphone:"videoinput"===e?ys.Source.Camera:ys.Source.Unknown}function Cc(e){return e===ys.Source.Microphone?"audioinput":e===ys.Source.Camera?"videoinput":void 0}function Ec(e){var t,n;let i=null===(t=e.video)||void 0===t||t;return e.resolution&&e.resolution.width>0&&e.resolution.height>0&&(i="boolean"===typeof i?{}:i,i=js()?Object.assign(Object.assign({},i),{width:{max:e.resolution.width},height:{max:e.resolution.height},frameRate:e.resolution.frameRate}):Object.assign(Object.assign({},i),{width:{ideal:e.resolution.width},height:{ideal:e.resolution.height},frameRate:e.resolution.frameRate})),{audio:null!==(n=e.audio)&&void 0!==n&&n,video:i,controller:e.controller,selfBrowserSurface:e.selfBrowserSurface,surfaceSwitching:e.surfaceSwitching,systemAudio:e.systemAudio,preferCurrentTab:e.preferCurrentTab}}function Pc(e){return e.split("/")[1].toLowerCase()}function Rc(e){const t=[];return e.forEach(e=>{void 0!==e.track&&t.push(new wr({cid:e.track.mediaStreamID,track:e.trackInfo}))}),t}function xc(e){return"mediaStreamTrack"in e?{trackID:e.sid,source:e.source,muted:e.isMuted,enabled:e.mediaStreamTrack.enabled,kind:e.kind,streamID:e.mediaStreamID,streamTrackID:e.mediaStreamTrack.id}:{trackID:e.trackSid,enabled:e.isEnabled,muted:e.isMuted,trackInfo:Object.assign({mimeType:e.mimeType,name:e.trackName,encrypted:e.isEncrypted,kind:e.kind,source:e.source},e.track?xc(e.track):{})}}function Oc(e){const t=Object.assign({},e);let n,i;return"object"===typeof t.audio&&t.audio.processor&&(n=t.audio.processor,t.audio=Object.assign(Object.assign({},t.audio),{processor:void 0})),"object"===typeof t.video&&t.video.processor&&(i=t.video.processor,t.video=Object.assign(Object.assign({},t.video),{processor:void 0})),{audioProcessor:n,videoProcessor:i,optionsWithoutProcessor:(r=t,"undefined"===typeof r?r:"function"===typeof structuredClone?"object"===typeof r&&null!==r?structuredClone(Object.assign({},r)):structuredClone(r):JSON.parse(JSON.stringify(r)))};var r}function _c(e,t){return e.width*e.height<t.width*t.height}class Ic extends No.EventEmitter{constructor(e,t){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=e=>{var t,n;const{kind:i,data:r}=e.data;switch(i){case"error":So.error(r.error.message),this.emit(za.EncryptionError,r.error);break;case"initAck":r.enabled&&this.keyProvider.getKeys().forEach(e=>{this.postKey(e)});break;case"enable":if(r.enabled&&this.keyProvider.getKeys().forEach(e=>{this.postKey(e)}),this.encryptionEnabled!==r.enabled&&r.participantIdentity===(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))this.emit(za.ParticipantEncryptionStatusChanged,r.enabled,this.room.localParticipant),this.encryptionEnabled=r.enabled;else if(r.participantIdentity){const e=null===(n=this.room)||void 0===n?void 0:n.getParticipantByIdentity(r.participantIdentity);if(!e)throw TypeError("couldn't set encryption status, participant not found".concat(r.participantIdentity));this.emit(za.ParticipantEncryptionStatusChanged,r.enabled,e)}break;case"ratchetKey":this.keyProvider.emit(Fa.KeyRatcheted,r.ratchetResult,r.participantIdentity,r.keyIndex);break;case"decryptDataResponse":const e=this.decryptDataRequests.get(r.uuid);(null===e||void 0===e?void 0:e.resolve)&&e.resolve(r);break;case"encryptDataResponse":const i=this.encryptDataRequests.get(r.uuid);(null===i||void 0===i?void 0:i.resolve)&&i.resolve(r)}},this.onWorkerError=e=>{So.error("e2ee worker encountered an error:",{error:e.error}),this.emit(za.EncryptionError,e.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=t}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!qa())throw new ts("tried to setup end-to-end encryption on an unsupported browser");if(So.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:wo.getLevel()}};this.worker&&(So.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){So.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){e&&0!==e.length?this.postSifTrailer(e):So.warn("ignoring server sent trailer as it's empty")}setupEngine(e){e.on(Xa.RTPVideoMapUpdate,e=>{this.postRTPMap(e)})}setupEventListeners(e,t){e.on($a.TrackPublished,(e,t)=>this.setParticipantCryptorEnabled(e.trackInfo.encryption!==_i.NONE,t.identity)),e.on($a.ConnectionStateChanged,t=>{t===vu.Connected&&e.remoteParticipants.forEach(e=>{e.trackPublications.forEach(t=>{this.setParticipantCryptorEnabled(t.trackInfo.encryption!==_i.NONE,e.identity)})})}).on($a.TrackUnsubscribed,(e,t,n)=>{var i;const r={kind:"removeTransform",data:{participantIdentity:n.identity,trackId:e.mediaStreamID}};null===(i=this.worker)||void 0===i||i.postMessage(r)}).on($a.TrackSubscribed,(e,t,n)=>{this.setupE2EEReceiver(e,n.identity,t.trackInfo)}).on($a.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");t.getKeys().forEach(e=>{this.postKey(e)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(Ya.LocalSenderCreated,(e,t)=>Ro(this,void 0,void 0,function*(){this.setupE2EESender(t,e)})),e.localParticipant.on(Ya.LocalTrackPublished,e=>{if(!hc(e.track)||!Fs())return;const t={kind:"updateCodec",data:{trackId:e.track.mediaStreamID,codec:Pc(e.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(t)}),t.on(Fa.SetKey,e=>this.postKey(e)).on(Fa.RatchetRequest,(e,t)=>this.postRatchetRequest(e,t))}encryptData(e){return Ro(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const t=crypto.randomUUID(),n={kind:"encryptDataRequest",data:{uuid:t,payload:e,participantIdentity:this.room.localParticipant.identity}},i=new rc;return i.onFinally=()=>{this.encryptDataRequests.delete(t)},this.encryptDataRequests.set(t,i),this.worker.postMessage(n),i.promise})}handleEncryptedData(e,t,n,i){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const r=crypto.randomUUID(),o={kind:"decryptDataRequest",data:{uuid:r,payload:e,iv:t,participantIdentity:n,keyIndex:i}},a=new rc;return a.onFinally=()=>{this.decryptDataRequests.delete(r)},this.decryptDataRequests.set(r,a),this.worker.postMessage(o),a.promise}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const n={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(n)}postKey(e){let{key:t,participantIdentity:n,keyIndex:i}=e;var r;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:n,isPublisher:n===(null===(r=this.room)||void 0===r?void 0:r.localParticipant.identity),key:t,keyIndex:i}};this.worker.postMessage(o)}postEnable(e,t){if(!this.worker)throw new ReferenceError("failed to enable e2ee, worker is not ready");{const n={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(n)}}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const n={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(n)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,n){if(e.receiver){if(!(null===n||void 0===n?void 0:n.mimeType)||""===n.mimeType)throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,"video"===e.kind?Pc(n.mimeType):void 0)}}setupE2EESender(e,t){uc(e)&&t?this.handleSender(t,e.mediaStreamID,void 0):t||So.warn("early return because sender is not ready")}handleReceiver(e,t,n,i){return Ro(this,void 0,void 0,function*(){if(this.worker){if(Ha()&&!Us()){const r={kind:"decode",participantIdentity:n,trackId:t,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,r)}else{if(ja in e&&i){const e={kind:"updateCodec",data:{trackId:t,codec:i,participantIdentity:n}};return void this.worker.postMessage(e)}let r=e.writableStream,o=e.readableStream;if(!r||!o){const t=e.createEncodedStreams();e.writableStream=t.writable,r=t.writable,e.readableStream=t.readable,o=t.readable}const a={kind:"decode",data:{readableStream:o,writableStream:r,trackId:t,codec:i,participantIdentity:n,isReuse:ja in e}};this.worker.postMessage(a,[o,r])}e[ja]=!0}})}handleSender(e,t,n){var i;if(!(ja in e)&&this.worker){if(!(null===(i=this.room)||void 0===i?void 0:i.localParticipant.identity)||""===this.room.localParticipant.identity)throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Ha()&&!Us()){So.info("initialize script transform");const i={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:n};e.transform=new RTCRtpScriptTransform(this.worker,i)}else{So.info("initialize encoded streams");const i=e.createEncodedStreams(),r={kind:"encode",data:{readableStream:i.readable,writableStream:i.writable,codec:n,trackId:t,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(r,[i.readable,i.writable])}e[ja]=!0}}}const Nc="default";class Dc{constructor(){this._previousDevices=[]}static getInstance(){return void 0===this.instance&&(this.instance=new Dc),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return Ro(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var i;if((null===(i=Dc.userMediaPromiseMap)||void 0===i?void 0:i.size)>0){So.debug("awaiting getUserMedia promise");try{e?yield Dc.userMediaPromiseMap.get(e):yield Promise.all(Dc.userMediaPromiseMap.values())}catch(dp){So.warn("error waiting for media permissons")}}let r=yield navigator.mediaDevices.enumerateDevices();if(n&&(!js()||!t.hasDeviceInUse(e))){if(0===r.filter(t=>t.kind===e).length||r.some(t=>{const n=""===t.label,i=!e||t.kind===e;return n&&i})){const t={video:"audioinput"!==e&&"audiooutput"!==e,audio:"videoinput"!==e&&{deviceId:{ideal:"default"}}},n=yield navigator.mediaDevices.getUserMedia(t);r=yield navigator.mediaDevices.enumerateDevices(),n.getTracks().forEach(e=>{e.stop()})}}return t._previousDevices=r,e&&(r=r.filter(t=>t.kind===e)),r}()})}normalizeDeviceId(e,t,n){return Ro(this,void 0,void 0,function*(){if(t!==Nc)return t;const i=yield this.getDevices(e),r=i.find(e=>e.deviceId===Nc);if(!r)return void So.warn("could not reliably determine default device");const o=i.find(e=>e.deviceId!==Nc&&e.groupId===(null!==n&&void 0!==n?n:r.groupId));if(o)return null===o||void 0===o?void 0:o.deviceId;So.warn("could not reliably determine default device")})}hasDeviceInUse(e){return e?Dc.userMediaPromiseMap.has(e):Dc.userMediaPromiseMap.size>0}}var Mc;Dc.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],Dc.userMediaPromiseMap=new Map,function(e){e[e.WAITING=0]="WAITING",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED"}(Mc||(Mc={}));class Ac{constructor(){this.pendingTasks=new Map,this.taskMutex=new xt,this.nextTaskIndex=0}run(e){return Ro(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Mc.WAITING};this.pendingTasks.set(t.id,t);const n=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=Mc.RUNNING,yield e()}finally{t.status=Mc.COMPLETED,this.pendingTasks.delete(t.id),n()}})}flush(){return Ro(this,void 0,void 0,function*(){return this.run(()=>Ro(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class Lc{get readyState(){return this.ws.readyState}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,i;if(null===(n=t.signal)||void 0===n?void 0:n.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=e;const r=new WebSocket(e,null!==(i=t.protocols)&&void 0!==i?i:[]);r.binaryType="arraybuffer",this.ws=r;const o=function(){let{closeCode:e,reason:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.close(e,t)};this.opened=new Promise((e,t)=>{r.onopen=()=>{e({readable:new ReadableStream({start(e){r.onmessage=t=>{let{data:n}=t;return e.enqueue(n)},r.onerror=t=>e.error(t)},cancel:o}),writable:new WritableStream({write(e){r.send(e)},abort(){r.close()},close:o}),protocol:r.protocol,extensions:r.extensions}),r.removeEventListener("error",t)},r.addEventListener("error",t)}),this.closed=new Promise((e,t)=>{const n=()=>Ro(this,void 0,void 0,function*(){const n=new Promise(e=>{r.readyState!==WebSocket.CLOSED&&r.addEventListener("close",t=>{e(t)},{once:!0})}),i=yield Promise.race([Is(250),n]);i?e(i):t(new Error("Encountered unspecified websocket error without a timely close event"))});r.onclose=t=>{let{code:i,reason:o}=t;e({closeCode:i,reason:o}),r.removeEventListener("error",n)},r.addEventListener("error",n)}),t.signal&&(t.signal.onabort=()=>r.close()),this.close=o}}function Uc(e,t){return e.pathname="".concat(function(e){return e.endsWith("/")?e:"".concat(e,"/")}(e.pathname)).concat(t),e.toString()}function jc(e){if("string"===typeof e)return gr.fromJson(JSON.parse(e),{ignoreUnknownFields:!0});if(e instanceof ArrayBuffer)return gr.fromBinary(new Uint8Array(e));throw new Error("could not decode websocket message: ".concat(typeof e))}const Fc=["syncState","trickle","offer","answer","simulate","leave"];var Bc;!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.RECONNECTING=2]="RECONNECTING",e[e.DISCONNECTING=3]="DISCONNECTING",e[e.DISCONNECTED=4]="DISCONNECTED"}(Bc||(Bc={}));class zc{get currentState(){return this.state}get isDisconnected(){return this.state===Bc.DISCONNECTING||this.state===Bc.DISCONNECTED}get isEstablishingConnection(){return this.state===Bc.CONNECTING||this.state===Bc.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;this.rtt=0,this.state=Bc.DISCONNECTED,this.log=So,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=To(null!==(n=t.loggerName)&&void 0!==n?n:bo.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new Ac,this.queuedRequests=[],this.closingLock=new xt,this.connectionLock=new xt,this.state=Bc.DISCONNECTED}get logContext(){var e,t;return null!==(t=null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this))&&void 0!==t?t:{}}join(e,t,n,i){return Ro(this,void 0,void 0,function*(){this.state=Bc.CONNECTING,this.options=n;return yield this.connect(e,t,n,i)})}reconnect(e,t,n,i){return Ro(this,void 0,void 0,function*(){if(!this.options)return void this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);this.state=Bc.RECONNECTING,this.clearPingInterval();return yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:n,reconnectReason:i}))})}connect(e,t,n,i){return Ro(this,void 0,void 0,function*(){const r=yield this.connectionLock.lock();this.connectOptions=n;const o=function(){var e;const t=new Zi({sdk:er.JS,protocol:16,version:"2.15.13"});return qs()&&(t.os=null!==(e=Gs())&&void 0!==e?e:""),t}(),a=n.singlePeerConnection?function(e,t,n){const i=new URLSearchParams;i.set("access_token",e);const r=new lo({clientInfo:t,connectionSettings:new co({autoSubscribe:!!n.autoSubscribe,adaptiveStream:!!n.adaptiveStream}),reconnect:!!n.reconnect,participantSid:n.sid?n.sid:void 0});n.reconnectReason&&(r.reconnectReason=n.reconnectReason);const o=new uo({joinRequest:r.toBinary()});return i.set("join_request",btoa(new TextDecoder("utf-8").decode(o.toBinary()))),i}(t,o,n):function(e,t,n){var i;const r=new URLSearchParams;r.set("access_token",e),n.reconnect&&(r.set("reconnect","1"),n.sid&&r.set("sid",n.sid));r.set("auto_subscribe",n.autoSubscribe?"1":"0"),r.set("sdk",qs()?"reactnative":"js"),r.set("version",t.version),r.set("protocol",t.protocol.toString()),t.deviceModel&&r.set("device_model",t.deviceModel);t.os&&r.set("os",t.os);t.osVersion&&r.set("os_version",t.osVersion);t.browser&&r.set("browser",t.browser);t.browserVersion&&r.set("browser_version",t.browserVersion);n.adaptiveStream&&r.set("adaptive_stream","1");n.reconnectReason&&r.set("reconnect_reason",n.reconnectReason.toString());(null===(i=navigator.connection)||void 0===i?void 0:i.type)&&r.set("network",navigator.connection.type);return r}(t,o,n),s=function(e,t){const n=new URL(function(e){return e.startsWith("http")?e.replace(/^(http)/,"ws"):e}(e));return t.forEach((e,t)=>{n.searchParams.set(t,e)}),Uc(n,"rtc")}(e,a),c=Uc(new URL(ac(s)),"validate");return new Promise((e,t)=>Ro(this,void 0,void 0,function*(){var o,a;try{let r=!1;const l=e=>Ro(this,void 0,void 0,function*(){if(r)return;r=!0;const n=e instanceof Event?e.currentTarget:e,i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unknown reason";if(!(e instanceof AbortSignal))return t;const n=e.reason;switch(typeof n){case"string":return n;case"object":return n instanceof Error?n.message:t;default:return"toString"in n?n.toString():t}}(n,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(i)).catch(e=>{this.log.error(e),this.close()}):this.close(),u(),t(n instanceof AbortSignal?n.reason:n)});null===i||void 0===i||i.addEventListener("abort",l);const u=()=>{clearTimeout(d),null===i||void 0===i||i.removeEventListener("abort",l)},d=setTimeout(()=>{l(new es("room connection has timed out (signal)",Ga.ServerUnreachable))},n.websocketTimeout),h=(e,t)=>{this.handleSignalConnected(e,d,t)},p=new URL(s);p.searchParams.has("access_token")&&p.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(p),Object.assign({reconnect:n.reconnect,reconnectReason:n.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new Lc(s);try{this.ws.closed.then(e=>{this.isEstablishingConnection&&t(new es("Websocket got closed during a (re)connection attempt: ".concat(e.reason),Ga.InternalError)),1e3!==e.closeCode&&this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:e.reason,code:e.closeCode,wasClean:1e3===e.closeCode,state:this.state}))}).catch(e=>{this.isEstablishingConnection&&t(new es("Websocket error during a (re)connection attempt: ".concat(e),Ga.InternalError))});const i=yield this.ws.opened.catch(e=>Ro(this,void 0,void 0,function*(){if(this.state!==Bc.CONNECTED){this.state=Bc.DISCONNECTED,clearTimeout(d);const n=yield this.handleConnectionError(e,c);return void t(n)}this.handleWSError(e),t(e)}));if(clearTimeout(d),!i)return;const r=i.readable.getReader();this.streamWriter=i.writable.getWriter();const s=yield r.read();if(r.releaseLock(),!s.value)throw new es("no message received as first message",Ga.InternalError);const l=jc(s.value),u=this.validateFirstMessage(l,null!==(o=n.reconnect)&&void 0!==o&&o);if(!u.isValid)return void t(u.error);"join"===(null===(a=l.message)||void 0===a?void 0:a.case)&&(this.pingTimeoutDuration=l.message.value.pingTimeout,this.pingIntervalDuration=l.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})));h(i,u.shouldProcessFirstMessage?l:void 0),e(u.response)}catch(dp){t(dp)}finally{u()}}finally{r()}}))})}startReadingLoop(e,t){return Ro(this,void 0,void 0,function*(){for(t&&this.handleSignalResponse(t);;){this.signalLatency&&(yield Is(this.signalLatency));const{done:t,value:n}=yield e.read();if(t)break;const i=jc(n);this.handleSignalResponse(i)}})}close(){return Ro(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Close method called on signal client";return function*(){const i=yield e.closingLock.lock();try{if(e.clearPingInterval(),t&&(e.state=Bc.DISCONNECTING),e.ws){e.ws.close({closeCode:1e3,reason:n});const t=e.ws.closed;e.ws=void 0,e.streamWriter=void 0,yield Promise.race([t,Is(250)])}}catch(dp){e.log.debug("websocket error while closing",Object.assign(Object.assign({},e.logContext),{error:dp}))}finally{t&&(e.state=Bc.DISCONNECTED),i()}}()})}sendOffer(e,t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:qc(e,t)})}sendAnswer(e,t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:qc(e,t)})}sendIceCandidate(e,t){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new br({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new kr({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return Ro(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function*(){const r=n.getNextRequestId();return yield n.sendRequest({case:"updateMetadata",value:new Mr({requestId:r,metadata:e,name:t,attributes:i})}),r}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new Dr({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new Kr({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:$t.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new eo({timestamp:$t.parse(Date.now()),rtt:$t.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,t){return this.sendRequest({case:"updateAudioTrack",value:new Or({trackSid:e,features:t})})}sendLeave(){return this.sendRequest({case:"leave",value:new Ir({reason:bi.CLIENT_INITIATED,action:Nr.DISCONNECT})})}sendRequest(e){return Ro(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){const i=!n&&!function(e){const t=Fc.indexOf(e.case)>=0;return So.trace("request allowed to bypass queue:",{canPass:t,req:e}),t}(e);if(i&&t.state===Bc.RECONNECTING)return void t.queuedRequests.push(()=>Ro(t,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));if(n||(yield t.requestQueue.flush()),t.signalLatency&&(yield Is(t.signalLatency)),t.isDisconnected)return void t.log.debug("skipping signal request (type: ".concat(e.case,") - SignalClient disconnected"));if(!t.streamWriter)return void t.log.error("cannot send signal request before connected, type: ".concat(null===e||void 0===e?void 0:e.case),t.logContext);const r=new mr({message:e});try{t.useJSON?yield t.streamWriter.write(r.toJsonString()):yield t.streamWriter.write(r.toBinary())}catch(dp){t.log.error("error sending signal message",Object.assign(Object.assign({},t.logContext),{error:dp}))}}()})}handleSignalResponse(e){var t,n;const i=e.message;if(void 0==i)return void this.log.debug("received unsupported message",this.logContext);let r=!1;if("answer"===i.case){const e=Vc(i.value);this.onAnswer&&this.onAnswer(e,i.value.id,i.value.midToTrackId)}else if("offer"===i.case){const e=Vc(i.value);this.onOffer&&this.onOffer(e,i.value.id,i.value.midToTrackId)}else if("trickle"===i.case){const e=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(e,i.value.target)}else"update"===i.case?this.onParticipantUpdate&&this.onParticipantUpdate(null!==(t=i.value.participants)&&void 0!==t?t:[]):"trackPublished"===i.case?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):"speakersChanged"===i.case?this.onSpeakersChanged&&this.onSpeakersChanged(null!==(n=i.value.speakers)&&void 0!==n?n:[]):"leave"===i.case?this.onLeave&&this.onLeave(i.value):"mute"===i.case?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):"roomUpdate"===i.case?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):"connectionQuality"===i.case?this.onConnectionQuality&&this.onConnectionQuality(i.value):"streamStateUpdate"===i.case?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):"subscribedQualityUpdate"===i.case?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):"subscriptionPermissionUpdate"===i.case?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):"refreshToken"===i.case?this.onTokenRefresh&&this.onTokenRefresh(i.value):"trackUnpublished"===i.case?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):"subscriptionResponse"===i.case?this.onSubscriptionError&&this.onSubscriptionError(i.value):"pong"===i.case||("pongResp"===i.case?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),r=!0):"requestResponse"===i.case?this.onRequestResponse&&this.onRequestResponse(i.value):"trackSubscribed"===i.case?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(i.value.trackSid):"roomMoved"===i.case?(this.onTokenRefresh&&this.onTokenRefresh(i.value.token),this.onRoomMoved&&this.onRoomMoved(i.value)):"mediaSectionsRequirement"===i.case?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(i.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));r||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return Ro(this,void 0,void 0,function*(){if(this.state===Bc.DISCONNECTED)return;const t=this.onClose;yield this.close(void 0,e),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){this.clearPingTimeout(),this.pingTimeoutDuration?this.pingTimeout=ms.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-1e3*this.pingTimeoutDuration).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},1e3*this.pingTimeoutDuration):this.log.warn("ping timeout duration not set",this.logContext)}clearPingTimeout(){this.pingTimeout&&ms.clearTimeout(this.pingTimeout)}startPingInterval(){this.clearPingInterval(),this.resetPingTimeout(),this.pingIntervalDuration?(this.log.debug("start ping interval",this.logContext),this.pingInterval=ms.setInterval(()=>{this.sendPing()},1e3*this.pingIntervalDuration)):this.log.warn("ping interval duration not set",this.logContext)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&ms.clearInterval(this.pingInterval)}handleSignalConnected(e,t,n){this.state=Bc.CONNECTED,clearTimeout(t),this.startPingInterval(),this.startReadingLoop(e.readable.getReader(),n)}validateFirstMessage(e,t){var n,i,r,o,a;return"join"===(null===(n=e.message)||void 0===n?void 0:n.case)?{isValid:!0,response:e.message.value}:this.state===Bc.RECONNECTING&&"leave"!==(null===(i=e.message)||void 0===i?void 0:i.case)?"reconnect"===(null===(r=e.message)||void 0===r?void 0:r.case)?{isValid:!0,response:e.message.value}:(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0}):this.isEstablishingConnection&&"leave"===(null===(o=e.message)||void 0===o?void 0:o.case)?{isValid:!1,error:new es("Received leave request while trying to (re)connect",Ga.LeaveRequest,void 0,e.message.value.reason)}:t?{isValid:!1,error:new es("Unexpected first message",Ga.InternalError)}:{isValid:!1,error:new es("did not receive join response, got ".concat(null===(a=e.message)||void 0===a?void 0:a.case," instead"),Ga.InternalError)}}handleConnectionError(e,t){return Ro(this,void 0,void 0,function*(){try{const n=yield fetch(t);if(n.status.toFixed(0).startsWith("4")){const e=yield n.text();return new es(e,Ga.NotAllowed,n.status)}return e instanceof es?e:new es("Encountered unknown websocket error during connection: ".concat(e),Ga.InternalError,n.status)}catch(dp){return dp instanceof es?dp:new es(dp instanceof Error?dp.message:"server was not reachable",Ga.ServerUnreachable)}})}}function Vc(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function qc(e,t){return new Er({sdp:e.sdp,type:e.type,id:t})}class Hc{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0;){if(!(this.buffer[0].sequence<=e))break;this.pop()}}alignBufferedAmount(e){for(;this.buffer.length>0;){const t=this.buffer[0];if(this._totalSize-t.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class Wc{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,t){const n=Date.now();n-this._lastCleanup>this.ttl/2&&this.cleanup();const i=n+this.ttl;return this._map.set(e,{value:t,expiresAt:i}),this}get(e){const t=this._map.get(e);if(t){if(!(t.expiresAt<Date.now()))return t.value;this._map.delete(e)}}has(e){const t=this._map.get(e);return!!t&&(!(t.expiresAt<Date.now())||(this._map.delete(e),!1))}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[t,n]of this._map.entries())n.expiresAt<e&&this._map.delete(t);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[t,n]of this._map.entries())n.expiresAt>=Date.now()&&e(n.value,t,this.asValueMap())}map(e){this.cleanup();const t=[],n=this.asValueMap();for(const[i,r]of n.entries())t.push(e(r,i,n));return t}asValueMap(){const e=new Map;for(const[t,n]of this._map.entries())n.expiresAt>=Date.now()&&e.set(t,n.value);return e}}var Gc,Kc,Jc,Qc,$c,Yc={},Xc={},Zc={exports:{}};function el(){if(Gc)return Zc.exports;Gc=1;var e=Zc.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(e).forEach(function(t){e[t].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})}),Zc.exports}function tl(){return Kc||(Kc=1,function(e){var t=function(e){return String(Number(e))===e?Number(e):e},n=function(e,n,i){var r=e.name&&e.names;e.push&&!n[e.push]?n[e.push]=[]:r&&!n[e.name]&&(n[e.name]={});var o=e.push?{}:r?n[e.name]:n;!function(e,n,i,r){if(r&&!i)n[r]=t(e[1]);else for(var o=0;o<i.length;o+=1)null!=e[o+1]&&(n[i[o]]=t(e[o+1]))}(i.match(e.reg),o,e.names,e.name),e.push&&n[e.push].push(o)},i=el(),r=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},o=[],a=t;return e.split(/(\r\n|\r|\n)/).filter(r).forEach(function(e){var t=e[0],r=e.slice(2);"m"===t&&(o.push({rtp:[],fmtp:[]}),a=o[o.length-1]);for(var s=0;s<(i[t]||[]).length;s+=1){var c=i[t][s];if(c.reg.test(r))return n(c,a,r)}}),t.media=o,t};var o=function(e,n){var i=n.split(/=(.+)/,2);return 2===i.length?e[i[0]]=t(i[1]):1===i.length&&n.length>1&&(e[i[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var n=[],i=e.split(" ").map(t),r=0;r<i.length;r+=3)n.push({component:i[r],ip:i[r+1],port:i[r+2]});return n},e.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})})},e.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var n,i=!1;return"~"!==e[0]?n=t(e):(n=t(e.substring(1,e.length)),i=!0),{scid:n,paused:i}})})}}(Xc)),Xc}function nl(){if(Qc)return Jc;Qc=1;var e=el(),t=/%[sdv%]/g,n=function(e){var n=1,i=arguments,r=i.length;return e.replace(t,function(e){if(n>=r)return e;var t=i[n];switch(n+=1,e){case"%%":return"%";case"%s":return String(t);case"%d":return Number(t);case"%v":return""}})},i=function(e,t,i){var r=[e+"="+(t.format instanceof Function?t.format(t.push?i:i[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var a=t.names[o];t.name?r.push(i[t.name][a]):r.push(i[t.names[o]])}else r.push(i[t.name]);return n.apply(null,r)},r=["v","o","s","i","u","e","p","c","b","t","r","z","a"],o=["i","c","b","a"];return Jc=function(t,n){n=n||{},null==t.version&&(t.version=0),null==t.name&&(t.name=" "),t.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var a=n.outerOrder||r,s=n.innerOrder||o,c=[];return a.forEach(function(n){e[n].forEach(function(e){e.name in t&&null!=t[e.name]?c.push(i(n,e,t)):e.push in t&&null!=t[e.push]&&t[e.push].forEach(function(t){c.push(i(n,e,t))})})}),t.media.forEach(function(t){c.push(i("m",e.m[0],t)),s.forEach(function(n){e[n].forEach(function(e){e.name in t&&null!=t[e.name]?c.push(i(n,e,t)):e.push in t&&null!=t[e.push]&&t[e.push].forEach(function(t){c.push(i(n,e,t))})})})}),c.join("\r\n")+"\r\n"},Jc}var il=function(){if($c)return Yc;$c=1;var e=tl(),t=nl(),n=el();return Yc.grammar=n,Yc.write=t,Yc.parse=e.parse,Yc.parseParams=e.parseParams,Yc.parseFmtpConfig=e.parseFmtpConfig,Yc.parsePayloads=e.parsePayloads,Yc.parseRemoteCandidates=e.parseRemoteCandidates,Yc.parseImageAttributes=e.parseImageAttributes,Yc.parseSimulcastStreamList=e.parseSimulcastStreamList,Yc}();function rl(e,t,n){var i,r,o;void 0===t&&(t=50),void 0===n&&(n={});var a=null!=(i=n.isImmediate)&&i,s=null!=(r=n.callback)&&r,c=n.maxWait,l=Date.now(),u=[];function d(){if(void 0!==c){var e=Date.now()-l;if(e+t>=c)return c-e}return t}var h=function(){var t=[].slice.call(arguments),n=this;return new Promise(function(i,r){var c=a&&void 0===o;if(void 0!==o&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,l=Date.now(),!a){var i=e.apply(n,t);s&&s(i),u.forEach(function(e){return(0,e.resolve)(i)}),u=[]}},d()),c){var h=e.apply(n,t);return s&&s(h),i(h)}u.push({resolve:i,reject:r})})};return h.cancel=function(e){void 0!==o&&clearTimeout(o),u.forEach(function(t){return(0,t.reject)(e)}),u=[]},h}const ol="negotiationStarted",al="negotiationComplete",sl="rtpVideoPayloadTypes";class cl extends No.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;super(),this.log=So,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=rl(e=>Ro(this,void 0,void 0,function*(){this.emit(ol);try{yield this.createAndSendOffer()}catch(dp){if(!e)throw dp;e(dp)}}),20),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=To(null!==(n=t.loggerName)&&void 0!==n?n:bo.PCTransport),this.loggerOptions=t,this.config=e,this._pc=this.createPC(),this.offerLock=new xt}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=e=>{var t;e.candidate&&(null===(t=this.onIceCandidate)||void 0===t||t.call(this,e.candidate))},e.onicecandidateerror=e=>{var t;null===(t=this.onIceCandidateError)||void 0===t||t.call(this,e)},e.oniceconnectionstatechange=()=>{var t;null===(t=this.onIceConnectionStateChange)||void 0===t||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;null===(t=this.onSignalingStatechange)||void 0===t||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,e.connectionState)},e.ondatachannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},e.ontrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},e}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}get isICEConnected(){return null!==this._pc&&("connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState)}addIceCandidate(e){return Ro(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,t){return Ro(this,void 0,void 0,function*(){var n;if("answer"===e.type&&this.latestOfferId>0&&t>0&&t!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:t,latestOfferId:this.latestOfferId})),!1;let i;if("offer"===e.type){let{stereoMids:t,nackMids:n}=function(e){var t;const n=[],i=[],r=il.parse(null!==(t=e.sdp)&&void 0!==t?t:"");let o=0;return r.media.forEach(e=>{var t;const r=dl(e.mid);"audio"===e.type&&(e.rtp.some(e=>"opus"===e.codec&&(o=e.payload,!0)),(null===(t=e.rtcpFb)||void 0===t?void 0:t.some(e=>e.payload===o&&"nack"===e.type))&&i.push(r),e.fmtp.some(e=>e.payload===o&&(e.config.includes("sprop-stereo=1")&&n.push(r),!0)))}),{stereoMids:n,nackMids:i}}(e);this.remoteStereoMids=t,this.remoteNackMids=n}else if("answer"===e.type){const t=il.parse(null!==(n=e.sdp)&&void 0!==n?n:"");t.media.forEach(e=>{const t=dl(e.mid);"audio"===e.type&&this.trackBitrates.some(n=>{if(!n.transceiver||t!=n.transceiver.mid)return!1;let i=0;if(e.rtp.some(e=>e.codec.toUpperCase()===n.codec.toUpperCase()&&(i=e.payload,!0)),0===i)return!0;let r=!1;for(const t of e.fmtp)if(t.payload===i){t.config=t.config.split(";").filter(e=>!e.includes("maxaveragebitrate")).join(";"),n.maxbr>0&&(t.config+=";maxaveragebitrate=".concat(1e3*n.maxbr)),r=!0;break}return r||n.maxbr>0&&e.fmtp.push({payload:i,config:"maxaveragebitrate=".concat(1e3*n.maxbr)}),!0})}),i=il.write(t)}if(yield this.setMungedSDP(e,i,!0),this.pendingCandidates.forEach(e=>{this.pc.addIceCandidate(e)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate)this.renegotiate=!1,yield this.createAndSendOffer();else if("answer"===e.type&&(this.emit(al),e.sdp)){il.parse(e.sdp).media.forEach(e=>{"video"===e.type&&this.emit(sl,e.rtp)})}return!0})}createAndSendOffer(e){return Ro(this,void 0,void 0,function*(){var t;const n=yield this.offerLock.lock();try{if(void 0===this.onOffer)return;if((null===e||void 0===e?void 0:e.iceRestart)&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&"have-local-offer"===this._pc.signalingState){const t=this._pc.remoteDescription;if(!(null===e||void 0===e?void 0:e.iceRestart)||!t)return void(this.renegotiate=!0);yield this._pc.setRemoteDescription(t)}else if(!this._pc||"closed"===this._pc.signalingState)return void this.log.warn("could not createOffer with closed peer connection",this.logContext);this.log.debug("starting to negotiate",this.logContext);const n=this.latestOfferId+1;this.latestOfferId=n;const i=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:i.sdp},this.logContext));const r=il.parse(null!==(t=i.sdp)&&void 0!==t?t:"");if(r.media.forEach(e=>{ul(e),"audio"===e.type?ll(e,["all"],[]):"video"===e.type&&this.trackBitrates.some(t=>{if(!e.msid||!t.cid||!e.msid.includes(t.cid))return!1;let n=0;if(e.rtp.some(e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0)),0===n)return!0;if(Ms(t.codec)&&!js()&&this.ensureVideoDDExtensionForSVC(e,r),"av1"!==t.codec)return!0;const i=Math.round(.7*t.maxbr);for(const r of e.fmtp)if(r.payload===n){r.config.includes("x-google-start-bitrate")||(r.config+=";x-google-start-bitrate=".concat(i));break}return!0})}),this.latestOfferId>n)return void this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:n}));yield this.setMungedSDP(i,il.write(r)),this.onOffer(i,this.latestOfferId)}finally{n()}})}createAndSetAnswer(){return Ro(this,void 0,void 0,function*(){var e;const t=yield this.pc.createAnswer(),n=il.parse(null!==(e=t.sdp)&&void 0!==e?e:"");return n.media.forEach(e=>{ul(e),"audio"===e.type&&ll(e,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,il.write(n)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTransceiverOfKind(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new rs("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new rs("PC closed, cannot configure");return null===(t=this._pc)||void 0===t?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(null===(e=this._pc)||void 0===e?void 0:e.removeTrack)}removeTrack(e){var t;return null===(t=this._pc)||void 0===t?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.connectionState)&&void 0!==t?t:"closed"}getICEConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.iceConnectionState)&&void 0!==t?t:"closed"}getSignallingState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.signalingState)&&void 0!==t?t:"closed"}getTransceivers(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getTransceivers())&&void 0!==t?t:[]}getSenders(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getSenders())&&void 0!==t?t:[]}getLocalDescription(){var e;return null===(e=this._pc)||void 0===e?void 0:e.localDescription}getRemoteDescription(){var e;return null===(e=this.pc)||void 0===e?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return Ro(this,void 0,void 0,function*(){var e;if(!this._pc)return;let t="";const n=new Map,i=new Map;if((yield this._pc.getStats()).forEach(e=>{switch(e.type){case"transport":t=e.selectedCandidatePairId;break;case"candidate-pair":""===t&&e.selected&&(t=e.id),n.set(e.id,e);break;case"remote-candidate":i.set(e.id,"".concat(e.address,":").concat(e.port))}}),""===t)return;const r=null===(e=n.get(t))||void 0===e?void 0:e.remoteCandidateId;return void 0!==r?i.get(r):void 0})}setMungedSDP(e,t,n){return Ro(this,void 0,void 0,function*(){if(t){const i=e.sdp;e.sdp=t;try{return this.log.debug("setting munged ".concat(n?"remote":"local"," description"),this.logContext),void(n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e))}catch(dp){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:dp,sdp:t})),e.sdp=i}}try{n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(dp){let i="unknown error";dp instanceof Error?i=dp.message:"string"===typeof dp&&(i=dp);const r={error:i,sdp:e.sdp};throw!n&&this.pc.remoteDescription&&(r.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:r})),new os(i)}})}ensureVideoDDExtensionForSVC(e,t){var n,i;if(!(null===(n=e.ext)||void 0===n?void 0:n.some(e=>e.uri===_s))){if(0===this.ddExtID){let e=0;t.media.forEach(t=>{var n;"video"===t.type&&(null===(n=t.ext)||void 0===n||n.forEach(t=>{t.value>e&&(e=t.value)}))}),this.ddExtID=e+1}null===(i=e.ext)||void 0===i||i.push({value:this.ddExtID,uri:_s})}}}function ll(e,t,n){const i=dl(e.mid);let r=0;e.rtp.some(e=>"opus"===e.codec&&(r=e.payload,!0)),r>0&&(e.rtcpFb||(e.rtcpFb=[]),n.includes(i)&&!e.rtcpFb.some(e=>e.payload===r&&"nack"===e.type)&&e.rtcpFb.push({payload:r,type:"nack"}),(t.includes(i)||1===t.length&&"all"===t[0])&&e.fmtp.some(e=>e.payload===r&&(e.config.includes("stereo=1")||(e.config+=";stereo=1"),!0)))}function ul(e){if(e.connection){const t=e.connection.ip.indexOf(":")>=0;(4===e.connection.version&&t||6===e.connection.version&&!t)&&(e.connection.ip="0.0.0.0",e.connection.version=4)}}function dl(e){return"number"===typeof e?e.toFixed(0):e}const hl="vp8",pl={audioPreset:Ps.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:Os.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:hl,backupCodec:!0,preConnectBuffer:!1},fl={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},ml={deviceId:{ideal:"default"},resolution:Rs.h720.resolution},gl={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new class{constructor(e){this._retryDelays=void 0!==e?[...e]:Eo}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+1e3*Math.random()}},disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!1},vl={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var yl;!function(e){e[e.NEW=0]="NEW",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.FAILED=3]="FAILED",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"}(yl||(yl={}));class bl{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t,n){var i;this.peerConnectionTimeout=vl.peerConnectionTimeout,this.log=So,this.updateState=()=>{var e,t;const n=this.state,i=this.requiredTransports.map(e=>e.getConnectionState());i.every(e=>"connected"===e)?this.state=yl.CONNECTED:i.some(e=>"failed"===e)?this.state=yl.FAILED:i.some(e=>"connecting"===e)?this.state=yl.CONNECTING:i.every(e=>"closed"===e)?this.state=yl.CLOSED:i.some(e=>"closed"===e)?this.state=yl.CLOSING:i.every(e=>"new"===e)&&(this.state=yl.NEW),n!==this.state&&(this.log.debug("pc state change: from ".concat(yl[n]," to ").concat(yl[this.state]),this.logContext),null===(e=this.onStateChange)||void 0===e||e.call(this,this.state,this.publisher.getConnectionState(),null===(t=this.subscriber)||void 0===t?void 0:t.getConnectionState()))},this.log=To(null!==(i=n.loggerName)&&void 0!==i?i:bo.PCManager),this.loggerOptions=n,this.isPublisherConnectionRequired="subscriber-primary"!==t,this.isSubscriberConnectionRequired="subscriber-primary"===t,this.publisher=new cl(e,n),"publisher-only"!==t&&(this.subscriber=new cl(e,n),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,hr.SUBSCRIBER)},this.subscriber.onDataChannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},this.subscriber.onTrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,hr.PUBLISHER)},this.publisher.onTrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},this.publisher.onOffer=(e,t)=>{var n;null===(n=this.onPublisherOffer)||void 0===n||n.call(this,e,t)},this.state=yl.NEW,this.connectionLock=new xt,this.remoteOfferLock=new xt}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}requirePublisher(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isPublisherConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,t){return this.publisher.setRemoteDescription(e,t)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return Ro(this,void 0,void 0,function*(){var e;if(this.publisher&&"closed"!==this.publisher.getSignallingState()){const e=this.publisher;for(const t of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(t)}catch(dp){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:dp}))}}yield Promise.all([this.publisher.close(),null===(e=this.subscriber)||void 0===e?void 0:e.close()]),this.updateState()})}triggerIceRestart(){return Ro(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return Ro(this,void 0,void 0,function*(){var n;t===hr.PUBLISHER?yield this.publisher.addIceCandidate(e):yield null===(n=this.subscriber)||void 0===n?void 0:n.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,t){return Ro(this,void 0,void 0,function*(){var n,i,r;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:null===(n=this.subscriber)||void 0===n?void 0:n.getSignallingState().toString()}));const o=yield this.remoteOfferLock.lock();try{if(!(yield null===(i=this.subscriber)||void 0===i?void 0:i.setRemoteDescription(e,t)))return;return yield null===(r=this.subscriber)||void 0===r?void 0:r.createAndSetAnswer()}finally{o()}})}updateConfiguration(e,t){var n;this.publisher.setConfiguration(e),null===(n=this.subscriber)||void 0===n||n.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){return Ro(this,void 0,void 0,function*(){var n;const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&"connected"!==this.publisher.getConnectionState()&&"connecting"!==this.publisher.getConnectionState()&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all(null===(n=this.requiredTransports)||void 0===n?void 0:n.map(n=>this.ensureTransportConnected(n,e,t)))}finally{i()}})}negotiate(e){return Ro(this,void 0,void 0,function*(){return new Promise((t,n)=>Ro(this,void 0,void 0,function*(){const i=setTimeout(()=>{n("negotiation timed out")},this.peerConnectionTimeout);e.signal.addEventListener("abort",()=>{clearTimeout(i),n("negotiation aborted")}),this.publisher.once(ol,()=>{e.signal.aborted||this.publisher.once(al,()=>{clearTimeout(i),t()})}),yield this.publisher.negotiate(e=>{clearTimeout(i),n(e)})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTransceiverOfKind(e,t){return this.publisher.addTransceiverOfKind(e,t)}getMidForReceiver(e){const t=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(t=>t.receiver===e);return null===t||void 0===t?void 0:t.mid}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===hr.PUBLISHER||e===hr.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&e.push(this.subscriber),e}ensureTransportConnected(e,t){return Ro(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.peerConnectionTimeout;return function*(){if("connected"!==e.getConnectionState())return new Promise((e,r)=>Ro(n,void 0,void 0,function*(){const n=()=>{this.log.warn("abort transport connection",this.logContext),ms.clearTimeout(o),r(new es("room connection has been cancelled",Ga.Cancelled))};(null===t||void 0===t?void 0:t.signal.aborted)&&n(),null===t||void 0===t||t.signal.addEventListener("abort",n);const o=ms.setTimeout(()=>{null===t||void 0===t||t.signal.removeEventListener("abort",n),r(new es("could not establish pc connection",Ga.InternalError))},i);for(;this.state!==yl.CONNECTED;)if(yield Is(50),null===t||void 0===t?void 0:t.signal.aborted)return void r(new es("room connection has been cancelled",Ga.Cancelled));ms.clearTimeout(o),null===t||void 0===t||t.signal.removeEventListener("abort",n),e()}))}()})}}class kl extends Error{constructor(e,t,n){super(t),this.code=e,this.message=Tl(t,kl.MAX_MESSAGE_BYTES),this.data=n?Tl(n,kl.MAX_DATA_BYTES):void 0}static fromProto(e){return new kl(e.code,e.message,e.data)}toProto(){return new Qi({code:this.code,message:this.message,data:this.data})}static builtIn(e,t){return new kl(kl.ErrorCode[e],kl.ErrorMessage[e],t)}}kl.MAX_MESSAGE_BYTES=256,kl.MAX_DATA_BYTES=15360,kl.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404},kl.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};function Sl(e){return(new TextEncoder).encode(e).length}function Tl(e,t){if(Sl(e)<=t)return e;let n=0,i=e.length;const r=new TextEncoder;for(;n<i;){const o=Math.floor((n+i+1)/2);r.encode(e.slice(0,o)).length<=t?n=o:i=o-1}return e.slice(0,n)}const wl=2e3;function Cl(e,t){if(!t)return 0;let n,i;return"bytesReceived"in e?(n=e.bytesReceived,i=t.bytesReceived):"bytesSent"in e&&(n=e.bytesSent,i=t.bytesSent),void 0===n||void 0===i||void 0===e.timestamp||void 0===t.timestamp?0:8*(n-i)*1e3/(e.timestamp-t.timestamp)}const El="undefined"!==typeof MediaRecorder;const Pl=El?MediaRecorder:class{constructor(){throw new Error("MediaRecorder is not available in this environment")}};class Rl extends Pl{constructor(e,t){if(!El)throw new Error("MediaRecorder is not available in this environment");let n,i;super(new MediaStream([e.mediaStreamTrack]),t);const r=()=>{this.removeEventListener("dataavailable",n),this.removeEventListener("stop",r),this.removeEventListener("error",o),null===i||void 0===i||i.close(),i=void 0},o=e=>{null===i||void 0===i||i.error(e),this.removeEventListener("dataavailable",n),this.removeEventListener("stop",r),this.removeEventListener("error",o),i=void 0};this.byteStream=new ReadableStream({start:e=>{i=e,n=t=>Ro(this,void 0,void 0,function*(){let n;if(t.data.arrayBuffer){const e=yield t.data.arrayBuffer();n=new Uint8Array(e)}else{if(!t.data.byteArray)throw new Error("no data available!");n=t.data.byteArray}void 0!==i&&e.enqueue(n)}),this.addEventListener("dataavailable",n)},cancel:()=>{r()}}),this.addEventListener("stop",r),this.addEventListener("error",o)}}class xl extends ys{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(e,t,arguments.length>4?arguments[4]:void 0),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=rl(()=>Ro(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>Ro(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(Za.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new xt,this.pauseUpstreamLock=new xt,this.trackChangeLock=new xt,this.trackChangeLock.lock().then(t=>Ro(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{t()}})),this._constraints=e.getConstraints(),n&&(this._constraints=n)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==ys.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();return e&&t?{width:e,height:t}:void 0}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return null!==(t=null===(e=this.processor)||void 0===e?void 0:e.processedTrack)&&void 0!==t?t:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,t){return Ro(this,void 0,void 0,function*(){var n;if(e===this._mediaStreamTrack&&!t)return;let i;if(this._mediaStreamTrack&&(this.attachedElements.forEach(e=>{ks(this._mediaStreamTrack,e)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints()),this.processor&&e){if(this.log.debug("restarting processor",this.logContext),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(bs(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}this.sender&&"closed"!==(null===(n=this.sender.transport)||void 0===n?void 0:n.state)&&(yield this.sender.replaceTrack(null!==i&&void 0!==i?i:e)),this.providedByUser||this._mediaStreamTrack===e||this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(t=>{bs(null!==i&&void 0!==i?i:e,t)}))})}waitForDimensions(){return Ro(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return function*(){var n;if(e.kind===ys.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");"iOS"===(null===(n=ds())||void 0===n?void 0:n.os)&&(yield Is(10));const i=Date.now();for(;Date.now()-i<t;){const t=e.dimensions;if(t)return t;yield Is(50)}throw new ns("unable to get track dimensions after timeout")}()})}setDeviceId(e){return Ro(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===oc(e)||(this._constraints.deviceId=e,!!this.isMuted||(yield this.restartTrack(),oc(e)===this._mediaStreamTrack.getSettings().deviceId))})}getDeviceId(){return Ro(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){if(e.source===ys.Source.ScreenShare)return;const{deviceId:n,groupId:i}=e._mediaStreamTrack.getSettings(),r=e.kind===ys.Kind.Audio?"audioinput":"videoinput";return t?Dc.getInstance().normalizeDeviceId(r,n,i):n}()})}mute(){return Ro(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return Ro(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,t){return Ro(this,void 0,void 0,function*(){const n=yield this.trackChangeLock.lock();try{if(!this.sender)throw new ns("unable to replace an unpublished track");let n,i;return"boolean"===typeof t?n=t:void 0!==t&&(n=t.userProvidedTrack,i=t.stopProcessor),this.providedByUser=null===n||void 0===n||n,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),i&&this.processor&&(yield this.internalStopProcessor()),this}finally{n()}})}restart(e){return Ro(this,void 0,void 0,function*(){this.manuallyStopped=!1;const t=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:t,facingMode:n}=e,i=Po(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const r={audio:!1,video:!1};this.kind===ys.Kind.Video?r.video=!t&&!n||{deviceId:t,facingMode:n}:r.audio=!t||Object.assign({deviceId:t},i),this.attachedElements.forEach(e=>{ks(this.mediaStreamTrack,e)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const o=(yield navigator.mediaDevices.getUserMedia(r)).getTracks()[0];return this.kind===ys.Kind.Video&&(yield o.applyConstraints(i)),o.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(o),this._constraints=e,this.emit(Za.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{t()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),this.isMuted===e&&this._mediaStreamTrack.enabled!==e||(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?Za.Muted:Za.Unmuted,this))}get needsReAcquisition(){return"live"!==this._mediaStreamTrack.readyState||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Ro(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),zs()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),this.isInBackground||!this.needsReAcquisition||this.isUserProvided||this.isMuted||(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),null===(e=this.processor)||void 0===e||e.destroy(),this.processor=void 0}pauseUpstream(){return Ro(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(!0===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to pause upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!0,this.emit(Za.UpstreamPaused,this);const t=ds();if("Safari"===(null===t||void 0===t?void 0:t.name)&&Js(t.version,"12.0")<0)throw new ts("pauseUpstream is not supported on Safari < 12.");"closed"!==(null===(e=this.sender.transport)||void 0===e?void 0:e.state)&&(yield this.sender.replaceTrack(null))}finally{t()}})}resumeUpstream(){return Ro(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(!1===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to resume upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!1,this.emit(Za.UpstreamResumed,this),"closed"!==(null===(e=this.sender.transport)||void 0===e?void 0:e.state)&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{t()}})}getRTCStatsReport(){return Ro(this,void 0,void 0,function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;return yield this.sender.getStats()})}setProcessor(e){return Ro(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var i;const r=yield t.trackChangeLock.lock();try{t.log.debug("setting up processor",t.logContext);const r=document.createElement(t.kind),o={kind:t.kind,track:t._mediaStreamTrack,element:r,audioContext:t.audioContext};if(yield e.init(o),t.log.debug("processor initialized",t.logContext),t.processor&&(yield t.internalStopProcessor()),"unknown"===t.kind)throw TypeError("cannot set processor on track of unknown kind");if(bs(t._mediaStreamTrack,r),r.muted=!0,r.play().catch(e=>{e instanceof DOMException&&"AbortError"===e.name?(t.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},t.logContext),{error:e})),setTimeout(()=>{r.play().catch(e=>{t.log.error("failed to play processor element",Object.assign(Object.assign({},t.logContext),{err:e}))})},100)):t.log.error("failed to play processor element",Object.assign(Object.assign({},t.logContext),{error:e}))}),t.processor=e,t.processorElement=r,t.processor.processedTrack){for(const e of t.attachedElements)e!==t.processorElement&&n&&(ks(t._mediaStreamTrack,e),bs(t.processor.processedTrack,e));yield null===(i=t.sender)||void 0===i?void 0:i.replaceTrack(t.processor.processedTrack)}t.emit(Za.TrackProcessorUpdate,t.processor)}finally{r()}}()})}getProcessor(){return this.processor}stopProcessor(){return Ro(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){const n=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(t)}finally{n()}}()})}internalStopProcessor(){return Ro(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){var n,i;e.processor&&(e.log.debug("stopping processor",e.logContext),null===(n=e.processor.processedTrack)||void 0===n||n.stop(),yield e.processor.destroy(),e.processor=void 0,t||(null===(i=e.processorElement)||void 0===i||i.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(Za.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;if(El)if(this.localTrackRecorder)this.log.warn("preconnect buffer already started");else{{let e="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(e)||(e="video/mp4"),this.localTrackRecorder=new Rl(this,{mimeType:e})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},1e4)}else this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return null===(e=this.localTrackRecorder)||void 0===e?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return null===(e=this.localTrackRecorder)||void 0===e?void 0:e.mimeType}}class Ol extends xl{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;super(e,ys.Kind.Audio,t,n,r),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>Ro(this,void 0,void 0,function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(dp){return void this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:dp}))}e&&this.prevStats&&(this._currentBitrate=Cl(e,this.prevStats)),this.prevStats=e}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(Za.AudioTrackFeatureUpdate,this,Ti.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(Za.AudioTrackFeatureUpdate,this,Ti.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=i,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return Ro(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===ys.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return Ro(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const t=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==oc(this._constraints.deviceId);return this.source!==ys.Source.Microphone||!this.stopOnMute&&"ended"!==this._mediaStreamTrack.readyState&&!t||this.isUserProvided||(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return Ro(this,void 0,void 0,function*(){let t;if(e){const n=kc({audio:e});"boolean"!==typeof n.audio&&(t=n.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return Ro(this,void 0,void 0,function*(){const n=yield t.restart.call(this,e);return this.checkForSilence(),n})}startMonitor(){Vs()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},wl)))}setProcessor(e){return Ro(this,void 0,void 0,function*(){var t;const n=yield this.trackChangeLock.lock();try{if(!qs()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const n={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(n),this.processor=e,this.processor.processedTrack&&(yield null===(t=this.sender)||void 0===t?void 0:t.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(Za.TrackProcessorUpdate,this.processor)}finally{n()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return Ro(this,void 0,void 0,function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;let t;return(yield this.sender.getStats()).forEach(e=>{"outbound-rtp"===e.type&&(t={type:"audio",streamId:e.id,packetsSent:e.packetsSent,packetsLost:e.packetsLost,bytesSent:e.bytesSent,timestamp:e.timestamp,roundTripTime:e.roundTripTime,jitter:e.jitter})}),t})}checkForSilence(){return Ro(this,void 0,void 0,function*(){const e=yield Sc(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit(Za.AudioSilenceDetected)),e})}}const _l=Object.values(Rs),Il=Object.values(xs),Nl=Object.values(Os),Dl=[Rs.h180,Rs.h360],Ml=[xs.h180,xs.h360],Al=["q","h","f"];function Ll(e,t,n,i){var r,o;let a=null===i||void 0===i?void 0:i.videoEncoding;e&&(a=null===i||void 0===i?void 0:i.screenShareEncoding);const s=null===i||void 0===i?void 0:i.simulcast,c=null===i||void 0===i?void 0:i.scalabilityMode,l=null===i||void 0===i?void 0:i.videoCodec;if(!a&&!s&&!c||!t||!n)return[{}];a||(a=function(e,t,n,i){const r=function(e,t,n){if(e)return Nl;const i=t>n?t/n:n/t;if(Math.abs(i-16/9)<Math.abs(i-4/3))return _l;return Il}(e,t,n);let{encoding:o}=r[0];const a=Math.max(t,n);for(let s=0;s<r.length;s+=1){const e=r[s];if(o=e.encoding,e.width>=a)break}if(i)switch(i){case"av1":case"h265":o=Object.assign({},o),o.maxBitrate=.7*o.maxBitrate;break;case"vp9":o=Object.assign({},o),o.maxBitrate=.85*o.maxBitrate}return o}(e,t,n,l),So.debug("using video encoding",a));const u=a.maxFramerate,d=new Ss(t,n,a.maxBitrate,a.maxFramerate,a.priority);if(c&&Ms(l)){const e=new Bl(c),t=[];if(e.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));const n=ds();if(Fs()||qs()||"Chrome"===(null===n||void 0===n?void 0:n.name)&&Js(null===n||void 0===n?void 0:n.version,"113")<0){const i="h"==e.suffix?2:3,r=function(e){return e||(e=ds()),"Safari"===(null===e||void 0===e?void 0:e.name)&&Js(e.version,"18.3")>0||"iOS"===(null===e||void 0===e?void 0:e.os)&&!!(null===e||void 0===e?void 0:e.osVersion)&&Js(e.osVersion,"18.3")>0}(n);for(let n=0;n<e.spatial;n+=1)t.push({rid:Al[2-n],maxBitrate:a.maxBitrate/Math.pow(i,n),maxFramerate:d.encoding.maxFramerate,scaleResolutionDownBy:r?Math.pow(2,n):void 0});t[0].scalabilityMode=c}else t.push({maxBitrate:a.maxBitrate,maxFramerate:d.encoding.maxFramerate,scalabilityMode:c});return d.encoding.priority&&(t[0].priority=d.encoding.priority,t[0].networkPriority=d.encoding.priority),So.debug("using svc encoding",{encodings:t}),t}if(!s)return[a];let h,p=[];if(p=e?null!==(r=Fl(null===i||void 0===i?void 0:i.screenShareSimulcastLayers))&&void 0!==r?r:Ul(e,d):null!==(o=Fl(null===i||void 0===i?void 0:i.videoSimulcastLayers))&&void 0!==o?o:Ul(e,d),p.length>0){const e=p[0];p.length>1&&([,h]=p);const i=Math.max(t,n);if(i>=960&&h)return jl(t,n,[e,h,d],u);if(i>=480)return jl(t,n,[e,d],u)}return jl(t,n,[d])}function Ul(e,t){if(e)return[{scaleResolutionDownBy:2,fps:(n=t).encoding.maxFramerate}].map(e=>{var t,i;return new Ss(Math.floor(n.width/e.scaleResolutionDownBy),Math.floor(n.height/e.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(e.scaleResolutionDownBy,2)*((null!==(t=n.encoding.maxFramerate)&&void 0!==t?t:30)/(null!==(i=e.fps)&&void 0!==i?i:30))))),e.fps,n.encoding.priority)});var n;const{width:i,height:r}=t,o=i>r?i/r:r/i;return Math.abs(o-16/9)<Math.abs(o-4/3)?Dl:Ml}function jl(e,t,n,i){const r=[];if(n.forEach((n,o)=>{if(o>=Al.length)return;const a=Math.min(e,t),s={rid:Al[o],scaleResolutionDownBy:Math.max(1,a/Math.min(n.width,n.height)),maxBitrate:n.encoding.maxBitrate},c=i&&n.encoding.maxFramerate?Math.min(i,n.encoding.maxFramerate):n.encoding.maxFramerate;c&&(s.maxFramerate=c);const l=Ls()||0===o;n.encoding.priority&&l&&(s.priority=n.encoding.priority,s.networkPriority=n.encoding.priority),r.push(s)}),qs()&&"ios"===Gs()){let e;r.forEach(t=>{e?t.maxFramerate&&t.maxFramerate>e&&(e=t.maxFramerate):e=t.maxFramerate});let t=!0;r.forEach(n=>{var i;n.maxFramerate!=e&&(t&&(t=!1,So.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),So.info('Setting framerate of encoding "'.concat(null!==(i=n.rid)&&void 0!==i?i:"",'" to ').concat(e)),n.maxFramerate=e)})}return r}function Fl(e){if(e)return e.sort((e,t)=>{const{encoding:n}=e,{encoding:i}=t;return n.maxBitrate>i.maxBitrate?1:n.maxBitrate<i.maxBitrate?-1:n.maxBitrate===i.maxBitrate&&n.maxFramerate&&i.maxFramerate?n.maxFramerate>i.maxFramerate?1:-1:0})}class Bl{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat(null!==(e=this.suffix)&&void 0!==e?e:"")}}class zl extends xl{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;super(e,ys.Kind.Video,t,n,i),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>Ro(this,void 0,void 0,function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(dp){return void this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:dp}))}const t=new Map(e.map(e=>[e.rid,e])),n=e.some(e=>"cpu"===e.qualityLimitationReason);if(n!==this.isCpuConstrained&&(this.isCpuConstrained=n,this.isCpuConstrained&&this.emit(Za.CpuConstrained)),this.prevStats){let e=0;t.forEach((t,n)=>{var i;const r=null===(i=this.prevStats)||void 0===i?void 0:i.get(n);e+=Cl(t,r)}),this._currentBitrate=e}this.prevStats=t}),this.senderLock=new xt}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!Vs())return;const n=null===(t=this.sender)||void 0===t?void 0:t.getParameters();n&&(this.encodings=n.encodings),this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},wl))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return Ro(this,void 0,void 0,function*(){var t,n,i,r,o;yield e.pauseUpstream.call(this);try{for(var a,s=!0,c=Oo(this.simulcastCodecs.values());!(t=(a=yield c.next()).done);s=!0){r=a.value,s=!1;const e=r;yield null===(o=e.sender)||void 0===o?void 0:o.replaceTrack(null)}}catch(l){n={error:l}}finally{try{s||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return Ro(this,void 0,void 0,function*(){var t,n,i,r,o;yield e.resumeUpstream.call(this);try{for(var a,s=!0,c=Oo(this.simulcastCodecs.values());!(t=(a=yield c.next()).done);s=!0){r=a.value,s=!1;const e=r;yield null===(o=e.sender)||void 0===o?void 0:o.replaceTrack(e.mediaStreamTrack)}}catch(l){n={error:l}}finally{try{s||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return Ro(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source!==ys.Source.Camera||this.isUserProvided||(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return Ro(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.source!==ys.Source.Camera||this.isUserProvided||(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){return Ro(this,void 0,void 0,function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return[];const t=[],n=yield this.sender.getStats();return n.forEach(e=>{var i;if("outbound-rtp"===e.type){const r={type:"video",streamId:e.id,frameHeight:e.frameHeight,frameWidth:e.frameWidth,framesPerSecond:e.framesPerSecond,framesSent:e.framesSent,firCount:e.firCount,pliCount:e.pliCount,nackCount:e.nackCount,packetsSent:e.packetsSent,bytesSent:e.bytesSent,qualityLimitationReason:e.qualityLimitationReason,qualityLimitationDurations:e.qualityLimitationDurations,qualityLimitationResolutionChanges:e.qualityLimitationResolutionChanges,rid:null!==(i=e.rid)&&void 0!==i?i:e.id,retransmittedPacketsSent:e.retransmittedPacketsSent,targetBitrate:e.targetBitrate,timestamp:e.timestamp},o=n.get(e.remoteId);o&&(r.jitter=o.jitter,r.packetsLost=o.packetsLost,r.roundTripTime=o.roundTripTime),t.push(r)}}),t.sort((e,t)=>{var n,i;return(null!==(n=t.frameWidth)&&void 0!==n?n:0)-(null!==(i=e.frameWidth)&&void 0!==i?i:0)}),t})}setPublishingQuality(e){const t=[];for(let n=vs.LOW;n<=vs.HIGH;n+=1)t.push(new Vr({quality:n,enabled:n<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(Ms(this.codec),t)}restartTrack(e){return Ro(this,void 0,void 0,function*(){var t,n,i,r,o;let a;if(e){const t=kc({video:e});"boolean"!==typeof t.video&&(a=t.video)}yield this.restart(a),this.isCpuConstrained=!1;try{for(var s,c=!0,l=Oo(this.simulcastCodecs.values());!(t=(s=yield l.next()).done);c=!0){r=s.value,c=!1;const e=r;e.sender&&"closed"!==(null===(o=e.sender.transport)||void 0===o?void 0:o.state)&&(e.mediaStreamTrack=this.mediaStreamTrack.clone(),yield e.sender.replaceTrack(e.mediaStreamTrack))}}catch(u){n={error:u}}finally{try{c||t||!(i=l.return)||(yield i.call(l))}finally{if(n)throw n.error}}})}setProcessor(e){const t=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return Ro(this,arguments,void 0,function(e){var n=this;let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var r,o,a,s,c,l;if(yield t.setProcessor.call(n,e,i),null===(c=n.processor)||void 0===c?void 0:c.processedTrack)try{for(var u,d=!0,h=Oo(n.simulcastCodecs.values());!(r=(u=yield h.next()).done);d=!0){s=u.value,d=!1;const e=s;yield null===(l=e.sender)||void 0===l?void 0:l.replaceTrack(n.processor.processedTrack)}}catch(p){o={error:p}}finally{try{d||r||!(a=h.return)||(yield a.call(h))}finally{if(o)throw o.error}}}()})}setDegradationPreference(e){return Ro(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const t=this.sender.getParameters();t.degradationPreference=e,this.sender.setParameters(t)}catch(dp){this.log.warn("failed to set degradationPreference",Object.assign({error:dp},this.logContext))}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e))return void this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);const n={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,n),n}setSimulcastTrackSender(e,t){const n=this.simulcastCodecs.get(e);n&&(n.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},5e3))}setPublishingCodecs(e){return Ro(this,void 0,void 0,function*(){var t,n,i,r,o,a,s;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(Ms(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(t=!0,n=Oo(e);!(r=(i=yield n.next()).done);t=!0){s=i.value,t=!1;const e=s;if(this.codec&&this.codec!==e.codec){const t=this.simulcastCodecs.get(e.codec);if(this.log.debug("try setPublishingCodec for ".concat(e.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:t})),t&&t.sender)t.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(e.codec),this.logContext),yield Vl(t.sender,t.encodings,e.qualities,this.senderLock,Ms(e.codec),this.log,this.logContext));else for(const n of e.qualities)if(n.enabled){c.push(e.codec);break}}else yield this.setPublishingLayers(Ms(e.codec),e.qualities)}}catch(l){o={error:l}}finally{try{t||r||!(a=n.return)||(yield a.call(n))}finally{if(o)throw o.error}}return c})}setPublishingLayers(e,t){return Ro(this,void 0,void 0,function*(){this.optimizeForPerformance?this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:t})):(this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),this.sender&&this.encodings&&(yield Vl(this.sender,this.encodings,t,this.senderLock,e,this.log,this.logContext)))})}prioritizePerformance(){return Ro(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const e=this.sender.getParameters();e.encodings=e.encodings.map((e,t)=>{var n;return Object.assign(Object.assign({},e),{active:0===t,scaleResolutionDownBy:Math.max(1,Math.ceil((null!==(n=this.mediaStreamTrack.getSettings().height)&&void 0!==n?n:360)/360)),scalabilityMode:0===t&&Ms(this.codec)?"L1T3":void 0,maxFramerate:0===t?15:0,maxBitrate:0===t?e.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:e.encodings})),this.encodings=e.encodings,yield this.sender.setParameters(e)}catch(dp){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:dp})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Ro(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),zs()&&this.isInBackground&&this.source===ys.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function Vl(e,t,n,i,r,o,a){return Ro(this,void 0,void 0,function*(){const s=yield i.lock();o.debug("setPublishingLayersForSender",Object.assign(Object.assign({},a),{sender:e,qualities:n,senderEncodings:t}));try{const i=e.getParameters(),{encodings:s}=i;if(!s)return;if(s.length!==t.length)return void o.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},a),{encodings:s,senderEncodings:t}));let c=!1;if(!1&&s[0].scalabilityMode);else{if(r){n.some(e=>e.enabled)&&n.forEach(e=>e.enabled=!0)}s.forEach((e,i)=>{var r;let s=null!==(r=e.rid)&&void 0!==r?r:"";""===s&&(s="q");const l=ql(s),u=n.find(e=>e.quality===l);u&&e.active!==u.enabled&&(c=!0,e.active=u.enabled,o.debug("setting layer ".concat(u.quality," to ").concat(e.active?"enabled":"disabled"),a),Ls()&&(u.enabled?(e.scaleResolutionDownBy=t[i].scaleResolutionDownBy,e.maxBitrate=t[i].maxBitrate,e.maxFrameRate=t[i].maxFrameRate):(e.scaleResolutionDownBy=4,e.maxBitrate=10,e.maxFrameRate=2)))})}c&&(i.encodings=s,o.debug("setting encodings",Object.assign(Object.assign({},a),{encodings:i.encodings})),yield e.setParameters(i))}finally{s()}})}function ql(e){switch(e){case"f":default:return vs.HIGH;case"h":return vs.MEDIUM;case"q":return vs.LOW}}function Hl(e,t,n,i){if(!n)return[new Di({quality:vs.HIGH,width:e,height:t,bitrate:0,ssrc:0})];if(i){const i=n[0].scalabilityMode,r=new Bl(i),o=[],a="h"==r.suffix?1.5:2,s="h"==r.suffix?2:3;for(let c=0;c<r.spatial;c+=1)o.push(new Di({quality:Math.min(vs.HIGH,r.spatial-1)-c,width:Math.ceil(e/Math.pow(a,c)),height:Math.ceil(t/Math.pow(a,c)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(s,c)):0,ssrc:0}));return o}return n.map(n=>{var i,r,o;const a=null!==(i=n.scaleResolutionDownBy)&&void 0!==i?i:1;let s=ql(null!==(r=n.rid)&&void 0!==r?r:"");return new Di({quality:s,width:Math.ceil(e/a),height:Math.ceil(t/a),bitrate:null!==(o=n.maxBitrate)&&void 0!==o?o:0,ssrc:0})})}const Wl="_lossy",Gl="_reliable",Kl="leave-reconnect";var Jl;!function(e){e[e.New=0]="New",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected",e[e.Reconnecting=3]="Reconnecting",e[e.Closed=4]="Closed"}(Jl||(Jl={}));class Ql extends No.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=vl.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=Jl.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=So,this.reliableDataSequence=1,this.reliableMessageBuffer=new Hc,this.reliableReceivedState=new Wc(3e4),this.midToTrackId={},this.handleDataChannel=e=>Ro(this,[e],void 0,function(e){var t=this;let{channel:n}=e;return function*(){if(n){if(n.label===Gl)t.reliableDCSub=n;else{if(n.label!==Wl)return;t.lossyDCSub=n}t.log.debug("on data channel ".concat(n.id,", ").concat(n.label),t.logContext),n.onmessage=t.handleDataMessage}}()}),this.handleDataMessage=e=>Ro(this,void 0,void 0,function*(){var t,n,i,r,o;const a=yield this.dataProcessLock.lock();try{let a;if(e.data instanceof ArrayBuffer)a=e.data;else{if(!(e.data instanceof Blob))return void this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:e.data}));a=yield e.data.arrayBuffer()}const s=Ai.fromBinary(new Uint8Array(a));if(s.sequence>0&&""!==s.participantSid){const e=this.reliableReceivedState.get(s.participantSid);if(e&&s.sequence<=e)return;this.reliableReceivedState.set(s.participantSid,s.sequence)}if("speaker"===(null===(t=s.value)||void 0===t?void 0:t.case))this.emit(Xa.ActiveSpeakersUpdate,s.value.value.speakers);else if("encryptedPacket"===(null===(n=s.value)||void 0===n?void 0:n.case)){if(!this.e2eeManager)return void this.log.error("Received encrypted packet but E2EE not set up",this.logContext);const e=yield null===(i=this.e2eeManager)||void 0===i?void 0:i.handleEncryptedData(s.value.value.encryptedValue,s.value.value.iv,s.participantIdentity,s.value.value.keyIndex),t=ji.fromBinary(e.payload),n=new Ai({value:t.value,participantIdentity:s.participantIdentity,participantSid:s.participantSid});"user"===(null===(r=n.value)||void 0===r?void 0:r.case)&&Yl(n,n.value.value),this.emit(Xa.DataPacketReceived,n,s.value.value.encryptionType)}else"user"===(null===(o=s.value)||void 0===o?void 0:o.case)&&Yl(s,s.value.value),this.emit(Xa.DataPacketReceived,s,_i.NONE)}finally{a()}}),this.handleDataError=e=>{const t=0===e.currentTarget.maxRetransmits?"lossy":"reliable";if(e instanceof ErrorEvent&&e.error){const{error:n}=e.error;this.log.error("DataChannel error on ".concat(t,": ").concat(e.message),Object.assign(Object.assign({},this.logContext),{error:n}))}else this.log.error("Unknown DataChannel error on ".concat(t),Object.assign(Object.assign({},this.logContext),{event:e}))},this.handleBufferedAmountLow=e=>{const t=0===e.currentTarget.maxRetransmits?Li.LOSSY:Li.RELIABLE;this.updateAndEmitDCBufferStatus(t)},this.handleDisconnect=(e,t)=>{if(this._isClosed)return;this.log.warn("".concat(e," disconnected"),this.logContext),0===this.reconnectAttempts&&(this.reconnectStart=Date.now());const n=e=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(e,"ms. giving up"),this.logContext),this.emit(Xa.Disconnected),this.close()},i=Date.now()-this.reconnectStart;let r=this.getNextRetryDelay({elapsedMs:i,retryCount:this.reconnectAttempts});null!==r?(e===Kl&&(r=0),this.log.debug("reconnecting in ".concat(r,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=ms.setTimeout(()=>this.attemptReconnect(t).finally(()=>this.reconnectTimeout=void 0),r)):n(i)},this.waitForRestarted=()=>new Promise((e,t)=>{this.pcState===Jl.Connected&&e();const n=()=>{this.off(Xa.Disconnected,i),e()},i=()=>{this.off(Xa.Restarted,n),t()};this.once(Xa.Restarted,n),this.once(Xa.Disconnected,i)}),this.updateAndEmitDCBufferStatus=e=>{const t=this.isBufferStatusLow(e);"undefined"!==typeof t&&t!==this.dcBufferStatus.get(e)&&(this.dcBufferStatus.set(e,t),this.emit(Xa.DCBufferStatusChanged,t,e))},this.isBufferStatusLow=e=>{const t=this.dataChannelForKind(e);if(t)return e===Li.RELIABLE&&this.reliableMessageBuffer.alignBufferedAmount(t.bufferedAmount),t.bufferedAmount<=t.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Bc.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(ki.RR_SIGNAL_DISCONNECTED))},this.log=To(null!==(t=e.loggerName)&&void 0!==t?t:bo.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new zc(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new xt,this.dataProcessLock=new xt,this.dcBufferStatus=new Map([[Li.LOSSY,!0],[Li.RELIABLE,!0]]),this.client.onParticipantUpdate=e=>this.emit(Xa.ParticipantUpdate,e),this.client.onConnectionQuality=e=>this.emit(Xa.ConnectionQualityUpdate,e),this.client.onRoomUpdate=e=>this.emit(Xa.RoomUpdate,e),this.client.onSubscriptionError=e=>this.emit(Xa.SubscriptionError,e),this.client.onSubscriptionPermissionUpdate=e=>this.emit(Xa.SubscriptionPermissionUpdate,e),this.client.onSpeakersChanged=e=>this.emit(Xa.SpeakersChanged,e),this.client.onStreamStateUpdate=e=>this.emit(Xa.StreamStateChanged,e),this.client.onRequestResponse=e=>this.emit(Xa.SignalRequestResponse,e)}get logContext(){var e,t,n,i,r,o;return{room:null===(t=null===(e=this.latestJoinResponse)||void 0===e?void 0:e.room)||void 0===t?void 0:t.name,roomID:null===(i=null===(n=this.latestJoinResponse)||void 0===n?void 0:n.room)||void 0===i?void 0:i.sid,participant:null===(o=null===(r=this.latestJoinResponse)||void 0===r?void 0:r.participant)||void 0===o?void 0:o.identity,pID:this.participantSid}}join(e,t,n,i){return Ro(this,void 0,void 0,function*(){this.url=e,this.token=t,this.signalOpts=n,this.maxJoinAttempts=n.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const r=yield this.client.join(e,t,n,i);return this._isClosed=!1,this.latestJoinResponse=r,this.subscriberPrimary=r.subscriberPrimary,this.pcManager||(yield this.configure(r)),this.subscriberPrimary&&!r.fastPublish||this.negotiate().catch(e=>{So.error(e,this.logContext)}),this.registerOnLineListener(),this.clientConfiguration=r.clientConfiguration,this.emit(Xa.SignalConnected,r),r}catch(dp){if(dp instanceof es&&dp.reason===Ga.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,n,i);throw dp}})}close(){return Ro(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed)e();else try{this._isClosed=!0,this.joinAttempts=0,this.emit(Xa.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return Ro(this,void 0,void 0,function*(){var e;yield null===(e=this.pcManager)||void 0===e?void 0:e.close(),this.pcManager=void 0;const t=e=>{e&&(e.close(),e.onbufferedamountlow=null,e.onclose=null,e.onclosing=null,e.onerror=null,e.onmessage=null,e.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new Hc,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupClient(){return Ro(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new ns("a track with the same ID has already been published");return new Promise((t,n)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],n(new es("publication of local track timed out, no response from server",Ga.Timeout))},1e4);this.pendingTrackResolvers[e.cid]={resolve:e=>{clearTimeout(i),t(e)},reject:()=>{clearTimeout(i),n(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(dp){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:dp}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return null===(e=this.reliableDCSub)||void 0===e?void 0:e.readyState}getConnectedServerAddress(){return Ro(this,void 0,void 0,function*(){var e;return null===(e=this.pcManager)||void 0===e?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return Ro(this,void 0,void 0,function*(){var t,n;if(this.pcManager&&this.pcManager.currentState!==yl.NEW)return;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid;const i=this.makeRTCConfiguration(e);var r;this.pcManager=new bl(i,this.options.singlePeerConnection?"publisher-only":e.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(Xa.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(e,t)=>{this.client.sendIceCandidate(e,t)},this.pcManager.onPublisherOffer=(e,t)=>{this.client.sendOffer(e,t)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(t,n,i)=>Ro(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(t),this.logContext),["closed","disconnected","failed"].includes(n)&&(this.publisherConnectionPromise=void 0),t===yl.CONNECTED){const t=this.pcState===Jl.New;this.pcState=Jl.Connected,t&&this.emit(Xa.Connected,e)}else t===yl.FAILED&&(this.pcState!==Jl.Connected&&this.pcState!==Jl.Reconnecting||(this.pcState=Jl.Disconnected,this.handleDisconnect("peerconnection failed","failed"===i?ki.RR_SUBSCRIBER_FAILED:ki.RR_PUBLISHER_FAILED)));const r=this.client.isDisconnected||this.client.currentState===Bc.RECONNECTING,o=[yl.FAILED,yl.CLOSING,yl.CLOSED].includes(t);r&&o&&!this._isClosed&&this.emit(Xa.Offline)}),this.pcManager.onTrack=e=>{0!==e.streams.length&&this.emit(Xa.MediaTrackAdded,e.track,e.streams[0],e.receiver)},void 0!==(r=null===(n=e.serverInfo)||void 0===n?void 0:n.protocol)&&r>13||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,t,n)=>Ro(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,midToTrackId:n})),this.midToTrackId=n,yield this.pcManager.setPublisherAnswer(e,t))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=(e,t,n)=>Ro(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=t,!this.pcManager)return;this.midToTrackId=n;const i=yield this.pcManager.createSubscriberAnswerFromOffer(e,t);i&&this.client.sendAnswer(i,t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:null===(t=e.track)||void 0===t?void 0:t.sid})),!this.pendingTrackResolvers[e.cid])return void this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));const{resolve:n}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],n(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Xa.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(Xa.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(Xa.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Xa.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var t;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(Xa.RoomMoved,e)},this.client.onMediaSectionsRequirement=e=>{var t,n;const i={direction:"recvonly"};for(let r=0;r<e.numAudios;r++)null===(t=this.pcManager)||void 0===t||t.addPublisherTransceiverOfKind("audio",i);for(let r=0;r<e.numVideos;r++)null===(n=this.pcManager)||void 0===n||n.addPublisherTransceiverOfKind("video",i);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",ki.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:null===e||void 0===e?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case Nr.DISCONNECT:this.emit(Xa.Disconnected,null===e||void 0===e?void 0:e.reason),this.close();break;case Nr.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(Kl);break;case Nr.RESUME:this.handleDisconnect(Kl)}}}makeRTCConfiguration(e){var t;const n=Object.assign({},this.rtcConfig);if((null===(t=this.signalOpts)||void 0===t?void 0:t.e2eeEnabled)&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),n.encodedInsertableStreams=!0),e.iceServers&&!n.iceServers){const t=[];e.iceServers.forEach(e=>{const n={urls:e.urls};e.username&&(n.username=e.username),e.credential&&(n.credential=e.credential),t.push(n)}),n.iceServers=t}return e.clientConfiguration&&e.clientConfiguration.forceRelay===yi.ENABLED&&(n.iceTransportPolicy="relay"),n.sdpSemantics="unified-plan",n.continualGatheringPolicy="gather_continually",n}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(Wl,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Gl,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,t,n){return Ro(this,void 0,void 0,function*(){if(Ns()){return yield this.createTransceiverRTCRtpSender(e,t,n)}if(Ds()){this.log.warn("using add-track fallback",this.logContext);return yield this.createRTCRtpSender(e.mediaStreamTrack)}throw new rs("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,n,i){return Ro(this,void 0,void 0,function*(){if(Ns())return this.createSimulcastTransceiverSender(e,t,n,i);if(Ds())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new rs("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,n){return Ro(this,void 0,void 0,function*(){if(!this.pcManager)throw new rs("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream),hc(e)&&(e.codec=t.videoCodec);const r={direction:"sendonly",streams:i};n&&(r.sendEncodings=n);return(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,r)).sender})}createSimulcastTransceiverSender(e,t,n,i){return Ro(this,void 0,void 0,function*(){if(!this.pcManager)throw new rs("publisher is closed");const r={direction:"sendonly"};i&&(r.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,r);if(n.videoCodec)return e.setSimulcastTrackSender(n.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return Ro(this,void 0,void 0,function*(){if(!this.pcManager)throw new rs("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return Ro(this,void 0,void 0,function*(){var t,n,i;if(!this._isClosed)if(this.attemptingReconnect)So.warn("already attempting reconnect, returning early",this.logContext);else{(null===(t=this.clientConfiguration)||void 0===t?void 0:t.resumeConnection)!==yi.DISABLED&&(null!==(i=null===(n=this.pcManager)||void 0===n?void 0:n.currentState)&&void 0!==i?i:yl.NEW)!==yl.NEW||(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(dp){this.reconnectAttempts+=1;let t=!0;dp instanceof rs?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:dp})),t=!1):dp instanceof $l||(this.fullReconnectOnNext=!0),t?this.handleDisconnect("reconnect",ki.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Xa.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(dp){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:dp}))}return null}restartConnection(e){return Ro(this,void 0,void 0,function*(){var t,n,i;try{if(!this.url||!this.token)throw new rs("could not reconnect, url or token not saved");let n;this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Xa.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new $l;n=yield this.join(null!==e&&void 0!==e?e:this.url,this.token,this.signalOpts)}catch(dp){if(dp instanceof es&&dp.reason===Ga.NotAllowed)throw new rs("could not reconnect, token might be expired");throw new $l}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Xa.SignalRestarted,n),yield this.waitForPCReconnected(),this.client.currentState!==Bc.CONNECTED)throw new $l("Signal connection got severed during reconnect");null===(t=this.regionUrlProvider)||void 0===t||t.resetAttempts(),this.emit(Xa.Restarted)}catch(r){const e=yield null===(n=this.regionUrlProvider)||void 0===n?void 0:n.getNextBestRegionUrl();if(e)return void(yield this.restartConnection(e));throw null===(i=this.regionUrlProvider)||void 0===i||i.resetAttempts(),r}})}resumeConnection(e){return Ro(this,void 0,void 0,function*(){var t;if(!this.url||!this.token)throw new rs("could not reconnect, url or token not saved");if(!this.pcManager)throw new rs("publisher and subscriber connections unset");let n;this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Xa.Resuming);try{this.setupSignalClientCallbacks(),n=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(i){let e="";if(i instanceof Error&&(e=i.message,this.log.error(i.message,Object.assign(Object.assign({},this.logContext),{error:i}))),i instanceof es&&i.reason===Ga.NotAllowed)throw new rs("could not reconnect, token might be expired");if(i instanceof es&&i.reason===Ga.LeaveRequest)throw i;throw new $l(e)}if(this.emit(Xa.SignalResumed),n){const e=this.makeRTCConfiguration(n);this.pcManager.updateConfiguration(e),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=n.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Bc.CONNECTED)throw new $l("Signal connection got severed during reconnect");this.client.setReconnected(),"open"===(null===(t=this.reliableDC)||void 0===t?void 0:t.readyState)&&null===this.reliableDC.id&&this.createDataChannels(),(null===n||void 0===n?void 0:n.lastMessageSeq)&&this.resendReliableMessagesForResume(n.lastMessageSeq),this.emit(Xa.Resumed)})}waitForPCInitialConnection(e,t){return Ro(this,void 0,void 0,function*(){if(!this.pcManager)throw new rs("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return Ro(this,void 0,void 0,function*(){this.pcState=Jl.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Is(2e3),!this.pcManager)throw new rs("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Jl.Connected}catch(dp){throw this.pcState=Jl.Disconnected,new es("could not establish PC connection, ".concat(dp.message),Ga.InternalError)}})}publishRpcResponse(e,t,n,i){return Ro(this,void 0,void 0,function*(){const r=new Ai({destinationIdentities:[e],kind:Li.RELIABLE,value:{case:"rpcResponse",value:new Ji({requestId:t,value:i?{case:"error",value:i.toProto()}:{case:"payload",value:null!==n&&void 0!==n?n:""}})}});yield this.sendDataPacket(r,Li.RELIABLE)})}publishRpcAck(e,t){return Ro(this,void 0,void 0,function*(){const n=new Ai({destinationIdentities:[e],kind:Li.RELIABLE,value:{case:"rpcAck",value:new Ki({requestId:t})}});yield this.sendDataPacket(n,Li.RELIABLE)})}sendDataPacket(e,t){return Ro(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(t),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const t=function(e){var t,n,i,r,o;if("sipDtmf"!==(null===(t=e.value)||void 0===t?void 0:t.case)&&"metrics"!==(null===(n=e.value)||void 0===n?void 0:n.case)&&"speaker"!==(null===(i=e.value)||void 0===i?void 0:i.case)&&"transcription"!==(null===(r=e.value)||void 0===r?void 0:r.case)&&"encryptedPacket"!==(null===(o=e.value)||void 0===o?void 0:o.case))return new ji({value:e.value})}(e);if(t){const n=yield this.e2eeManager.encryptData(t.toBinary());e.value={case:"encryptedPacket",value:new Ui({encryptedValue:n.payload,iv:n.iv,keyIndex:n.keyIndex})}}}t===Li.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const n=e.toBinary(),i=this.dataChannelForKind(t);if(i){if(t===Li.RELIABLE&&this.reliableMessageBuffer.push({data:n,sequence:e.sequence}),this.attemptingReconnect)return;i.send(n)}this.updateAndEmitDCBufferStatus(t)})}resendReliableMessagesForResume(e){return Ro(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(Li.RELIABLE);const t=this.dataChannelForKind(Li.RELIABLE);t&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(e=>{t.send(e.data)})),this.updateAndEmitDCBufferStatus(Li.RELIABLE)})}waitForBufferStatusLow(e){return new Promise((t,n)=>Ro(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))t();else{const i=()=>n("Engine closed");for(this.once(Xa.Closing,i);!this.dcBufferStatus.get(e);)yield Is(10);this.off(Xa.Closing,i),t()}}))}ensureDataTransportConnected(e){return Ro(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.subscriberPrimary;return function*(){var i;if(!t.pcManager)throw new rs("PC manager is closed");const r=n?t.pcManager.subscriber:t.pcManager.publisher,o=n?"Subscriber":"Publisher";if(!r)throw new es("".concat(o," connection not set"),Ga.InternalError);let a=!1;n||t.dataChannelForKind(e,n)||(t.createDataChannels(),a=!0),a||n||t.pcManager.publisher.isICEConnected||"checking"===t.pcManager.publisher.getICEConnectionState()||(a=!0),a&&t.negotiate().catch(e=>{So.error(e,t.logContext)});const s=t.dataChannelForKind(e,n);if("open"===(null===s||void 0===s?void 0:s.readyState))return;const c=(new Date).getTime()+t.peerConnectionTimeout;for(;(new Date).getTime()<c;){if(r.isICEConnected&&"open"===(null===(i=t.dataChannelForKind(e,n))||void 0===i?void 0:i.readyState))return;yield Is(50)}throw new es("could not establish ".concat(o," connection, state: ").concat(r.getICEConnectionState()),Ga.InternalError)}()})}ensurePublisherConnected(e){return Ro(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!!this.pcManager&&(this.pcManager.currentState===yl.CONNECTED&&!(!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED))}negotiate(){return Ro(this,void 0,void 0,function*(){return new Promise((e,t)=>Ro(this,void 0,void 0,function*(){if(!this.pcManager)return void t(new os("PC manager is closed"));this.pcManager.requirePublisher(),0!=this.pcManager.publisher.getTransceivers().length||this.lossyDC||this.reliableDC||this.createDataChannels();const n=new AbortController,i=()=>{n.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(Xa.Closing,i),this.pcManager.publisher.once(sl,e=>{const t=new Map;e.forEach(e=>{const n=e.codec.toLowerCase();var i;i=n,ws.includes(i)&&t.set(e.payload,n)}),this.emit(Xa.RTPVideoMapUpdate,t)});try{yield this.pcManager.negotiate(n),e()}catch(dp){dp instanceof os&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",ki.RR_UNKNOWN),t(dp)}finally{this.off(Xa.Closing,i)}}))})}dataChannelForKind(e,t){if(t){if(e===Li.LOSSY)return this.lossyDCSub;if(e===Li.RELIABLE)return this.reliableDCSub}else{if(e===Li.LOSSY)return this.lossyDC;if(e===Li.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var n,i,r,o;if(!this.pcManager)return void this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);const a=this.pcManager.publisher.getLocalDescription(),s=this.pcManager.publisher.getRemoteDescription(),c=null===(n=this.pcManager.subscriber)||void 0===n?void 0:n.getRemoteDescription(),l=null===(i=this.pcManager.subscriber)||void 0===i?void 0:i.getLocalDescription(),u=null===(o=null===(r=this.signalOpts)||void 0===r?void 0:r.autoSubscribe)||void 0===o||o,d=new Array,h=new Array;e.forEach(e=>{e.isDesired!==u&&d.push(e.trackSid),e.isEnabled||h.push(e.trackSid)}),this.client.sendSyncState(new $r({answer:this.options.singlePeerConnection?s?qc({sdp:s.sdp,type:s.type}):void 0:l?qc({sdp:l.sdp,type:l.type}):void 0,offer:this.options.singlePeerConnection?a?qc({sdp:a.sdp,type:a.type}):void 0:c?qc({sdp:c.sdp,type:c.type}):void 0,subscription:new Rr({trackSids:d,subscribe:!u,participantTracks:[]}),publishTracks:Rc(t),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:h,datachannelReceiveStates:this.reliableReceivedState.map((e,t)=>new Yr({publisherSid:t,lastSeq:e}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(t,n)=>{void 0!==(null===t||void 0===t?void 0:t.id)&&null!==t.id&&e.push(new Xr({label:t.label,id:t.id,target:n}))};return t(this.dataChannelForKind(Li.LOSSY),hr.PUBLISHER),t(this.dataChannelForKind(Li.RELIABLE),hr.PUBLISHER),t(this.dataChannelForKind(Li.LOSSY,!0),hr.SUBSCRIBER),t(this.dataChannelForKind(Li.RELIABLE,!0),hr.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&ms.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Vs()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Vs()&&window.removeEventListener("online",this.handleBrowserOnLine)}getTrackIdForReceiver(e){var t;const n=null===(t=this.pcManager)||void 0===t?void 0:t.getMidForReceiver(e);if(n){const e=Object.entries(this.midToTrackId).find(e=>{let[t]=e;return t===n});if(e)return e[1]}}}class $l extends Error{}function Yl(e,t){const n=e.participantIdentity?e.participantIdentity:t.participantIdentity;e.participantIdentity=n,t.participantIdentity=n;const i=0!==e.destinationIdentities.length?e.destinationIdentities:t.destinationIdentities;e.destinationIdentities=i,t.destinationIdentities=i}class Xl{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return Hs(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return Ro(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter(e=>!this.attemptedRegions.find(t=>t.url===e.url));if(t.length>0){const e=t[0];return this.attemptedRegions.push(e),So.debug("next region: ".concat(e.region)),e.url}return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return Ro(this,void 0,void 0,function*(){const t=yield fetch("".concat((n=this.serverUrl,"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});var n;if(t.ok){const e=yield t.json();return this.lastUpdateAt=Date.now(),e}throw new es("Could not fetch region settings: ".concat(t.statusText),401===t.status?Ga.NotAllowed:Ga.InternalError,t.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}class Zl{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("number"===typeof this.totalByteSize&&0!==this.totalByteSize){if(e&&this.bytesReceived<this.totalByteSize)throw new cs("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),Ka.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new cs("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),Ka.LengthExceeded)}}constructor(e,t,n,i){this.reader=t,this.totalByteSize=n,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=i}}class eu extends Zl{handleChunkReceived(e){var t;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const n=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null===(t=this.onProgress)||void 0===t||t.call(this,n)}[Symbol.asyncIterator](){const e=this.reader.getReader();let t=new rc,n=null,i=null;if(this.signal){const e=this.signal;i=()=>{var n;null===(n=t.reject)||void 0===n||n.call(t,e.reason)},e.addEventListener("abort",i),n=e}const r=()=>{e.releaseLock(),n&&i&&n.removeEventListener("abort",i),this.signal=void 0};return{next:()=>Ro(this,void 0,void 0,function*(){var n,i;try{const{done:r,value:o}=yield Promise.race([e.read(),t.promise,null!==(i=null===(n=this.outOfBandFailureRejectingFuture)||void 0===n?void 0:n.promise)&&void 0!==i?i:new Promise(()=>{})]);return r?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(o),{done:!1,value:o.content})}catch(o){throw r(),o}}),return(){return Ro(this,void 0,void 0,function*(){return r(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return Ro(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){var n,i,r,o;let a=new Set;const s=t.signal?e.withAbortSignal(t.signal):e;try{for(var c,l=!0,u=Oo(s);!(n=(c=yield u.next()).done);l=!0){o=c.value,l=!1;const e=o;a.add(e)}}catch(d){i={error:d}}finally{try{l||n||!(r=u.return)||(yield r.call(u))}finally{if(i)throw i.error}}return Array.from(a)}()})}}class tu extends Zl{constructor(e,t,n,i){super(e,t,n,i),this.receivedChunks=new Map}handleChunkReceived(e){var t;const n=cc(e.chunkIndex),i=this.receivedChunks.get(n);if(i&&i.version>e.version)return;this.receivedChunks.set(n,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null===(t=this.onProgress)||void 0===t||t.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader(),t=new TextDecoder("utf-8",{fatal:!0});let n=new rc,i=null,r=null;if(this.signal){const e=this.signal;r=()=>{var t;null===(t=n.reject)||void 0===t||t.call(n,e.reason)},e.addEventListener("abort",r),i=e}const o=()=>{e.releaseLock(),i&&r&&i.removeEventListener("abort",r),this.signal=void 0};return{next:()=>Ro(this,void 0,void 0,function*(){var i,r;try{const{done:o,value:s}=yield Promise.race([e.read(),n.promise,null!==(r=null===(i=this.outOfBandFailureRejectingFuture)||void 0===i?void 0:i.promise)&&void 0!==r?r:new Promise(()=>{})]);if(o)return this.validateBytesReceived(!0),{done:!0,value:void 0};{let e;this.handleChunkReceived(s);try{e=t.decode(s.content)}catch(a){throw new cs("Cannot decode datastream chunk ".concat(s.chunkIndex," as text: ").concat(a),Ka.DecodeFailed)}return{done:!1,value:e}}}catch(a){throw o(),a}}),return(){return Ro(this,void 0,void 0,function*(){return o(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return Ro(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){var n,i,r,o;let a="";const s=t.signal?e.withAbortSignal(t.signal):e;try{for(var c,l=!0,u=Oo(s);!(n=(c=yield u.next()).done);l=!0){o=c.value,l=!1;a+=o}}catch(d){i={error:d}}finally{try{l||n||!(r=u.return)||(yield r.call(u))}finally{if(i)throw i.error}}return a}()})}}class nu{constructor(){this.log=So,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,t){if(this.textStreamHandlers.has(e))throw new cs('A text stream handler for topic "'.concat(e,'" has already been set.'),Ka.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,t)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,t){if(this.byteStreamHandlers.has(e))throw new cs('A byte stream handler for topic "'.concat(e,'" has already been set.'),Ka.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,t)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearHandlersAndControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear(),this.byteStreamHandlers.clear(),this.textStreamHandlers.clear()}validateParticipantHasNoActiveDataStreams(e){var t,n,i,r;const o=Array.from(this.textStreamControllers.entries()).filter(t=>t[1].sendingParticipantIdentity===e),a=Array.from(this.byteStreamControllers.entries()).filter(t=>t[1].sendingParticipantIdentity===e);if(o.length>0||a.length>0){const s=new cs("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),Ka.AbnormalEnd);for(const[e,i]of a)null===(n=(t=i.outOfBandFailureRejectingFuture).reject)||void 0===n||n.call(t,s),this.byteStreamControllers.delete(e);for(const[e,t]of o)null===(r=(i=t.outOfBandFailureRejectingFuture).reject)||void 0===r||r.call(i,s),this.textStreamControllers.delete(e)}}handleDataStreamPacket(e,t){return Ro(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,t);case"streamChunk":return this.handleStreamChunk(e.value.value,t);case"streamTrailer":return this.handleStreamTrailer(e.value.value,t);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,t,n){return Ro(this,void 0,void 0,function*(){var i;if("byteHeader"===e.contentHeader.case){const r=this.byteStreamHandlers.get(e.topic);if(!r)return void this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);let o;const a=new rc;a.promise.catch(e=>{this.log.error(e)});const s={id:e.streamId,name:null!==(i=e.contentHeader.value.name)&&void 0!==i?i:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:cc(e.timestamp),attributes:e.attributes,encryptionType:n},c=new ReadableStream({start:n=>{if(o=n,this.textStreamControllers.has(e.streamId))throw new cs("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Ka.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:s,controller:o,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:a})}});r(new eu(s,c,cc(e.totalLength),a),{identity:t})}else if("textHeader"===e.contentHeader.case){const i=this.textStreamHandlers.get(e.topic);if(!i)return void this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);let r;const o=new rc;o.promise.catch(e=>{this.log.error(e)});const a={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:n},s=new ReadableStream({start:n=>{if(r=n,this.textStreamControllers.has(e.streamId))throw new cs("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Ka.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:a,controller:r,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:o})}});i(new tu(a,s,cc(e.totalLength),o),{identity:t})}})}handleStreamChunk(e,t){const n=this.byteStreamControllers.get(e.streamId);n&&(n.info.encryptionType!==t?(n.controller.error(new cs("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(n.info.encryptionType),Ka.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&n.controller.enqueue(e));const i=this.textStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==t?(i.controller.error(new cs("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(i.info.encryptionType),Ka.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&i.controller.enqueue(e))}handleStreamTrailer(e,t){const n=this.textStreamControllers.get(e.streamId);n&&(n.info.encryptionType!==t?n.controller.error(new cs("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(n.info.encryptionType),Ka.EncryptionTypeMismatch)):(n.info.attributes=Object.assign(Object.assign({},n.info.attributes),e.attributes),n.controller.close(),this.textStreamControllers.delete(e.streamId)));const i=this.byteStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==t?i.controller.error(new cs("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(i.info.encryptionType),Ka.EncryptionTypeMismatch)):(i.info.attributes=Object.assign(Object.assign({},i.info.attributes),e.attributes),i.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class iu{constructor(e,t,n){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=n,this.info=t}write(e){return this.defaultWriter.write(e)}close(){return Ro(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),null===(e=this.onClose)||void 0===e||e.call(this)})}}class ru extends iu{}class ou extends iu{}class au{constructor(e,t){this.engine=e,this.log=t}setupEngine(e){this.engine=e}sendText(e,t){return Ro(this,void 0,void 0,function*(){var n;const i=crypto.randomUUID(),r=(new TextEncoder).encode(e).byteLength,o=null===(n=null===t||void 0===t?void 0:t.attachments)||void 0===n?void 0:n.map(()=>crypto.randomUUID()),a=new Array(o?o.length+1:1).fill(0),s=(e,n)=>{var i;a[n]=e;const r=a.reduce((e,t)=>e+t,0);null===(i=null===t||void 0===t?void 0:t.onProgress)||void 0===i||i.call(t,r)},c=yield this.streamText({streamId:i,totalSize:r,destinationIdentities:null===t||void 0===t?void 0:t.destinationIdentities,topic:null===t||void 0===t?void 0:t.topic,attachedStreamIds:o,attributes:null===t||void 0===t?void 0:t.attributes});return yield c.write(e),s(1,0),yield c.close(),(null===t||void 0===t?void 0:t.attachments)&&o&&(yield Promise.all(t.attachments.map((e,n)=>Ro(this,void 0,void 0,function*(){return this._sendFile(o[n],e,{topic:t.topic,mimeType:e.type,onProgress:e=>{s(e,n+1)}})})))),c.info})}streamText(e){return Ro(this,void 0,void 0,function*(){var t,n,i;const r=null!==(t=null===e||void 0===e?void 0:e.streamId)&&void 0!==t?t:crypto.randomUUID(),o={id:r,mimeType:"text/plain",timestamp:Date.now(),topic:null!==(n=null===e||void 0===e?void 0:e.topic)&&void 0!==n?n:"",size:null===e||void 0===e?void 0:e.totalSize,attributes:null===e||void 0===e?void 0:e.attributes,encryptionType:(null===(i=this.engine.e2eeManager)||void 0===i?void 0:i.isDataChannelEncryptionEnabled)?_i.GCM:_i.NONE},a=new cr({streamId:r,mimeType:o.mimeType,topic:o.topic,timestamp:lc(o.timestamp),totalLength:lc(null===e||void 0===e?void 0:e.totalSize),attributes:o.attributes,contentHeader:{case:"textHeader",value:new ar({version:null===e||void 0===e?void 0:e.version,attachedStreamIds:null===e||void 0===e?void 0:e.attachedStreamIds,replyToStreamId:null===e||void 0===e?void 0:e.replyToStreamId,operationType:"update"===(null===e||void 0===e?void 0:e.type)?or.UPDATE:or.CREATE})}}),s=null===e||void 0===e?void 0:e.destinationIdentities,c=new Ai({destinationIdentities:s,value:{case:"streamHeader",value:a}});yield this.engine.sendDataPacket(c,Li.RELIABLE);let l=0;const u=this.engine,d=new WritableStream({write(e){return Ro(this,void 0,void 0,function*(){for(const t of function(e,t){const n=[];let i=(new TextEncoder).encode(e);for(;i.length>t;){let e=t;for(;e>0;){const t=i[e];if(void 0!==t&&128!==(192&t))break;e--}n.push(i.slice(0,e)),i=i.slice(e)}return i.length>0&&n.push(i),n}(e,15e3)){yield u.waitForBufferStatusLow(Li.RELIABLE);const e=new lr({content:t,streamId:r,chunkIndex:lc(l)}),n=new Ai({destinationIdentities:s,value:{case:"streamChunk",value:e}});yield u.sendDataPacket(n,Li.RELIABLE),l+=1}})},close(){return Ro(this,void 0,void 0,function*(){const e=new ur({streamId:r}),t=new Ai({destinationIdentities:s,value:{case:"streamTrailer",value:e}});yield u.sendDataPacket(t,Li.RELIABLE)})},abort(e){console.log("Sink error:",e)}});let h=()=>Ro(this,void 0,void 0,function*(){yield p.close()});u.once(Xa.Closing,h);const p=new ru(d,o,()=>this.engine.off(Xa.Closing,h));return p})}sendFile(e,t){return Ro(this,void 0,void 0,function*(){const n=crypto.randomUUID();return yield this._sendFile(n,e,t),{id:n}})}_sendFile(e,t,n){return Ro(this,void 0,void 0,function*(){var i;const r=yield this.streamBytes({streamId:e,totalSize:t.size,name:t.name,mimeType:null!==(i=null===n||void 0===n?void 0:n.mimeType)&&void 0!==i?i:t.type,topic:null===n||void 0===n?void 0:n.topic,destinationIdentities:null===n||void 0===n?void 0:n.destinationIdentities}),o=t.stream().getReader();for(;;){const{done:e,value:t}=yield o.read();if(e)break;yield r.write(t)}return yield r.close(),r.info})}streamBytes(e){return Ro(this,void 0,void 0,function*(){var t,n,i,r,o,a;const s=null!==(t=null===e||void 0===e?void 0:e.streamId)&&void 0!==t?t:crypto.randomUUID(),c=null===e||void 0===e?void 0:e.destinationIdentities,l={id:s,mimeType:null!==(n=null===e||void 0===e?void 0:e.mimeType)&&void 0!==n?n:"application/octet-stream",topic:null!==(i=null===e||void 0===e?void 0:e.topic)&&void 0!==i?i:"",timestamp:Date.now(),attributes:null===e||void 0===e?void 0:e.attributes,size:null===e||void 0===e?void 0:e.totalSize,name:null!==(r=null===e||void 0===e?void 0:e.name)&&void 0!==r?r:"unknown",encryptionType:(null===(o=this.engine.e2eeManager)||void 0===o?void 0:o.isDataChannelEncryptionEnabled)?_i.GCM:_i.NONE},u=new cr({totalLength:lc(null!==(a=l.size)&&void 0!==a?a:0),mimeType:l.mimeType,streamId:s,topic:l.topic,timestamp:lc(Date.now()),attributes:l.attributes,contentHeader:{case:"byteHeader",value:new sr({name:l.name})}}),d=new Ai({destinationIdentities:c,value:{case:"streamHeader",value:u}});yield this.engine.sendDataPacket(d,Li.RELIABLE);let h=0;const p=new xt,f=this.engine,m=this.log,g=new WritableStream({write(e){return Ro(this,void 0,void 0,function*(){const t=yield p.lock();let n=0;try{for(;n<e.byteLength;){const t=e.slice(n,n+15e3);yield f.waitForBufferStatusLow(Li.RELIABLE);const i=new Ai({destinationIdentities:c,value:{case:"streamChunk",value:new lr({content:t,streamId:s,chunkIndex:lc(h)})}});yield f.sendDataPacket(i,Li.RELIABLE),h+=1,n+=t.byteLength}}finally{t()}})},close(){return Ro(this,void 0,void 0,function*(){const e=new ur({streamId:s}),t=new Ai({destinationIdentities:c,value:{case:"streamTrailer",value:e}});yield f.sendDataPacket(t,Li.RELIABLE)})},abort(e){m.error("Sink error:",e)}});return new ou(g,l)})}}class su extends ys{constructor(e,t,n,i,r){super(e,n,r),this.sid=t,this.receiver=i}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?Za.Muted:Za.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=n=>{n.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(Za.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return Ro(this,void 0,void 0,function*(){var e;if(!(null===(e=this.receiver)||void 0===e?void 0:e.getStats))return;return yield this.receiver.getStats()})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),wl)),"undefined"!==typeof RTCRtpReceiver&&"getSynchronizationSources"in RTCRtpReceiver&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var t;this.timeSyncHandle=requestAnimationFrame(()=>e());const n=null===(t=this.receiver)||void 0===t?void 0:t.getSynchronizationSources()[0];if(n){const{timestamp:e,rtpTimestamp:t}=n;t&&this.rtpTimestamp!==t&&(this.emit(Za.TimeSyncUpdate,{timestamp:e,rtpTimestamp:t}),this.rtpTimestamp=t)}};e()}}class cu extends su{constructor(e,t,n,i,r,o){super(e,t,ys.Kind.Audio,n,o),this.monitorReceiver=()=>Ro(this,void 0,void 0,function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=Cl(e,this.prevStats)),this.prevStats=e}),this.audioContext=i,this.webAudioPluginNodes=[],r&&(this.sinkId=r.deviceId)}setVolume(e){var t;for(const n of this.attachedElements)this.audioContext?null===(t=this.gainNode)||void 0===t||t.gain.setTargetAtTime(e,0,.1):n.volume=e;qs()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(qs())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return Ro(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(As(t))return t.setSinkId(e)}))})}attach(e){const t=0===this.attachedElements.length;return e?super.attach(e):e=super.attach(),this.sinkId&&As(e)&&e.setSinkId(this.sinkId).catch(e=>{this.log.error("Failed to set sink id on remote audio track",e,this.logContext)}),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let n=this.sourceNode;this.webAudioPluginNodes.forEach(e=>{n.connect(e),n=e}),this.gainNode=e.createGain(),n.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),"running"!==e.state&&e.resume().then(()=>{"running"!==e.state&&this.emit(Za.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(e=>{this.emit(Za.AudioPlaybackFailed,e)})}disconnectWebAudio(){var e,t;null===(e=this.gainNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return Ro(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;let e;return(yield this.receiver.getStats()).forEach(t=>{"inbound-rtp"===t.type&&(e={type:"audio",streamId:t.id,timestamp:t.timestamp,jitter:t.jitter,bytesReceived:t.bytesReceived,concealedSamples:t.concealedSamples,concealmentEvents:t.concealmentEvents,silentConcealedSamples:t.silentConcealedSamples,silentConcealmentEvents:t.silentConcealmentEvents,totalAudioEnergy:t.totalAudioEnergy,totalSamplesDuration:t.totalSamplesDuration})}),e})}}class lu extends su{constructor(e,t,n,i,r){super(e,t,ys.Kind.Video,n,r),this.elementInfos=[],this.monitorReceiver=()=>Ro(this,void 0,void 0,function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=Cl(e,this.prevStats)),this.prevStats=e}),this.debouncedHandleResize=rl(()=>{this.updateDimensions()},100),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return void 0!==this.adaptiveStreamSettings}setStreamState(e){super.setStreamState(e),console.log("setStreamState",e),e===ys.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?ks(this._mediaStreamTrack,t):bs(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&void 0===this.elementInfos.find(t=>t.element===e)){const t=new uu(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&void 0===this.elementInfos.find(t=>t===e)?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream)return void this.log.warn("stopObservingElementInfo ignored",this.logContext);const t=this.elementInfos.filter(t=>t===e);for(const n of t)n.stopObserving();this.elementInfos=this.elementInfos.filter(t=>t!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const n of t)this.stopObservingElement(n);return t}getDecoderImplementation(){var e;return null===(e=this.prevStats)||void 0===e?void 0:e.decoderImplementation}getReceiverStats(){return Ro(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,n="",i=new Map;return e.forEach(e=>{"inbound-rtp"===e.type?(n=e.codecId,t={type:"video",streamId:e.id,framesDecoded:e.framesDecoded,framesDropped:e.framesDropped,framesReceived:e.framesReceived,packetsReceived:e.packetsReceived,packetsLost:e.packetsLost,frameWidth:e.frameWidth,frameHeight:e.frameHeight,pliCount:e.pliCount,firCount:e.firCount,nackCount:e.nackCount,jitter:e.jitter,timestamp:e.timestamp,bytesReceived:e.bytesReceived,decoderImplementation:e.decoderImplementation}):"codec"===e.type&&i.set(e.id,e)}),t&&""!==n&&i.get(n)&&(t.mimeType=i.get(n).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(t=>t.element===e);for(const n of t)this.stopObservingElementInfo(n)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Ro(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var t,n;const i=this.elementInfos.reduce((e,t)=>Math.max(e,t.visibilityChangedAt||0),0),r=!(null!==(n=null===(t=this.adaptiveStreamSettings)||void 0===t?void 0:t.pauseVideoInBackground)&&void 0!==n&&!n)&&this.isInBackground,o=this.elementInfos.some(e=>e.pictureInPicture),a=this.elementInfos.some(e=>e.visible)&&!r||o;(this.lastVisible!==a||e)&&(!a&&Date.now()-i<100?ms.setTimeout(()=>{this.updateVisibility()},100):(this.lastVisible=a,this.emit(Za.VisibilityChanged,a,this)))}updateDimensions(){var e,t;let n=0,i=0;const r=this.getPixelDensity();for(const o of this.elementInfos){const e=o.width()*r,t=o.height()*r;e+t>n+i&&(n=e,i=t)}(null===(e=this.lastDimensions)||void 0===e?void 0:e.width)===n&&(null===(t=this.lastDimensions)||void 0===t?void 0:t.height)===i||(this.lastDimensions={width:n,height:i},this.emit(Za.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pixelDensity;if("screen"===t)return Ks();if(!t){return Ks()>2?2:1}return t}}class uu{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=e=>{var t;const{target:n,isIntersecting:i}=e;n===this.element&&(this.isIntersecting=i,this.isPiP=du(this.element),this.visibilityChangedAt=Date.now(),null===(t=this.handleVisibilityChanged)||void 0===t||t.call(this))},this.onEnterPiP=()=>{var e,t,n;null===(t=null===(e=window.documentPictureInPicture)||void 0===e?void 0:e.window)||void 0===t||t.addEventListener("pagehide",this.onLeavePiP),this.isPiP=du(this.element),null===(n=this.handleVisibilityChanged)||void 0===n||n.call(this)},this.onLeavePiP=()=>{var e;this.isPiP=du(this.element),null===(e=this.handleVisibilityChanged)||void 0===e||e.call(this)},this.element=e,this.isIntersecting=null!==t&&void 0!==t?t:hu(e),this.isPiP=Vs()&&du(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,t,n;this.isIntersecting=hu(this.element),this.isPiP=du(this.element),this.element.handleResize=()=>{var e;null===(e=this.handleResize)||void 0===e||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,ec().observe(this.element),Xs().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),null===(e=window.documentPictureInPicture)||void 0===e||e.addEventListener("enter",this.onEnterPiP),null===(n=null===(t=window.documentPictureInPicture)||void 0===t?void 0:t.window)||void 0===n||n.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,t,n,i,r;null===(e=ec())||void 0===e||e.unobserve(this.element),null===(t=Xs())||void 0===t||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),null===(n=window.documentPictureInPicture)||void 0===n||n.removeEventListener("enter",this.onEnterPiP),null===(r=null===(i=window.documentPictureInPicture)||void 0===i?void 0:i.window)||void 0===r||r.removeEventListener("pagehide",this.onLeavePiP)}}function du(e){var t,n;return document.pictureInPictureElement===e||!!(null===(t=window.documentPictureInPicture)||void 0===t?void 0:t.window)&&hu(e,null===(n=window.documentPictureInPicture)||void 0===n?void 0:n.window)}function hu(e,t){const n=t||window;let i=e.offsetTop,r=e.offsetLeft;const o=e.offsetWidth,a=e.offsetHeight,{hidden:s}=e,{display:c}=getComputedStyle(e);for(;e.offsetParent;)i+=(e=e.offsetParent).offsetTop,r+=e.offsetLeft;return i<n.pageYOffset+n.innerHeight&&r<n.pageXOffset+n.innerWidth&&i+a>n.pageYOffset&&r+o>n.pageXOffset&&!s&&"none"!==c}class pu extends No.EventEmitter{constructor(e,t,n,i){var r;super(),this.metadataMuted=!1,this.encryption=_i.NONE,this.log=So,this.handleMuted=()=>{this.emit(Za.Muted)},this.handleUnmuted=()=>{this.emit(Za.Unmuted)},this.log=To(null!==(r=null===i||void 0===i?void 0:i.loggerName)&&void 0!==r?r:bo.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=n,this.source=ys.Source.Unknown}setTrack(e){this.track&&(this.track.off(Za.Muted,this.handleMuted),this.track.off(Za.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(Za.Muted,this.handleMuted),e.on(Za.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),xc(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get isEncrypted(){return this.encryption!==_i.NONE}get audioTrack(){if(dc(this.track))return this.track}get videoTrack(){if(hc(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=ys.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===ys.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}!function(e){var t,n;(t=e.SubscriptionStatus||(e.SubscriptionStatus={})).Desired="desired",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",(n=e.PermissionStatus||(e.PermissionStatus={})).Allowed="allowed",n.NotAllowed="not_allowed"}(pu||(pu={}));class fu extends pu{get isUpstreamPaused(){var e;return null===(e=this.track)||void 0===e?void 0:e.isUpstreamPaused}constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(Za.Ended)},this.handleCpuConstrained=()=>{this.track&&hc(this.track)&&this.emit(Za.CpuConstrained,this.track)},this.updateInfo(t),this.setTrack(n)}setTrack(e){this.track&&(this.track.off(Za.Ended,this.handleTrackEnded),this.track.off(Za.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(Za.Ended,this.handleTrackEnded),e.on(Za.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return Ro(this,void 0,void 0,function*(){var e;return null===(e=this.track)||void 0===e?void 0:e.mute()})}unmute(){return Ro(this,void 0,void 0,function*(){var e;return null===(e=this.track)||void 0===e?void 0:e.unmute()})}pauseUpstream(){return Ro(this,void 0,void 0,function*(){var e;yield null===(e=this.track)||void 0===e?void 0:e.pauseUpstream()})}resumeUpstream(){return Ro(this,void 0,void 0,function*(){var e;yield null===(e=this.track)||void 0===e?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(dc(this.track)){const t=this.track.getSourceTrackSettings(),n=new Set;return t.autoGainControl&&n.add(Ti.TF_AUTO_GAIN_CONTROL),t.echoCancellation&&n.add(Ti.TF_ECHO_CANCELLATION),t.noiseSuppression&&n.add(Ti.TF_NOISE_SUPPRESSION),t.channelCount&&t.channelCount>1&&n.add(Ti.TF_STEREO),(null===(e=this.options)||void 0===e?void 0:e.dtx)||n.add(Ti.TF_NO_DTX),this.track.enhancedNoiseCancellation&&n.add(Ti.TF_ENHANCED_NOISE_CANCELLATION),Array.from(n.values())}return[]}}function mu(e,t){return Ro(this,void 0,void 0,function*(){null!==e&&void 0!==e||(e={});let n=!1;const{audioProcessor:i,videoProcessor:r,optionsWithoutProcessor:o}=Oc(e);let a=o.audio,s=o.video;if(i&&"object"===typeof o.audio&&(o.audio.processor=i),r&&"object"===typeof o.video&&(o.video.processor=r),e.audio&&"object"===typeof o.audio&&"string"===typeof o.audio.deviceId){const e=o.audio.deviceId;o.audio.deviceId={exact:e},n=!0,a=Object.assign(Object.assign({},o.audio),{deviceId:{ideal:e}})}if(o.video&&"object"===typeof o.video&&"string"===typeof o.video.deviceId){const e=o.video.deviceId;o.video.deviceId={exact:e},n=!0,s=Object.assign(Object.assign({},o.video),{deviceId:{ideal:e}})}(!0===o.audio||"object"===typeof o.audio&&!o.audio.deviceId)&&(o.audio={deviceId:"default"}),!0===o.video?o.video={deviceId:"default"}:"object"!==typeof o.video||o.video.deviceId||(o.video.deviceId="default");const c=yc(o,fl,ml),l=kc(c),u=navigator.mediaDevices.getUserMedia(l);o.audio&&(Dc.userMediaPromiseMap.set("audioinput",u),u.catch(()=>Dc.userMediaPromiseMap.delete("audioinput"))),o.video&&(Dc.userMediaPromiseMap.set("videoinput",u),u.catch(()=>Dc.userMediaPromiseMap.delete("videoinput")));try{const e=yield u;return yield Promise.all(e.getTracks().map(n=>Ro(this,void 0,void 0,function*(){const o="audio"===n.kind;let a,s=o?c.audio:c.video;"boolean"!==typeof s&&s||(s={});const u=o?l.audio:l.video;"boolean"!==typeof u&&(a=u);const d=n.getSettings().deviceId;(null===a||void 0===a?void 0:a.deviceId)&&oc(a.deviceId)!==d?a.deviceId=d:a||(a={deviceId:d});const h=function(e,t,n){switch(e.kind){case"audio":return new Ol(e,t,!1,void 0,n);case"video":return new zl(e,t,!1,n);default:throw new ns("unsupported track type: ".concat(e.kind))}}(n,a,t);return h.kind===ys.Kind.Video?h.source=ys.Source.Camera:h.kind===ys.Kind.Audio&&(h.source=ys.Source.Microphone),h.mediaStream=e,dc(h)&&i?yield h.setProcessor(i):hc(h)&&r&&(yield h.setProcessor(r)),h})))}catch(dp){if(!n)throw dp;return mu(Object.assign(Object.assign({},e),{audio:a,video:s}),t)}})}var gu,vu;!function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Lost="lost",e.Unknown="unknown"}(gu||(gu={}));class yu extends No.EventEmitter{get logContext(){var e,t;return Object.assign({},null===(t=null===(e=this.loggerOptions)||void 0===e?void 0:e.loggerContextCb)||void 0===t?void 0:t.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return(null===(e=this.permissions)||void 0===e?void 0:e.agent)||this.kind===xi.AGENT}get isActive(){var e;return(null===(e=this.participantInfo)||void 0===e?void 0:e.state)===Ri.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,t,n,i,r,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:xi.STANDARD;var s;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=gu.Unknown,this.log=So,this.log=To(null!==(s=null===o||void 0===o?void 0:o.loggerName)&&void 0!==s?s:bo.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=n,this.metadata=i,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=a,this._attributes=null!==r&&void 0!==r?r:{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,t]of this.trackPublications)if(t.source===e)return t}getTrackPublicationByName(e){for(const[,t]of this.trackPublications)if(t.trackName===e)return t}waitUntilActive(){return this.isActive?Promise.resolve():(this.activeFuture||(this.activeFuture=new rc,this.once(Ya.Active,()=>{var e,t;null===(t=null===(e=this.activeFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.activeFuture=void 0})),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrackPublication(ys.Source.Camera);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isMicrophoneEnabled(){var e;const t=this.getTrackPublication(ys.Source.Microphone);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(ys.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(1e3*Number.parseInt(this.participantInfo.joinedAt.toString())):new Date}updateInfo(e){var t;return!(this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version)&&(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===Ri.ACTIVE&&(null===(t=this.participantInfo)||void 0===t?void 0:t.state)!==Ri.ACTIVE&&this.emit(Ya.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const t=this.metadata!==e,n=this.metadata;this.metadata=e,t&&this.emit(Ya.ParticipantMetadataChanged,n)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(Ya.ParticipantNameChanged,e)}_setAttributes(e){const t=function(e,t){var n;void 0===e&&(e={}),void 0===t&&(t={});const i=[...Object.keys(t),...Object.keys(e)],r={};for(const o of i)e[o]!==t[o]&&(r[o]=null!==(n=t[o])&&void 0!==n?n:"");return r}(this.attributes,e);this._attributes=e,Object.keys(t).length>0&&this.emit(Ya.AttributesChanged,t)}setPermissions(e){var t,n,i,r,o,a;const s=this.permissions,c=e.canPublish!==(null===(t=this.permissions)||void 0===t?void 0:t.canPublish)||e.canSubscribe!==(null===(n=this.permissions)||void 0===n?void 0:n.canSubscribe)||e.canPublishData!==(null===(i=this.permissions)||void 0===i?void 0:i.canPublishData)||e.hidden!==(null===(r=this.permissions)||void 0===r?void 0:r.hidden)||e.recorder!==(null===(o=this.permissions)||void 0===o?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((e,t)=>{var n;return e!==(null===(n=this.permissions)||void 0===n?void 0:n.canPublishSources[t])})||e.canSubscribeMetrics!==(null===(a=this.permissions)||void 0===a?void 0:a.canSubscribeMetrics);return this.permissions=e,c&&this.emit(Ya.ParticipantPermissionsChanged,s),c}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Ya.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=function(e){switch(e){case vi.EXCELLENT:return gu.Excellent;case vi.GOOD:return gu.Good;case vi.POOR:return gu.Poor;case vi.LOST:return gu.Lost;default:return gu.Unknown}}(e),t!==this._connectionQuality&&this.emit(Ya.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,t;this.activeFuture&&(null===(t=(e=this.activeFuture).reject)||void 0===t||t.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(t=>dc(t.track)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(Za.Muted,()=>{this.emit(Ya.TrackMuted,e)}),e.on(Za.Unmuted,()=>{this.emit(Ya.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case ys.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case ys.Kind.Video:this.videoTrackPublications.set(e.trackSid,e)}}}class bu extends yu{constructor(e,t,n,i,r,o){super(e,t,void 0,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=_i.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new rc)},this.handleReconnected=()=>{var e,t;null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var e,t,n,i,r,o;this.reconnectFuture&&(this.reconnectFuture.promise.catch(e=>this.log.warn(e.message,this.logContext)),null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.reject)||void 0===t||t.call(e,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0),this.signalConnectedFuture&&(null===(i=(n=this.signalConnectedFuture).reject)||void 0===i||i.call(n,"Got disconnected without signal connected"),this.signalConnectedFuture=void 0),null===(o=null===(r=this.activeAgentFuture)||void 0===r?void 0:r.reject)||void 0===o||o.call(r,"Got disconnected without active agent present"),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=e=>{var t,n;e.participant&&this.updateInfo(e.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new rc),null===(n=(t=this.signalConnectedFuture).resolve)||void 0===n||n.call(t)},this.handleSignalRequestResponse=e=>{const{requestId:t,reason:n,message:i}=e,r=this.pendingSignalRequests.get(t);r&&(n!==ao.OK&&r.reject(new ss(i,n)),this.pendingSignalRequests.delete(t))},this.handleDataPacket=e=>{switch(e.value.case){case"rpcResponse":let t=e.value.value,n=null,i=null;"payload"===t.value.case?n=t.value.value:"error"===t.value.case&&(i=kl.fromProto(t.value.value)),this.handleIncomingRpcResponse(t.requestId,n,i);break;case"rpcAck":let r=e.value.value;this.handleIncomingRpcAck(r.requestId)}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(e=>function(e){var t,n,i;if(!e.participantSid&&!e.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new Gr({participantIdentity:null!==(t=e.participantIdentity)&&void 0!==t?t:"",participantSid:null!==(n=e.participantSid)&&void 0!==n?n:"",allTracks:null!==(i=e.allowAll)&&void 0!==i&&i,trackSids:e.allowedTrackSids||[]})}(e)))},this.onTrackUnmuted=e=>{this.onTrackMuted(e,e.isUpstreamPaused)},this.onTrackMuted=(e,t)=>{void 0===t&&(t=!0),e.sid?this.engine.updateMuteStatus(e.sid,t):this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),xc(e)))},this.onTrackUpstreamPaused=e=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),xc(e))),this.onTrackMuted(e,!0)},this.onTrackUpstreamResumed=e=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),xc(e))),this.onTrackMuted(e,e.isMuted)},this.onTrackFeatureUpdate=e=>{const t=this.audioTrackPublications.get(e.sid);t?this.engine.client.sendUpdateLocalAudioTrack(t.trackSid,t.getTrackFeatures()):this.log.warn("Could not update local audio track settings, missing publication for track ".concat(e.sid),this.logContext)},this.onTrackCpuConstrained=(e,t)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),xc(t))),this.emit(Ya.LocalTrackCpuConstrained,e,t)},this.handleSubscribedQualityUpdate=e=>Ro(this,void 0,void 0,function*(){var t,n,i,r,o;if(!(null===(o=this.roomOptions)||void 0===o?void 0:o.dynacast))return;const a=this.videoTrackPublications.get(e.trackSid);if(!a)return void this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}));if(!a.videoTrack)return;const s=yield a.videoTrack.setPublishingCodecs(e.subscribedCodecs);try{for(var c,l=!0,u=Oo(s);!(t=(c=yield u.next()).done);l=!0){r=c.value,l=!1;const e=r;Cs(e)&&(this.log.debug("publish ".concat(e," for ").concat(a.videoTrack.sid),Object.assign(Object.assign({},this.logContext),xc(a))),yield this.publishAdditionalCodecForTrack(a.videoTrack,e,a.options))}}catch(d){n={error:d}}finally{try{l||t||!(i=u.return)||(yield i.call(u))}finally{if(n)throw n.error}}}),this.handleLocalTrackUnpublished=e=>{const t=this.trackPublications.get(e.trackSid);t?this.unpublishTrack(t.track):this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}))},this.handleTrackEnded=e=>Ro(this,void 0,void 0,function*(){if(e.source===ys.Source.ScreenShare||e.source===ys.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),xc(e))),this.unpublishTrack(e);else if(e.isUserProvided)yield e.mute();else if(fc(e)||pc(e))try{if(Vs())try{const t=yield null===navigator||void 0===navigator?void 0:navigator.permissions.query({name:e.source===ys.Source.Camera?"camera":"microphone"});if(t&&"denied"===t.state)throw this.log.warn("user has revoked access to ".concat(e.source),Object.assign(Object.assign({},this.logContext),xc(e))),t.onchange=()=>{"denied"!==t.state&&(e.isMuted||e.restartTrack(),t.onchange=null)},new Error("GetUserMedia Permission denied")}catch(dp){}e.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),xc(e))),fc(e)?yield e.restartTrack({deviceId:"default"}):yield e.restartTrack())}catch(dp){this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),xc(e))),yield e.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=n,this.roomOptions=i,this.setupEngine(n),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=r,this.roomOutgoingDataStreamManager=o}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==_i.NONE}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setupEngine(e){var t;this.engine=e,this.engine.on(Xa.RemoteMute,(e,t)=>{const n=this.trackPublications.get(e);n&&n.track&&(t?n.mute():n.unmute())}),(null===(t=this.signalConnectedFuture)||void 0===t?void 0:t.isResolved)&&(this.signalConnectedFuture=void 0),this.engine.on(Xa.Connected,this.handleReconnected).on(Xa.SignalConnected,this.handleSignalConnected).on(Xa.SignalRestarted,this.handleReconnected).on(Xa.SignalResumed,this.handleReconnected).on(Xa.Restarting,this.handleReconnecting).on(Xa.Resuming,this.handleReconnecting).on(Xa.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Xa.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Xa.Closing,this.handleClosing).on(Xa.SignalRequestResponse,this.handleSignalRequestResponse).on(Xa.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return Ro(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return Ro(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return Ro(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return Ro(this,arguments,void 0,function(e){var t=this;let{metadata:n,name:i,attributes:r}=e;return function*(){return new Promise((e,o)=>Ro(t,void 0,void 0,function*(){var t,a;try{let s=!1;const c=yield this.engine.client.sendUpdateLocalMetadata(null!==(t=null!==n&&void 0!==n?n:this.metadata)&&void 0!==t?t:"",null!==(a=null!==i&&void 0!==i?i:this.name)&&void 0!==a?a:"",r),l=performance.now();for(this.pendingSignalRequests.set(c,{resolve:e,reject:e=>{o(e),s=!0},values:{name:i,metadata:n,attributes:r}});performance.now()-l<5e3&&!s;){if((!i||this.name===i)&&(!n||this.metadata===n)&&(!r||Object.entries(r).every(e=>{let[t,n]=e;return this.attributes[t]===n||""===n&&!this.attributes[t]})))return this.pendingSignalRequests.delete(c),void e();yield Is(50)}o(new ss("Request to update local metadata timed out","TimeoutError"))}catch(dp){dp instanceof Error&&o(dp)}}))}()})}setCameraEnabled(e,t,n){return this.setTrackEnabled(ys.Source.Camera,e,t,n)}setMicrophoneEnabled(e,t,n){return this.setTrackEnabled(ys.Source.Microphone,e,t,n)}setScreenShareEnabled(e,t,n){return this.setTrackEnabled(ys.Source.ScreenShare,e,t,n)}setE2EEEnabled(e){return Ro(this,void 0,void 0,function*(){this.encryptionType=e?_i.GCM:_i.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,n,i){return Ro(this,void 0,void 0,function*(){var r,o;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t})),this.republishPromise&&(yield this.republishPromise);let a=this.getTrackPublication(e);if(t)if(a)yield a.unmute();else{let t;if(this.pendingPublishing.has(e)){const t=yield this.waitForPendingPublicationOfSource(e);return t||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield null===t||void 0===t?void 0:t.unmute(),t}this.pendingPublishing.add(e);try{switch(e){case ys.Source.Camera:t=yield this.createTracks({video:null===(r=n)||void 0===r||r});break;case ys.Source.Microphone:t=yield this.createTracks({audio:null===(o=n)||void 0===o||o});break;case ys.Source.ScreenShare:t=yield this.createScreenTracks(Object.assign({},n));break;default:throw new ns(e)}}catch(dp){throw null===t||void 0===t||t.forEach(e=>{e.stop()}),dp instanceof Error&&this.emit(Ya.MediaDevicesError,dp,Cc(e)),this.pendingPublishing.delete(e),dp}for(const i of t){const t=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);e===ys.Source.Microphone&&dc(i)&&t.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),i.startPreConnectBuffer())}try{const e=[];for(const r of t)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),xc(r))),e.push(this.publishTrack(r,i));const n=yield Promise.all(e);[a]=n}catch(dp){throw null===t||void 0===t||t.forEach(e=>{e.stop()}),dp}finally{this.pendingPublishing.delete(e)}}else if(!(null===a||void 0===a?void 0:a.track)&&this.pendingPublishing.has(e)&&(a=yield this.waitForPendingPublicationOfSource(e),a||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),a&&a.track)if(e===ys.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const e=this.getTrackPublication(ys.Source.ScreenShareAudio);e&&e.track&&this.unpublishTrack(e.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return Ro(this,void 0,void 0,function*(){if(!this.pendingPublishing.has(ys.Source.Camera)&&!this.pendingPublishing.has(ys.Source.Microphone)){this.pendingPublishing.add(ys.Source.Camera),this.pendingPublishing.add(ys.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(e=>this.publishTrack(e)))}finally{this.pendingPublishing.delete(ys.Source.Camera),this.pendingPublishing.delete(ys.Source.Microphone)}}})}createTracks(e){return Ro(this,void 0,void 0,function*(){var t,n;null!==e&&void 0!==e||(e={});const i=yc(e,null===(t=this.roomOptions)||void 0===t?void 0:t.audioCaptureDefaults,null===(n=this.roomOptions)||void 0===n?void 0:n.videoCaptureDefaults);try{const e=yield mu(i,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return e.map(e=>(dc(e)&&(this.microphoneError=void 0,e.setAudioContext(this.audioContext),e.source=ys.Source.Microphone,this.emit(Ya.AudioStreamAcquired)),hc(e)&&(this.cameraError=void 0,e.source=ys.Source.Camera),e))}catch(r){throw r instanceof Error&&(e.audio&&(this.microphoneError=r),e.video&&(this.cameraError=r)),r}})}createScreenTracks(e){return Ro(this,void 0,void 0,function*(){if(void 0===e&&(e={}),void 0===navigator.mediaDevices.getDisplayMedia)throw new ts("getDisplayMedia not supported");void 0!==e.resolution||Bs()||(e.resolution=Os.h1080fps30.resolution);const t=Ec(e),n=yield navigator.mediaDevices.getDisplayMedia(t),i=n.getVideoTracks();if(0===i.length)throw new ns("no video track found");const r=new zl(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});r.source=ys.Source.ScreenShare,e.contentHint&&(r.mediaStreamTrack.contentHint=e.contentHint);const o=[r];if(n.getAudioTracks().length>0){this.emit(Ya.AudioStreamAcquired);const e=new Ol(n.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e.source=ys.Source.ScreenShareAudio,o.push(e)}return o})}publishTrack(e,t){return Ro(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,t)})}publishOrRepublishTrack(e,t){return Ro(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){var r,o,a,s;let c,l;if(fc(e)&&e.setAudioContext(n.audioContext),yield null===(r=n.reconnectFuture)||void 0===r?void 0:r.promise,n.republishPromise&&!i&&(yield n.republishPromise),uc(e)&&n.pendingPublishPromises.has(e)&&(yield n.pendingPublishPromises.get(e)),e instanceof MediaStreamTrack)c=e.getConstraints();else{let t;switch(c=e.constraints,e.source){case ys.Source.Microphone:t="audioinput";break;case ys.Source.Camera:t="videoinput"}t&&n.activeDeviceMap.has(t)&&(c=Object.assign(Object.assign({},c),{deviceId:n.activeDeviceMap.get(t)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new Ol(e,c,!0,n.audioContext,{loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});break;case"video":e=new zl(e,c,!0,{loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});break;default:throw new ns("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});if(n.trackPublications.forEach(t=>{t.track&&t.track===e&&(l=t)}),l)return n.log.warn("track has already been published, skipping",Object.assign(Object.assign({},n.logContext),xc(l))),l;const u=Object.assign(Object.assign({},n.roomOptions.publishDefaults),t),d="channelCount"in e.mediaStreamTrack.getSettings()&&2===e.mediaStreamTrack.getSettings().channelCount||2===e.mediaStreamTrack.getConstraints().channelCount,h=null!==(o=u.forceStereo)&&void 0!==o?o:d;h&&(void 0===u.dtx&&n.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},n.logContext),xc(e))),void 0===u.red&&n.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),null!==(a=u.dtx)&&void 0!==a||(u.dtx=!1),null!==(s=u.red)&&void 0!==s||(u.red=!1)),!function(){const e=ds(),t="17.2";if(e)return"Safari"!==e.name&&"iOS"!==e.os||!!("iOS"===e.os&&e.osVersion&&Js(e.osVersion,t)>=0)||"Safari"===e.name&&Js(e.version,t)>=0}()&&n.roomOptions.e2ee&&(n.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},n.logContext)),u.simulcast=!1),u.source&&(e.source=u.source);const p=new Promise((t,i)=>Ro(n,void 0,void 0,function*(){try{if(this.engine.client.currentState!==Bc.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:xc(e)}));const n=setTimeout(()=>{i(new as("publishing rejected as engine not connected within timeout",408))},15e3);yield this.waitUntilEngineConnected(),clearTimeout(n);const r=yield this.publish(e,u,h);t(r)}else try{const n=yield this.publish(e,u,h);t(n)}catch(dp){i(dp)}}catch(dp){i(dp)}}));n.pendingPublishPromises.set(e,p);try{return yield p}catch(dp){throw dp}finally{n.pendingPublishPromises.delete(e)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new rc),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),xc(e))),!1;const{canPublish:t,canPublishSources:n}=this.permissions;return!(!t||0!==n.length&&!n.map(e=>function(e){switch(e){case mi.CAMERA:return ys.Source.Camera;case mi.MICROPHONE:return ys.Source.Microphone;case mi.SCREEN_SHARE:return ys.Source.ScreenShare;case mi.SCREEN_SHARE_AUDIO:return ys.Source.ScreenShareAudio;default:return ys.Source.Unknown}}(e)).includes(e.source))||(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),xc(e))),!1)}publish(e,t,n){return Ro(this,void 0,void 0,function*(){var i,r,o,a,s,c,l,u,d,h;if(!this.hasPermissionsToPublish(e))throw new as("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(t=>uc(e)&&t.source===e.source)&&e.source!==ys.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),xc(e))),t.stopMicTrackOnMute&&dc(e)&&(e.stopOnMute=!0),e.source===ys.Source.ScreenShare&&Ls()&&(t.simulcast=!1),"av1"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(js()||Ls())return!1;const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/av1"===n.mimeType.toLowerCase()){t=!0;break}return t}()||(t.videoCodec=void 0),"vp9"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(Ls())return!1;if(js()){const e=ds();if((null===e||void 0===e?void 0:e.version)&&Js(e.version,"16")<0)return!1;if("iOS"===(null===e||void 0===e?void 0:e.os)&&(null===e||void 0===e?void 0:e.osVersion)&&Js(e.osVersion,"16")<0)return!1}const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/vp9"===n.mimeType.toLowerCase()){t=!0;break}return t}()||(t.videoCodec=void 0),void 0===t.videoCodec&&(t.videoCodec=hl),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(e=>t.videoCodec===Pc(e.mime))||(t.videoCodec=Pc(this.enabledPublishVideoCodecs[0].mime)));const p=t.videoCodec;e.on(Za.Muted,this.onTrackMuted),e.on(Za.Unmuted,this.onTrackUnmuted),e.on(Za.Ended,this.handleTrackEnded),e.on(Za.UpstreamPaused,this.onTrackUpstreamPaused),e.on(Za.UpstreamResumed,this.onTrackUpstreamResumed),e.on(Za.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const f=[],m=!(null===(i=t.dtx)||void 0===i||i),g=e.getSourceTrackSettings();g.autoGainControl&&f.push(Ti.TF_AUTO_GAIN_CONTROL),g.echoCancellation&&f.push(Ti.TF_ECHO_CANCELLATION),g.noiseSuppression&&f.push(Ti.TF_NOISE_SUPPRESSION),g.channelCount&&g.channelCount>1&&f.push(Ti.TF_STEREO),m&&f.push(Ti.TF_NO_DTX),fc(e)&&e.hasPreConnectBuffer&&f.push(Ti.TF_PRECONNECT_BUFFER);const v=new yr({cid:e.mediaStreamTrack.id,name:t.name,type:ys.kindToProto(e.kind),muted:e.isMuted,source:ys.sourceToProto(e.source),disableDtx:m,encryption:this.encryptionType,stereo:n,disableRed:this.isE2EEEnabled||!(null===(r=t.red)||void 0===r||r),stream:null===t||void 0===t?void 0:t.stream,backupCodecPolicy:null===t||void 0===t?void 0:t.backupCodecPolicy,audioFeatures:f});let y;if(e.kind===ys.Kind.Video){let n={width:0,height:0};try{n=yield e.waitForDimensions()}catch(dp){const i=null!==(a=null===(o=this.roomOptions.videoCaptureDefaults)||void 0===o?void 0:o.resolution)&&void 0!==a?a:Rs.h720.resolution;n={width:i.width,height:i.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),xc(e)),{dims:n}))}v.width=n.width,v.height=n.height,pc(e)&&(Ms(p)&&(e.source===ys.Source.ScreenShare&&(t.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),xc(e))))),t.scalabilityMode=null!==(s=t.scalabilityMode)&&void 0!==s?s:"L3T3_KEY"),v.simulcastCodecs=[new vr({codec:p,cid:e.mediaStreamTrack.id})],!0===t.backupCodec&&(t.backupCodec={codec:hl}),t.backupCodec&&p!==t.backupCodec.codec&&v.encryption===_i.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),v.simulcastCodecs.push(new vr({codec:t.backupCodec.codec,cid:""})))),y=Ll(e.source===ys.Source.ScreenShare,v.width,v.height,t),v.layers=Hl(v.width,v.height,y,Ms(t.videoCodec))}else e.kind===ys.Kind.Audio&&(y=[{maxBitrate:null===(c=t.audioPreset)||void 0===c?void 0:c.maxBitrate,priority:null!==(u=null===(l=t.audioPreset)||void 0===l?void 0:l.priority)&&void 0!==u?u:"high",networkPriority:null!==(h=null===(d=t.audioPreset)||void 0===d?void 0:d.priority)&&void 0!==h?h:"high"}]);if(!this.engine||this.engine.isClosed)throw new rs("cannot publish track when not connected");const b=()=>Ro(this,void 0,void 0,function*(){var n,i,r;if(!this.engine.pcManager)throw new rs("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,t,y),this.emit(Ya.LocalSenderCreated,e.sender,e),pc(e)&&(null!==(n=t.degradationPreference)&&void 0!==n||(t.degradationPreference=function(e){return e.source===ys.Source.ScreenShare||e.constraints.height&&oc(e.constraints.height)>=1080?"maintain-resolution":"balanced"}(e)),e.setDegradationPreference(t.degradationPreference)),y)if(Ls()&&e.kind===ys.Kind.Audio){let t;for(const n of this.engine.pcManager.publisher.getTransceivers())if(n.sender===e.sender){t=n;break}t&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:t,codec:"opus",maxbr:(null===(i=y[0])||void 0===i?void 0:i.maxBitrate)?y[0].maxBitrate/1e3:0})}else e.codec&&Ms(e.codec)&&(null===(r=y[0])||void 0===r?void 0:r.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:v.cid,codec:e.codec,maxbr:y[0].maxBitrate/1e3});yield this.engine.negotiate()});let k;const S=new Promise((t,n)=>Ro(this,void 0,void 0,function*(){var i;try{k=yield this.engine.addTrack(v),t(k)}catch(r){e.sender&&(null===(i=this.engine.pcManager)||void 0===i?void 0:i.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(t=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),xc(e)),{error:t}))})),n(r)}}));if(this.enabledPublishVideoCodecs.length>0){const e=yield Promise.all([S,b()]);k=e[0]}else{let n;if(k=yield S,k.codecs.forEach(e=>{void 0===n&&(n=e.mimeType)}),n&&e.kind===ys.Kind.Video){const i=Pc(n);i!==p&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),xc(e)),{codec:i})),t.videoCodec=i,y=Ll(e.source===ys.Source.ScreenShare,v.width,v.height,t))}yield b()}const T=new fu(e.kind,k,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(T.on(Za.CpuConstrained,e=>this.onTrackCpuConstrained(e,T)),T.options=t,e.sid=k.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:y,trackInfo:k})),pc(e)?e.startMonitor(this.engine.client):fc(e)&&e.startMonitor(),this.addTrackPublication(T),this.emit(Ya.LocalTrackPublished,T),fc(e)&&k.audioFeatures.includes(Ti.TF_PRECONNECT_BUFFER)){const t=e.getPreConnectBuffer(),n=e.getPreConnectBufferMimeType();if(this.on(Ya.LocalTrackSubscribed,t=>{if(t.trackSid===k.sid){if(!e.hasPreConnectBuffer)return void this.log.warn("subscribe event came to late, buffer already closed",this.logContext);this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),xc(e))),e.stopPreConnectBuffer()}}),t){const i=new Promise((i,r)=>Ro(this,void 0,void 0,function*(){var o,a,s,c,l,u;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),xc(e)));const m=setTimeout(()=>{r(new Error("agent not active within 10 seconds"))},1e4),v=yield this.waitUntilActiveAgentPresent();clearTimeout(m),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),xc(e)));const y=yield this.streamBytes({name:"preconnect-buffer",mimeType:n,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[v.identity],attributes:{trackId:T.trackSid,sampleRate:String(null!==(l=g.sampleRate)&&void 0!==l?l:"48000"),channels:String(null!==(u=g.channelCount)&&void 0!==u?u:"1")}});try{for(var d,h=!0,p=Oo(t);!(o=(d=yield p.next()).done);h=!0){c=d.value,h=!1;const e=c;yield y.write(e)}}catch(f){a={error:f}}finally{try{h||o||!(s=p.return)||(yield s.call(p))}finally{if(a)throw a.error}}yield y.close(),i()}catch(dp){r(dp)}}));i.then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),xc(e)))}).catch(t=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),xc(e)),{error:t}))})}}return T})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,n){return Ro(this,void 0,void 0,function*(){var i;if(this.encryptionType!==_i.NONE)return;let r;if(this.trackPublications.forEach(t=>{t.track&&t.track===e&&(r=t)}),!r)throw new ns("track is not published");if(!pc(e))throw new ns("track is not a video track");const o=Object.assign(Object.assign({},null===(i=this.roomOptions)||void 0===i?void 0:i.publishDefaults),n),a=function(e,t,n){var i,r,o,a;if(!n.backupCodec||!0===n.backupCodec||n.backupCodec.codec===n.videoCodec)return;t!==n.backupCodec.codec&&So.warn("requested a different codec than specified as backup",{serverRequested:t,backup:n.backupCodec.codec}),n.videoCodec=t,n.videoEncoding=n.backupCodec.encoding;const s=e.mediaStreamTrack.getSettings(),c=null!==(i=s.width)&&void 0!==i?i:null===(r=e.dimensions)||void 0===r?void 0:r.width,l=null!==(o=s.height)&&void 0!==o?o:null===(a=e.dimensions)||void 0===a?void 0:a.height;return e.source===ys.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),Ll(e.source===ys.Source.ScreenShare,c,l,n)}(e,t,o);if(!a)return void this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),xc(e)));const s=e.addSimulcastTrack(t,a);if(!s)return;const c=new yr({cid:s.mediaStreamTrack.id,type:ys.kindToProto(e.kind),muted:e.isMuted,source:ys.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:s.mediaStreamTrack.id}]});if(c.layers=Hl(c.width,c.height,a),!this.engine||this.engine.isClosed)throw new rs("cannot publish track when not connected");const l=(yield Promise.all([this.engine.addTrack(c),(()=>Ro(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,s,o,a),yield this.engine.negotiate()}))()]))[0];this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:l}))})}unpublishTrack(e,t){return Ro(this,void 0,void 0,function*(){var n,i;if(uc(e)){const t=this.pendingPublishPromises.get(e);t&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),xc(e))),yield t)}const r=this.getPublicationForTrack(e),o=r?xc(r):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!r||!r.track)return void this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));(e=r.track).off(Za.Muted,this.onTrackMuted),e.off(Za.Unmuted,this.onTrackUnmuted),e.off(Za.Ended,this.handleTrackEnded),e.off(Za.UpstreamPaused,this.onTrackUpstreamPaused),e.off(Za.UpstreamResumed,this.onTrackUpstreamResumed),e.off(Za.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),void 0===t&&(t=null===(i=null===(n=this.roomOptions)||void 0===n?void 0:n.stopLocalTrackOnUnpublish)||void 0===i||i),t?e.stop():e.stopMonitor();let a=!1;const s=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<yl.FAILED&&s)try{for(const e of this.engine.pcManager.publisher.getTransceivers())e.sender===s&&(e.direction="inactive",a=!0);if(this.engine.removeTrack(s)&&(a=!0),pc(e)){for(const[,t]of e.simulcastCodecs)t.sender&&(this.engine.removeTrack(t.sender)&&(a=!0),t.sender=void 0);e.simulcastCodecs.clear()}}catch(dp){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:dp}))}switch(this.trackPublications.delete(r.trackSid),r.kind){case ys.Kind.Audio:this.audioTrackPublications.delete(r.trackSid);break;case ys.Kind.Video:this.videoTrackPublications.delete(r.trackSid)}return this.emit(Ya.LocalTrackUnpublished,r),r.setTrack(void 0),a&&(yield this.engine.negotiate()),r})}unpublishTracks(e){return Ro(this,void 0,void 0,function*(){return(yield Promise.all(e.map(e=>this.unpublishTrack(e)))).filter(e=>!!e)})}republishAllTracks(e){return Ro(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){t.republishPromise&&(yield t.republishPromise),t.republishPromise=new Promise((i,r)=>Ro(t,void 0,void 0,function*(){try{const t=[];this.trackPublications.forEach(n=>{n.track&&(e&&(n.options=Object.assign(Object.assign({},n.options),e)),t.push(n))}),yield Promise.all(t.map(e=>Ro(this,void 0,void 0,function*(){const t=e.track;yield this.unpublishTrack(t,!1),!n||t.isMuted||t.source===ys.Source.ScreenShare||t.source===ys.Source.ScreenShareAudio||!fc(t)&&!pc(t)||t.isUserProvided||(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:e.trackSid})),yield t.restartTrack()),yield this.publishOrRepublishTrack(t,e.options,!0)}))),i()}catch(t){r(t)}finally{this.republishPromise=void 0}})),yield t.republishPromise}()})}publishData(e){return Ro(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const i=n.reliable?Li.RELIABLE:Li.LOSSY,r=n.destinationIdentities,o=n.topic;let a=new zi({participantIdentity:t.identity,payload:e,destinationIdentities:r,topic:o});const s=new Ai({kind:i,value:{case:"user",value:a}});yield t.engine.sendDataPacket(s,i)}()})}publishDtmf(e,t){return Ro(this,void 0,void 0,function*(){const n=new Ai({kind:Li.RELIABLE,value:{case:"sipDtmf",value:new Vi({code:e,digit:t})}});yield this.engine.sendDataPacket(n,Li.RELIABLE)})}sendChatMessage(e,t){return Ro(this,void 0,void 0,function*(){const n={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:null===t||void 0===t?void 0:t.attachments},i=new Ai({value:{case:"chatMessage",value:new Wi(Object.assign(Object.assign({},n),{timestamp:$t.parse(n.timestamp)}))}});return yield this.engine.sendDataPacket(i,Li.RELIABLE),this.emit(Ya.ChatMessage,n),n})}editChatMessage(e,t){return Ro(this,void 0,void 0,function*(){const n=Object.assign(Object.assign({},t),{message:e,editTimestamp:Date.now()}),i=new Ai({value:{case:"chatMessage",value:new Wi(Object.assign(Object.assign({},n),{timestamp:$t.parse(n.timestamp),editTimestamp:$t.parse(n.editTimestamp)}))}});return yield this.engine.sendDataPacket(i,Li.RELIABLE),this.emit(Ya.ChatMessage,n),n})}sendText(e,t){return Ro(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,t)})}streamText(e){return Ro(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,t){return Ro(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,t)})}streamBytes(e){return Ro(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){return Ro(this,arguments,void 0,function(e){var t=this;let{destinationIdentity:n,method:i,payload:r,responseTimeout:o=15e3}=e;return function*(){return new Promise((e,a)=>Ro(t,void 0,void 0,function*(){var t,s,c,l;if(Sl(r)>15360)return void a(kl.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));if((null===(s=null===(t=this.engine.latestJoinResponse)||void 0===t?void 0:t.serverInfo)||void 0===s?void 0:s.version)&&Js(null===(l=null===(c=this.engine.latestJoinResponse)||void 0===c?void 0:c.serverInfo)||void 0===l?void 0:l.version,"1.8.0")<0)return void a(kl.builtIn("UNSUPPORTED_SERVER"));const u=Math.max(o,8e3),d=crypto.randomUUID();yield this.publishRpcRequest(n,d,i,r,u);const h=setTimeout(()=>{this.pendingAcks.delete(d),a(kl.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(d),clearTimeout(p)},7e3);this.pendingAcks.set(d,{resolve:()=>{clearTimeout(h)},participantIdentity:n});const p=setTimeout(()=>{this.pendingResponses.delete(d),a(kl.builtIn("RESPONSE_TIMEOUT"))},o);this.pendingResponses.set(d,{resolve:(t,n)=>{clearTimeout(p),this.pendingAcks.has(d)&&(console.warn("RPC response received before ack",d),this.pendingAcks.delete(d),clearTimeout(h)),n?a(n):e(null!==t&&void 0!==t?t:"")},participantIdentity:n})}))}()})}registerRpcMethod(e,t){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const t=this.pendingAcks.get(e);t?(t.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,t,n){const i=this.pendingResponses.get(e);i?(i.resolve(t,n),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,t,n,i,r){return Ro(this,void 0,void 0,function*(){const o=new Ai({destinationIdentities:[e],kind:Li.RELIABLE,value:{case:"rpcRequest",value:new Gi({id:t,method:n,payload:i,responseTimeoutMs:r,version:1})}});yield this.engine.sendDataPacket(o,Li.RELIABLE)})}handleParticipantDisconnected(e){for(const[t,{participantIdentity:n}]of this.pendingAcks)n===e&&this.pendingAcks.delete(t);for(const[t,{participantIdentity:n,resolve:i}]of this.pendingResponses)n===e&&(i(null,kl.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(t))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(e=>"video"===e.mime.split("/")[0].toLowerCase())}updateInfo(e){return!!super.updateInfo(e)&&(e.tracks.forEach(e=>{var t,n;const i=this.trackPublications.get(e.sid);if(i){const r=i.isMuted||null!==(n=null===(t=i.track)||void 0===t?void 0:t.isUpstreamPaused)&&void 0!==n&&n;r!==e.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),xc(i)),{mutedOnServer:r})),this.engine.client.sendMuteTrack(e.sid,r))}}),!0)}setActiveAgent(e){var t,n,i,r;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?null===(n=null===(t=this.activeAgentFuture)||void 0===t?void 0:t.resolve)||void 0===n||n.call(t,e):null===(r=null===(i=this.activeAgentFuture)||void 0===i?void 0:i.reject)||void 0===r||r.call(i,"Agent disconnected"),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new rc),this.activeAgentFuture.promise)}getPublicationForTrack(e){let t;return this.trackPublications.forEach(n=>{const i=n.track;i&&(e instanceof MediaStreamTrack?(fc(i)||pc(i))&&i.mediaStreamTrack===e&&(t=n):e===i&&(t=n))}),t}waitForPendingPublicationOfSource(e){return Ro(this,void 0,void 0,function*(){const t=Date.now();for(;Date.now()<t+1e4;){const t=Array.from(this.pendingPublishPromises.entries()).find(t=>{let[n]=t;return n.source===e});if(t)return t[1];yield Is(20)}})}}class ku extends pu{constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=e=>{this.setTrack(void 0),this.emit(Za.Ended,e)},this.handleVisibilityChange=e=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(e),this.logContext),this.visible=e,this.emitTrackUpdate()},this.handleVideoDimensionsChange=e=>{this.log.debug("adaptivestream video dimensions ".concat(e.width,"x").concat(e.height),this.logContext),this.videoDimensionsAdaptiveStream=e,this.emitTrackUpdate()},this.subscribed=n,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new Rr({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new $i({participantSid:"",trackSids:[this.trackSid]})]});this.emit(Za.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(n)}get subscriptionStatus(){return!1===this.subscribed?pu.SubscriptionStatus.Unsubscribed:super.isSubscribed?pu.SubscriptionStatus.Subscribed:pu.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?pu.PermissionStatus.Allowed:pu.PermissionStatus.NotAllowed}get isSubscribed(){return!1!==this.subscribed&&super.isSubscribed}get isDesired(){return!1!==this.subscribed}get isEnabled(){return void 0!==this.requestedDisabled?!this.requestedDisabled:!this.isAdaptiveStream||this.visible}get isLocal(){return!1}setEnabled(e){this.isManualOperationAllowed()&&this.requestedDisabled!==!e&&(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){this.isManualOperationAllowed()&&this.requestedMaxQuality!==e&&(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,n;this.isManualOperationAllowed()&&((null===(t=this.requestedVideoDimensions)||void 0===t?void 0:t.width)===e.width&&(null===(n=this.requestedVideoDimensions)||void 0===n?void 0:n.height)===e.height||(vc(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&vc(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return null!==(e=this.requestedMaxQuality)&&void 0!==e?e:vs.HIGH}setTrack(e){const t=this.subscriptionStatus,n=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(Za.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(Za.VisibilityChanged,this.handleVisibilityChange),i.off(Za.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(Za.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(Za.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(Za.VisibilityChanged,this.handleVisibilityChange),e.on(Za.Ended,this.handleEnded),this.emit(Za.Subscribed,e)),this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(Za.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?Za.Muted:Za.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(Za.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(Za.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return!!this.isDesired||(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return vc(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new xr({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===ys.Kind.Video){let t=this.requestedVideoDimensions;if(void 0!==this.videoDimensionsAdaptiveStream)if(t){_c(this.videoDimensionsAdaptiveStream,t)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream)}else if(void 0!==this.requestedMaxQuality&&this.trackInfo){const e=function(e,t){var n;return null===(n=e.layers)||void 0===n?void 0:n.find(e=>e.quality===t)}(this.trackInfo,this.requestedMaxQuality);e&&_c(this.videoDimensionsAdaptiveStream,e)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream;t?(e.width=Math.ceil(t.width),e.height=Math.ceil(t.height)):void 0!==this.requestedMaxQuality?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:vs.HIGH})),e.quality=vs.HIGH)}this.emit(Za.UpdateSettings,e)}}class Su extends yu{static fromParticipantInfo(e,t,n){return new Su(e,t.sid,t.identity,t.name,t.metadata,t.attributes,n,t.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,t,n,i,r,o,a){super(t,n||"",i,r,o,a,arguments.length>7&&void 0!==arguments[7]?arguments[7]:xi.STANDARD),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(Za.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),xc(e)),{settings:t})),this.signalClient.sendUpdateTrackSettings(t)}),e.on(Za.UpdateSubscription,e=>{e.participantTracks.forEach(e=>{e.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(e)}),e.on(Za.SubscriptionPermissionChanged,t=>{this.emit(Ya.TrackSubscriptionPermissionChanged,e,t)}),e.on(Za.SubscriptionStatusChanged,t=>{this.emit(Ya.TrackSubscriptionStatusChanged,e,t)}),e.on(Za.Subscribed,t=>{this.emit(Ya.TrackSubscribed,t,e)}),e.on(Za.Unsubscribed,t=>{this.emit(Ya.TrackUnsubscribed,t,e)}),e.on(Za.SubscriptionFailed,t=>{this.emit(Ya.TrackSubscriptionFailed,e.trackSid,t)})}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ys.Source.Microphone;this.volumeMap.set(t,e);const n=this.getTrackPublication(t);n&&n.track&&n.track.setVolume(e)}getVolume(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ys.Source.Microphone;const t=this.getTrackPublication(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,n,i,r,o){let a=this.getTrackPublicationBySid(t);if(a||t.startsWith("TR")||this.trackPublications.forEach(t=>{a||e.kind!==t.kind.toString()||(a=t)}),!a)return 0===o?(this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),void this.emit(Ya.TrackSubscriptionFailed,t)):(void 0===o&&(o=20),void setTimeout(()=>{this.addSubscribedMediaTrack(e,t,n,i,r,o-1)},150));if("ended"===e.readyState)return this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),xc(a))),void this.emit(Ya.TrackSubscriptionFailed,t);let s;return s="video"===e.kind?new lu(e,t,i,r):new cu(e,t,i,this.audioContext,this.audioOutput),s.source=a.source,s.isMuted=a.isMuted,s.setMediaStream(n),s.start(),a.setTrack(s),this.volumeMap.has(a.source)&&mc(s)&&dc(s)&&s.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,n=new Map;return e.tracks.forEach(e=>{var i,r;let o=this.getTrackPublicationBySid(e.sid);if(o)o.updateInfo(e);else{const t=ys.kindFromProto(e.type);if(!t)return;o=new ku(t,e,null===(i=this.signalClient.connectOptions)||void 0===i?void 0:i.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:null===(r=this.loggerOptions)||void 0===r?void 0:r.loggerName}),o.updateInfo(e),n.set(e.sid,o);const a=Array.from(this.trackPublications.values()).find(e=>e.source===(null===o||void 0===o?void 0:o.source));a&&o.source!==ys.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(o.source),Object.assign(Object.assign({},this.logContext),{oldTrack:xc(a),newTrack:xc(o)})),this.addTrackPublication(o)}t.set(e.sid,o)}),this.trackPublications.forEach(e=>{t.has(e.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),xc(e))),this.unpublishTrack(e.trackSid,!0))}),n.forEach(e=>{this.emit(Ya.TrackPublished,e)}),!0}unpublishTrack(e,t){const n=this.trackPublications.get(e);if(!n)return;const{track:i}=n;switch(i&&(i.stop(),n.setTrack(void 0)),this.trackPublications.delete(e),n.kind){case ys.Kind.Audio:this.audioTrackPublications.delete(e);break;case ys.Kind.Video:this.videoTrackPublications.delete(e)}t&&this.emit(Ya.TrackUnpublished,n)}setAudioOutput(e){return Ro(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTrackPublications.forEach(n=>{var i;dc(n.track)&&mc(n.track)&&t.push(n.track.setSinkId(null!==(i=e.deviceId)&&void 0!==i?i:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:n})),super.emit(e,...n)}}!function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Reconnecting="reconnecting",e.SignalReconnecting="signalReconnecting"}(vu||(vu={}));class Tu extends No.EventEmitter{get hasE2EESetup(){return void 0!==this.e2eeManager}constructor(e){var t,n,i,r;if(super(),t=this,this.state=vu.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=So,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(e,t,n)=>Ro(this,void 0,void 0,function*(){var i;if("undefined"===typeof RTCPeerConnection||!Ns()&&!Ds())throw qs()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const r=yield this.disconnectLock.lock();if(this.state===vu.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),r(),Promise.resolve();if(this.connectFuture)return r(),this.connectFuture.promise;this.setAndEmitConnectionState(vu.Connecting),(null===(i=this.regionUrlProvider)||void 0===i?void 0:i.getServerUrl().toString())!==e&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Hs(new URL(e))&&(void 0===this.regionUrlProvider?this.regionUrlProvider=new Xl(e,t):this.regionUrlProvider.updateToken(t),this.regionUrlProvider.fetchRegionSettings().then(e=>{var t;null===(t=this.regionUrlProvider)||void 0===t||t.setServerReportedRegions(e)}).catch(e=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:e}))}));const o=(i,a,s)=>Ro(this,void 0,void 0,function*(){var c,l;this.abortController&&this.abortController.abort();const u=new AbortController;this.abortController=u,null===r||void 0===r||r();try{yield this.attemptConnection(null!==s&&void 0!==s?s:e,t,n,u),this.abortController=void 0,i()}catch(dp){if(this.regionUrlProvider&&dp instanceof es&&dp.reason!==Ga.Cancelled&&dp.reason!==Ga.NotAllowed){let t=null;try{t=yield this.regionUrlProvider.getNextBestRegionUrl(null===(c=this.abortController)||void 0===c?void 0:c.signal)}catch(d){if(d instanceof es&&(401===d.status||d.reason===Ga.Cancelled))return this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),void a(d)}t&&!(null===(l=this.abortController)||void 0===l?void 0:l.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(dp.message,". Retrying with another region: ").concat(t),this.logContext),this.recreateEngine(),yield o(i,a,t)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,sc(dp)),a(dp))}else{let t=bi.UNKNOWN_REASON;dp instanceof es&&(t=sc(dp)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,t),a(dp)}}}),a=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new rc((e,t)=>{o(e,t,a)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(e,t,n,i,r,o)=>Ro(this,void 0,void 0,function*(){var a,s,c;const l=yield n.join(e,t,{autoSubscribe:i.autoSubscribe,adaptiveStream:"object"===typeof r.adaptiveStream||r.adaptiveStream,maxRetries:i.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:i.websocketTimeout,singlePeerConnection:r.singlePeerConnection},o.signal);let u=l.serverInfo;if(u||(u={version:l.serverVersion,region:l.serverRegion}),this.serverInfo=u,this.log.debug("connected to Livekit Server ".concat(Object.entries(u).map(e=>{let[t,n]=e;return"".concat(t,": ").concat(n)}).join(", ")),{room:null===(a=l.room)||void 0===a?void 0:a.name,roomSid:null===(s=l.room)||void 0===s?void 0:s.sid,identity:null===(c=l.participant)||void 0===c?void 0:c.identity}),!u.version)throw new is("unknown server version");return"0.15.1"===u.version&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),r.dynacast=!1),l}),this.applyJoinResponse=e=>{const t=e.participant;if(this.localParticipant.sid=t.sid,this.localParticipant.identity=t.identity,this.localParticipant.setEnabledPublishCodecs(e.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(e.sifTrailer)}catch(dp){this.log.error(dp instanceof Error?dp.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:dp}))}this.handleParticipantUpdates([t,...e.otherParticipants]),e.room&&this.handleRoomUpdate(e.room)},this.attemptConnection=(e,t,n,i)=>Ro(this,void 0,void 0,function*(){var r,o;this.state===vu.Reconnecting||this.isResuming||(null===(r=this.engine)||void 0===r?void 0:r.pendingReconnect)?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),(null===(o=this.regionUrlProvider)||void 0===o?void 0:o.isCloud())&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},vl),n),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const n=yield this.connectSignal(e,t,this.engine,this.connOptions,this.options,i);this.applyJoinResponse(n),this.setupLocalParticipantEvents(),this.emit($a.SignalConnected)}catch(a){yield this.engine.close(),this.recreateEngine();const e=new es("could not establish signal connection",Ga.ServerUnreachable);throw a instanceof Error&&(e.message="".concat(e.message,": ").concat(a.message)),a instanceof es&&(e.reason=a.reason,e.status=a.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:a})),e}if(i.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new es("Connection attempt aborted",Ga.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,i)}catch(dp){throw yield this.engine.close(),this.recreateEngine(),dp}Vs()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Vs()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(vu.Connected),this.emit($a.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Ro(t,[...n],void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){var n,i,r,o;const a=yield e.disconnectLock.lock();try{if(e.state===vu.Disconnected)return void e.log.debug("already disconnected",e.logContext);if(e.log.info("disconnect from room",Object.assign({},e.logContext)),e.state===vu.Connecting||e.state===vu.Reconnecting||e.isResuming){const t="Abort connection attempt due to user initiated disconnect";e.log.warn(t,e.logContext),null===(n=e.abortController)||void 0===n||n.abort(t),null===(r=null===(i=e.connectFuture)||void 0===i?void 0:i.reject)||void 0===r||r.call(i,new es("Client initiated disconnect",Ga.Cancelled)),e.connectFuture=void 0}(null===(o=e.engine)||void 0===o?void 0:o.client.isDisconnected)||(yield e.engine.client.sendLeave()),e.engine&&(yield e.engine.close()),e.handleDisconnect(t,bi.CLIENT_INITIATED),e.engine=void 0}finally{a()}}()})},this.onPageLeave=()=>Ro(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>Ro(this,void 0,void 0,function*(){const e=[],t=ds();if(t&&"iOS"===t.os){const t="livekit-dummy-audio-el";let n=document.getElementById(t);if(!n){n=document.createElement("audio"),n.id=t,n.autoplay=!0,n.hidden=!0;const e=ic();e.enabled=!0;const i=new MediaStream([e]);n.srcObject=i,document.addEventListener("visibilitychange",()=>{n&&(n.srcObject=document.hidden?null:i,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(n),this.once($a.Disconnected,()=>{null===n||void 0===n||n.remove(),n=null})}e.push(n)}this.remoteParticipants.forEach(t=>{t.audioTrackPublications.forEach(t=>{t.track&&t.track.attachedElements.forEach(t=>{e.push(t)})})});try{yield Promise.all([this.acquireAudioContext(),...e.map(e=>(e.muted=!1,e.play()))]),this.handleAudioPlaybackStarted()}catch(n){throw this.handleAudioPlaybackFailed(n),n}}),this.startVideo=()=>Ro(this,void 0,void 0,function*(){const e=[];for(const t of this.remoteParticipants.values())t.videoTrackPublications.forEach(t=>{var n;null===(n=t.track)||void 0===n||n.attachedElements.forEach(t=>{e.includes(t)||e.push(t)})});yield Promise.all(e.map(e=>e.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(e=>{"NotAllowedError"===e.name?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const e of this.remoteParticipants.values())this.handleParticipantDisconnected(e.identity,e);this.setAndEmitConnectionState(vu.Reconnecting)&&this.emit($a.Reconnecting)},this.handleSignalRestarted=e=>Ro(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(e.serverRegion),Object.assign(Object.assign({},this.logContext),{region:e.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(e);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(t){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:t}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:e.serverRegion}))}catch(n){return}this.setAndEmitConnectionState(vu.Connected),this.emit($a.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=e=>{e.forEach(e=>{var t;if(e.identity===this.localParticipant.identity)return void this.localParticipant.updateInfo(e);""===e.identity&&(e.identity=null!==(t=this.sidToIdentity.get(e.sid))&&void 0!==t?t:"");let n=this.remoteParticipants.get(e.identity);e.state===Ri.DISCONNECTED?this.handleParticipantDisconnected(e.identity,n):n=this.getOrCreateParticipant(e.identity,e)})},this.handleActiveSpeakersUpdate=e=>{const t=[],n={};e.forEach(e=>{if(n[e.sid]=!0,e.sid===this.localParticipant.sid)this.localParticipant.audioLevel=e.level,this.localParticipant.setIsSpeaking(!0),t.push(this.localParticipant);else{const n=this.getRemoteParticipantBySid(e.sid);n&&(n.audioLevel=e.level,n.setIsSpeaking(!0),t.push(n))}}),n[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(e=>{n[e.sid]||(e.audioLevel=0,e.setIsSpeaking(!1))}),this.activeSpeakers=t,this.emitWhenConnected($a.ActiveSpeakersChanged,t)},this.handleSpeakersChanged=e=>{const t=new Map;this.activeSpeakers.forEach(e=>{const n=this.remoteParticipants.get(e.identity);n&&n.sid!==e.sid||t.set(e.sid,e)}),e.forEach(e=>{let n=this.getRemoteParticipantBySid(e.sid);e.sid===this.localParticipant.sid&&(n=this.localParticipant),n&&(n.audioLevel=e.level,n.setIsSpeaking(e.active),e.active?t.set(e.sid,n):t.delete(e.sid))});const n=Array.from(t.values());n.sort((e,t)=>t.audioLevel-e.audioLevel),this.activeSpeakers=n,this.emitWhenConnected($a.ActiveSpeakersChanged,n)},this.handleStreamStateUpdate=e=>{e.streamStates.forEach(e=>{const t=this.getRemoteParticipantBySid(e.participantSid);if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);if(!n||!n.track)return;const i=ys.streamStateFromProto(e.state);n.track.setStreamState(i),i!==n.track.streamState&&(t.emit(Ya.TrackStreamStateChanged,n,n.track.streamState),this.emitWhenConnected($a.TrackStreamStateChanged,n,n.track.streamState,t))})},this.handleSubscriptionPermissionUpdate=e=>{const t=this.getRemoteParticipantBySid(e.participantSid);if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);n&&n.setAllowed(e.allowed)},this.handleSubscriptionError=e=>{const t=Array.from(this.remoteParticipants.values()).find(t=>t.trackPublications.has(e.trackSid));if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);n&&n.setSubscriptionError(e.err)},this.handleDataPacket=(e,t)=>{const n=this.remoteParticipants.get(e.participantIdentity);if("user"===e.value.case)this.handleUserPacket(n,e.value.value,e.kind,t);else if("transcription"===e.value.case)this.handleTranscription(n,e.value.value);else if("sipDtmf"===e.value.case)this.handleSipDtmf(n,e.value.value);else if("chatMessage"===e.value.case)this.handleChatMessage(n,e.value.value);else if("metrics"===e.value.case)this.handleMetrics(e.value.value,n);else if("streamHeader"===e.value.case||"streamChunk"===e.value.case||"streamTrailer"===e.value.case)this.handleDataStream(e,t);else if("rpcRequest"===e.value.case){const t=e.value.value;this.handleIncomingRpcRequest(e.participantIdentity,t.id,t.method,t.payload,t.responseTimeoutMs,t.version)}},this.handleUserPacket=(e,t,n,i)=>{this.emit($a.DataReceived,t.payload,e,n,t.topic,i),null===e||void 0===e||e.emit(Ya.DataReceived,t.payload,n,i)},this.handleSipDtmf=(e,t)=>{this.emit($a.SipDTMFReceived,t,e),null===e||void 0===e||e.emit(Ya.SipDTMFReceived,t)},this.handleTranscription=(e,t)=>{const n=t.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(t.transcribedParticipantIdentity),i=null===n||void 0===n?void 0:n.trackPublications.get(t.trackId),r=function(e,t){return e.segments.map(e=>{let{id:n,text:i,language:r,startTime:o,endTime:a,final:s}=e;var c;const l=null!==(c=t.get(n))&&void 0!==c?c:Date.now(),u=Date.now();return s?t.delete(n):t.set(n,l),{id:n,text:i,startTime:Number.parseInt(o.toString()),endTime:Number.parseInt(a.toString()),final:s,language:r,firstReceivedTime:l,lastReceivedTime:u}})}(t,this.transcriptionReceivedTimes);null===i||void 0===i||i.emit(Za.TranscriptionReceived,r),null===n||void 0===n||n.emit(Ya.TranscriptionReceived,r,i),this.emit($a.TranscriptionReceived,r,n,i)},this.handleChatMessage=(e,t)=>{const n=function(e){const{id:t,timestamp:n,message:i,editTimestamp:r}=e;return{id:t,timestamp:Number.parseInt(n.toString()),editTimestamp:r?Number.parseInt(r.toString()):void 0,message:i}}(t);this.emit($a.ChatMessage,n,e)},this.handleMetrics=(e,t)=>{this.emit($a.MetricsReceived,e,t)},this.handleDataStream=(e,t)=>{this.incomingDataStreamManager.handleDataStreamPacket(e,t)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit($a.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=e=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:e})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit($a.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit($a.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit($a.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>Ro(this,void 0,void 0,function*(){var e;"iOS"!==(null===(e=ds())||void 0===e?void 0:e.os)&&(yield this.selectDefaultDevices()),this.emit($a.MediaDevicesChanged)}),this.handleRoomUpdate=e=>{const t=this.roomInfo;this.roomInfo=e,t&&t.metadata!==e.metadata&&this.emitWhenConnected($a.RoomMetadataChanged,e.metadata),(null===t||void 0===t?void 0:t.activeRecording)!==e.activeRecording&&this.emitWhenConnected($a.RecordingStatusChanged,e.activeRecording)},this.handleConnectionQualityUpdate=e=>{e.updates.forEach(e=>{if(e.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(e.quality);const t=this.getRemoteParticipantBySid(e.participantSid);t&&t.setConnectionQuality(e.quality)})},this.onLocalParticipantMetadataChanged=e=>{this.emit($a.ParticipantMetadataChanged,e,this.localParticipant)},this.onLocalParticipantNameChanged=e=>{this.emit($a.ParticipantNameChanged,e,this.localParticipant)},this.onLocalAttributesChanged=e=>{this.emit($a.ParticipantAttributesChanged,e,this.localParticipant)},this.onLocalTrackMuted=e=>{this.emit($a.TrackMuted,e,this.localParticipant)},this.onLocalTrackUnmuted=e=>{this.emit($a.TrackUnmuted,e,this.localParticipant)},this.onTrackProcessorUpdate=e=>{var t;null===(t=null===e||void 0===e?void 0:e.onPublish)||void 0===t||t.call(e,this)},this.onLocalTrackPublished=e=>Ro(this,void 0,void 0,function*(){var t,n,i,r,o,a;if(null===(t=e.track)||void 0===t||t.on(Za.TrackProcessorUpdate,this.onTrackProcessorUpdate),null===(n=e.track)||void 0===n||n.on(Za.Restarted,this.onLocalTrackRestarted),null===(o=null===(r=null===(i=e.track)||void 0===i?void 0:i.getProcessor())||void 0===r?void 0:r.onPublish)||void 0===o||o.call(r,this),this.emit($a.LocalTrackPublished,e,this.localParticipant),fc(e.track)){(yield e.track.checkForSilence())&&this.emit($a.LocalAudioSilenceDetected,e)}const s=yield null===(a=e.track)||void 0===a?void 0:a.getDeviceId(!1),c=Cc(e.source);c&&s&&s!==this.localParticipant.activeDeviceMap.get(c)&&(this.localParticipant.activeDeviceMap.set(c,s),this.emit($a.ActiveDeviceChanged,c,s))}),this.onLocalTrackUnpublished=e=>{var t,n;null===(t=e.track)||void 0===t||t.off(Za.TrackProcessorUpdate,this.onTrackProcessorUpdate),null===(n=e.track)||void 0===n||n.off(Za.Restarted,this.onLocalTrackRestarted),this.emit($a.LocalTrackUnpublished,e,this.localParticipant)},this.onLocalTrackRestarted=e=>Ro(this,void 0,void 0,function*(){const t=yield e.getDeviceId(!1),n=Cc(e.source);n&&t&&t!==this.localParticipant.activeDeviceMap.get(n)&&(this.log.debug("local track restarted, setting ".concat(n," ").concat(t," active"),this.logContext),this.localParticipant.activeDeviceMap.set(n,t),this.emit($a.ActiveDeviceChanged,n,t))}),this.onLocalConnectionQualityChanged=e=>{this.emit($a.ConnectionQualityChanged,e,this.localParticipant)},this.onMediaDevicesError=(e,t)=>{this.emit($a.MediaDevicesError,e,t)},this.onLocalParticipantPermissionsChanged=e=>{this.emit($a.ParticipantPermissionsChanged,e,this.localParticipant)},this.onLocalChatMessageSent=e=>{this.emit($a.ChatMessage,e,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},gl),e),this.log=To(null!==(n=this.options.loggerName)&&void 0!==n?n:bo.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},fl),null===e||void 0===e?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},ml),null===e||void 0===e?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},pl),null===e||void 0===e?void 0:e.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new nu,this.outgoingDataStreamManager=new au(this.engine,this.log),this.disconnectLock=new xt,this.localParticipant=new bu("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",oc(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",oc(this.options.audioCaptureDefaults.deviceId)),(null===(i=this.options.audioOutput)||void 0===i?void 0:i.deviceId)&&this.switchActiveDevice("audiooutput",oc(this.options.audioOutput.deviceId)).catch(e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext)),Vs()){const e=new AbortController;null===(r=navigator.mediaDevices)||void 0===r||r.addEventListener("devicechange",this.handleDeviceChange,{signal:e.signal}),Tu.cleanupRegistry&&Tu.cleanupRegistry.register(this,()=>{e.abort()})}}registerTextStreamHandler(e,t){return this.incomingDataStreamManager.registerTextStreamHandler(e,t)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,t){return this.incomingDataStreamManager.registerByteStreamHandler(e,t)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,t){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return Ro(this,void 0,void 0,function*(){if(!this.e2eeManager)throw Error("e2ee not configured, please set e2ee settings within the room options");yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),""!==this.localParticipant.identity&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity)})}setupE2EE(){var e;const t=!!this.options.encryption,n=this.options.encryption||this.options.e2ee;n&&("e2eeManager"in n?(this.e2eeManager=n.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=t):this.e2eeManager=new Ic(n,t),this.e2eeManager.on(za.ParticipantEncryptionStatusChanged,(e,t)=>{t.isLocal&&(this.isE2EEEnabled=e),this.emit($a.ParticipantEncryptionStatusChanged,e,t)}),this.e2eeManager.on(za.EncryptionError,e=>this.emit($a.EncryptionError,e)),null===(e=this.e2eeManager)||void 0===e||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:null===(e=this.roomInfo)||void 0===e?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.activeRecording)&&void 0!==t&&t}getSid(){return Ro(this,void 0,void 0,function*(){return this.state===vu.Disconnected?"":this.roomInfo&&""!==this.roomInfo.sid?this.roomInfo.sid:new Promise((e,t)=>{const n=t=>{""!==t.sid&&(this.engine.off(Xa.RoomUpdate,n),e(t.sid))};this.engine.on(Xa.RoomUpdate,n),this.once($a.Disconnected,()=>{this.engine.off(Xa.RoomUpdate,n),t("Room disconnected before room server id was available")})})})}get name(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.name)&&void 0!==t?t:""}get metadata(){var e;return null===(e=this.roomInfo)||void 0===e?void 0:e.metadata}get numParticipants(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numParticipants)&&void 0!==t?t:0}get numPublishers(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numPublishers)&&void 0!==t?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new Ql(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(Xa.ParticipantUpdate,this.handleParticipantUpdates).on(Xa.RoomUpdate,this.handleRoomUpdate).on(Xa.SpeakersChanged,this.handleSpeakersChanged).on(Xa.StreamStateChanged,this.handleStreamStateUpdate).on(Xa.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Xa.SubscriptionError,this.handleSubscriptionError).on(Xa.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Xa.MediaTrackAdded,(e,t,n)=>{this.onTrackAdded(e,t,n)}).on(Xa.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Xa.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Xa.DataPacketReceived,this.handleDataPacket).on(Xa.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(vu.SignalReconnecting)&&this.emit($a.SignalReconnecting)}).on(Xa.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(vu.Connected)&&this.emit($a.Reconnected)}).on(Xa.SignalResumed,()=>{this.bufferedEvents=[],(this.state===vu.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(Xa.Restarting,this.handleRestarting).on(Xa.SignalRestarted,this.handleSignalRestarted).on(Xa.Offline,()=>{this.setAndEmitConnectionState(vu.Reconnecting)&&this.emit($a.Reconnecting)}).on(Xa.DCBufferStatusChanged,(e,t)=>{this.emit($a.DCBufferStatusChanged,e,t)}).on(Xa.LocalTrackSubscribed,e=>{const t=this.localParticipant.getTrackPublications().find(t=>{let{trackSid:n}=t;return n===e});t?(this.localParticipant.emit(Ya.LocalTrackSubscribed,t),this.emitWhenConnected($a.LocalTrackSubscribed,t,this.localParticipant)):this.log.warn("could not find local track subscription for subscribed event",this.logContext)}).on(Xa.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((e,t)=>{this.handleParticipantDisconnected(t,e)}),this.emit($a.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Dc.getInstance().getDevices(e,t)}prepareConnection(e,t){return Ro(this,void 0,void 0,function*(){if(this.state===vu.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Hs(new URL(e))&&t){this.regionUrlProvider=new Xl(e,t);const n=yield this.regionUrlProvider.getNextBestRegionUrl();n&&this.state===vu.Disconnected&&(this.regionUrl=n,yield fetch(ac(n),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(n),this.logContext))}else yield fetch(ac(e),{method:"HEAD"})}catch(dp){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:dp}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return Ro(this,void 0,void 0,function*(){let n,i=()=>Ro(this,void 0,void 0,function*(){});switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":n=new Zr({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":n=new Zr({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":n=new Zr({scenario:{case:"serverLeave",value:!0}});break;case"migration":n=new Zr({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":i=()=>Ro(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),n=new Zr({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":i=()=>Ro(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),n=new Zr({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":n=new Zr({scenario:{case:"switchCandidateProtocol",value:"force-tls"===e?2:1}}),i=()=>Ro(this,void 0,void 0,function*(){const e=this.engine.client.onLeave;e&&e(new Ir({reason:bi.CLIENT_INITIATED,action:Nr.RECONNECT}))});break;case"subscriber-bandwidth":if(void 0===t||"number"!==typeof t)throw new Error("subscriber-bandwidth requires a number as argument");n=new Zr({scenario:{case:"subscriberBandwidth",value:lc(t)}});break;case"leave-full-reconnect":n=new Zr({scenario:{case:"leaveRequestFullReconnect",value:!0}})}n&&(yield this.engine.client.sendSimulateScenario(n),yield i())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){return Ro(this,arguments,void 0,function(e,t){var n=this;let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function*(){var r,o,a,s,c,l,u;let d=!0,h=!1;const p=i?{exact:t}:t;if("audioinput"===e){h=0===n.localParticipant.audioTrackPublications.size;const t=null!==(r=n.getActiveDevice(e))&&void 0!==r?r:n.options.audioCaptureDefaults.deviceId;n.options.audioCaptureDefaults.deviceId=p;const i=Array.from(n.localParticipant.audioTrackPublications.values()).filter(e=>e.source===ys.Source.Microphone);try{d=(yield Promise.all(i.map(e=>{var t;return null===(t=e.audioTrack)||void 0===t?void 0:t.setDeviceId(p)}))).every(e=>!0===e)}catch(dp){throw n.options.audioCaptureDefaults.deviceId=t,dp}const o=i.some(e=>{var t,n;return null!==(n=null===(t=e.track)||void 0===t?void 0:t.isMuted)&&void 0!==n&&n});d&&o&&(h=!0)}else if("videoinput"===e){h=0===n.localParticipant.videoTrackPublications.size;const t=null!==(o=n.getActiveDevice(e))&&void 0!==o?o:n.options.videoCaptureDefaults.deviceId;n.options.videoCaptureDefaults.deviceId=p;const i=Array.from(n.localParticipant.videoTrackPublications.values()).filter(e=>e.source===ys.Source.Camera);try{d=(yield Promise.all(i.map(e=>{var t;return null===(t=e.videoTrack)||void 0===t?void 0:t.setDeviceId(p)}))).every(e=>!0===e)}catch(dp){throw n.options.videoCaptureDefaults.deviceId=t,dp}const r=i.some(e=>{var t,n;return null!==(n=null===(t=e.track)||void 0===t?void 0:t.isMuted)&&void 0!==n&&n});d&&r&&(h=!0)}else if("audiooutput"===e){if(h=!0,!As()&&!n.options.webAudioMix||n.options.webAudioMix&&n.audioContext&&!("setSinkId"in n.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");n.options.webAudioMix&&(t=null!==(a=yield Dc.getInstance().normalizeDeviceId("audiooutput",t))&&void 0!==a?a:""),null!==(s=(u=n.options).audioOutput)&&void 0!==s||(u.audioOutput={});const i=null!==(c=n.getActiveDevice(e))&&void 0!==c?c:n.options.audioOutput.deviceId;n.options.audioOutput.deviceId=t;try{n.options.webAudioMix&&(null===(l=n.audioContext)||void 0===l||l.setSinkId(t)),yield Promise.all(Array.from(n.remoteParticipants.values()).map(e=>e.setAudioOutput({deviceId:t})))}catch(dp){throw n.options.audioOutput.deviceId=i,dp}}return h&&(n.localParticipant.activeDeviceMap.set(e,t),n.emit($a.ActiveDeviceChanged,e,t)),d}()})}setupLocalParticipantEvents(){this.localParticipant.on(Ya.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Ya.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Ya.AttributesChanged,this.onLocalAttributesChanged).on(Ya.TrackMuted,this.onLocalTrackMuted).on(Ya.TrackUnmuted,this.onLocalTrackUnmuted).on(Ya.LocalTrackPublished,this.onLocalTrackPublished).on(Ya.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Ya.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Ya.MediaDevicesError,this.onMediaDevicesError).on(Ya.AudioStreamAcquired,this.startAudio).on(Ya.ChatMessage,this.onLocalChatMessageSent).on(Ya.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;null===(e=this.engine)||void 0===e||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,n){if(this.state===vu.Connecting||this.state===vu.Reconnecting){const i=()=>{this.log.debug("deferring on track for later",{mediaTrackId:e.id,mediaStreamId:t.id,tracksInStream:t.getTracks().map(e=>e.id)}),this.onTrackAdded(e,t,n),r()},r=()=>{this.off($a.Reconnected,i),this.off($a.Connected,i),this.off($a.Disconnected,r)};return this.once($a.Reconnected,i),this.once($a.Connected,i),void this.once($a.Disconnected,r)}if(this.state===vu.Disconnected)return void this.log.warn("skipping incoming track after Room disconnected",this.logContext);if("ended"===e.readyState)return void this.log.info("skipping incoming track as it already ended",this.logContext);const i=function(e){const t=e.split("|");return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]}(t.id),r=i[0];let o=i[1],a=e.id;if(o&&o.startsWith("TR")&&(a=o),r===this.localParticipant.sid)return void this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);const s=Array.from(this.remoteParticipants.values()).find(e=>e.sid===r);if(!s)return void this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(r),this.logContext);if(!a.startsWith("TR")){const e=this.engine.getTrackIdForReceiver(n);if(!e)return void this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(r),this.logContext);a=e}let c;a.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(r,", streamId: ").concat(o,", trackId: ").concat(a),Object.assign(Object.assign({},this.logContext),{rpID:r,streamId:o,trackId:a})),this.options.adaptiveStream&&(c="object"===typeof this.options.adaptiveStream?this.options.adaptiveStream:{});const l=s.addSubscribedMediaTrack(e,a,t,n,c);(null===l||void 0===l?void 0:l.isEncrypted)&&!this.e2eeManager&&this.emit($a.EncryptionError,new Error("Encrypted ".concat(l.source," track received from participant ").concat(s.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;var n;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearHandlersAndControllers(),this.state!==vu.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(e=>{e.trackPublications.forEach(t=>{e.unpublishTrack(t.trackSid)})}),this.localParticipant.trackPublications.forEach(t=>{var n,i,r;t.track&&this.localParticipant.unpublishTrack(t.track,e),e?(null===(n=t.track)||void 0===n||n.detach(),null===(i=t.track)||void 0===i||i.stop()):null===(r=t.track)||void 0===r||r.stopMonitor()}),this.localParticipant.off(Ya.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Ya.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Ya.AttributesChanged,this.onLocalAttributesChanged).off(Ya.TrackMuted,this.onLocalTrackMuted).off(Ya.TrackUnmuted,this.onLocalTrackUnmuted).off(Ya.LocalTrackPublished,this.onLocalTrackPublished).off(Ya.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Ya.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Ya.MediaDevicesError,this.onMediaDevicesError).off(Ya.AudioStreamAcquired,this.startAudio).off(Ya.ChatMessage,this.onLocalChatMessageSent).off(Ya.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&"boolean"===typeof this.options.webAudioMix&&(this.audioContext.close(),this.audioContext=void 0),Vs()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),null===(n=navigator.mediaDevices)||void 0===n||n.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(vu.Disconnected),this.emit($a.Disconnected,t)}}}handleParticipantDisconnected(e,t){var n;this.remoteParticipants.delete(e),t&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),t.trackPublications.forEach(e=>{t.unpublishTrack(e.trackSid,!0)}),this.emit($a.ParticipantDisconnected,t),t.setDisconnected(),null===(n=this.localParticipant)||void 0===n||n.handleParticipantDisconnected(t.identity))}handleIncomingRpcRequest(e,t,n,i,r,o){return Ro(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,t),1!==o)return void(yield this.engine.publishRpcResponse(e,t,null,kl.builtIn("UNSUPPORTED_VERSION")));const a=this.rpcHandlers.get(n);if(!a)return void(yield this.engine.publishRpcResponse(e,t,null,kl.builtIn("UNSUPPORTED_METHOD")));let s=null,c=null;try{const o=yield a({requestId:t,callerIdentity:e,payload:i,responseTimeout:r});Sl(o)>15360?(s=kl.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(n))):c=o}catch(l){l instanceof kl?s=l:(console.warn("Uncaught error returned by RPC handler for ".concat(n,". Returning APPLICATION_ERROR instead."),l),s=kl.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,t,c,s)})}selectDefaultDevices(){return Ro(this,void 0,void 0,function*(){var e,t,n;const i=Dc.getInstance().previousDevices,r=yield Dc.getInstance().getDevices(void 0,!1),o=ds();if("Chrome"===(null===o||void 0===o?void 0:o.name)&&"iOS"!==o.os)for(let s of r){const e=i.find(e=>e.deviceId===s.deviceId);e&&""!==e.label&&e.kind===s.kind&&e.label!==s.label&&"default"===this.getActiveDevice(s.kind)&&this.emit($a.ActiveDeviceChanged,s.kind,s.deviceId)}const a=["audiooutput","audioinput","videoinput"];for(let s of a){const o=wc(s),a=this.localParticipant.getTrackPublication(o);if(a&&(null===(e=a.track)||void 0===e?void 0:e.isUserProvided))continue;const c=r.filter(e=>e.kind===s),l=this.getActiveDevice(s);l===(null===(t=i.filter(e=>e.kind===s)[0])||void 0===t?void 0:t.deviceId)&&c.length>0&&(null===(n=c[0])||void 0===n?void 0:n.deviceId)!==l?yield this.switchActiveDevice(s,c[0].deviceId):"audioinput"===s&&!Fs()||"videoinput"===s||!(c.length>0)||c.find(e=>e.deviceId===this.getActiveDevice(s))||"audiooutput"===s&&Fs()||(yield this.switchActiveDevice(s,c[0].deviceId))}})}acquireAudioContext(){return Ro(this,void 0,void 0,function*(){var e,t;if("boolean"!==typeof this.options.webAudioMix&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:this.audioContext&&"closed"!==this.audioContext.state||(this.audioContext=null!==(e=Tc())&&void 0!==e?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(e=>e.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&"suspended"===this.audioContext.state)try{yield Promise.race([this.audioContext.resume(),Is(200)])}catch(dp){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:dp}))}const n="running"===(null===(t=this.audioContext)||void 0===t?void 0:t.state);n!==this.canPlaybackAudio&&(this.audioEnabled=n,this.emit($a.AudioPlaybackStatusChanged,n))})}createParticipant(e,t){var n;let i;return i=t?Su.fromParticipantInfo(this.engine.client,t,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):new Su(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&i.setAudioContext(this.audioContext),(null===(n=this.options.audioOutput)||void 0===n?void 0:n.deviceId)&&i.setAudioOutput(this.options.audioOutput).catch(e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext)),i}getOrCreateParticipant(e,t){if(this.remoteParticipants.has(e)){const n=this.remoteParticipants.get(e);if(t){n.updateInfo(t)&&this.sidToIdentity.set(t.sid,t.identity)}return n}const n=this.createParticipant(e,t);return this.remoteParticipants.set(e,n),this.sidToIdentity.set(t.sid,t.identity),this.emitWhenConnected($a.ParticipantConnected,n),n.on(Ya.TrackPublished,e=>{this.emitWhenConnected($a.TrackPublished,e,n)}).on(Ya.TrackSubscribed,(e,t)=>{e.kind===ys.Kind.Audio?(e.on(Za.AudioPlaybackStarted,this.handleAudioPlaybackStarted),e.on(Za.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):e.kind===ys.Kind.Video&&(e.on(Za.VideoPlaybackFailed,this.handleVideoPlaybackFailed),e.on(Za.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit($a.TrackSubscribed,e,t,n)}).on(Ya.TrackUnpublished,e=>{this.emit($a.TrackUnpublished,e,n)}).on(Ya.TrackUnsubscribed,(e,t)=>{this.emit($a.TrackUnsubscribed,e,t,n)}).on(Ya.TrackMuted,e=>{this.emitWhenConnected($a.TrackMuted,e,n)}).on(Ya.TrackUnmuted,e=>{this.emitWhenConnected($a.TrackUnmuted,e,n)}).on(Ya.ParticipantMetadataChanged,e=>{this.emitWhenConnected($a.ParticipantMetadataChanged,e,n)}).on(Ya.ParticipantNameChanged,e=>{this.emitWhenConnected($a.ParticipantNameChanged,e,n)}).on(Ya.AttributesChanged,e=>{this.emitWhenConnected($a.ParticipantAttributesChanged,e,n)}).on(Ya.ConnectionQualityChanged,e=>{this.emitWhenConnected($a.ConnectionQualityChanged,e,n)}).on(Ya.ParticipantPermissionsChanged,e=>{this.emitWhenConnected($a.ParticipantPermissionsChanged,e,n)}).on(Ya.TrackSubscriptionStatusChanged,(e,t)=>{this.emitWhenConnected($a.TrackSubscriptionStatusChanged,e,t,n)}).on(Ya.TrackSubscriptionFailed,(e,t)=>{this.emit($a.TrackSubscriptionFailed,e,n,t)}).on(Ya.TrackSubscriptionPermissionChanged,(e,t)=>{this.emitWhenConnected($a.TrackSubscriptionPermissionChanged,e,t,n)}).on(Ya.Active,()=>{this.emitWhenConnected($a.ParticipantActive,n),n.kind===xi.AGENT&&this.localParticipant.setActiveAgent(n)}),t&&n.updateInfo(t),n}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((e,t)=>(e.push(...t.getTrackPublications()),e),[]),t=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const t of e.videoTrackPublications.values())t.isSubscribed&&gc(t)&&t.emitTrackUpdate()}getRemoteParticipantBySid(e){const t=this.sidToIdentity.get(e);if(t)return this.remoteParticipants.get(t)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=ms.setInterval(()=>{this.engine&&!this.engine.isClosed&&this.engine.verifyTransport()?e=0:(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,bi.STATE_MISMATCH)))},4e3)}clearConnectionReconcile(){this.connectionReconcileInterval&&ms.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e!==this.state&&(this.state=e,this.emit($a.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,n]=e;this.emit(t,...n)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(this.state===vu.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,n]);else if(this.state===vu.Connected)return this.emit(e,...n);return!1}simulateParticipants(e){return Ro(this,void 0,void 0,function*(){var t,n;const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),r=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new wi({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:$t.parse((new Date).getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Pi({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit($a.SignalConnected),this.emit($a.Connected),this.setAndEmitConnectionState(vu.Connected),i.video){const e=new fu(ys.Kind.Video,new Ni({source:mi.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:fi.AUDIO,name:"video-dummy"}),new zl(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:nc(160*(null!==(t=r.aspectRatios[0])&&void 0!==t?t:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(Ya.LocalTrackPublished,e)}if(i.audio){const e=new fu(ys.Kind.Audio,new Ni({source:mi.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:fi.AUDIO}),new Ol(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:ic(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(Ya.LocalTrackPublished,e)}for(let e=0;e<r.count-1;e+=1){let t=new Pi({sid:Math.floor(1e4*Math.random()).toString(),identity:"simulated-".concat(e),state:Ri.ACTIVE,tracks:[],joinedAt:$t.parse(Date.now())});const i=this.getOrCreateParticipant(t.identity,t);if(r.video){const o=nc(160*(null!==(n=r.aspectRatios[e%r.aspectRatios.length])&&void 0!==n?n:1),160,!1,!0),a=new Ni({source:mi.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:fi.AUDIO});i.addSubscribedMediaTrack(o,a.sid,new MediaStream([o]),new RTCRtpReceiver),t.tracks=[...t.tracks,a]}if(r.audio){const e=ic(),n=new Ni({source:mi.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:fi.AUDIO});i.addSubscribedMediaTrack(e,n.sid,new MediaStream([e]),new RTCRtpReceiver),t.tracks=[...t.tracks,n]}i.updateInfo(t)}})}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e!==$a.ActiveSpeakersChanged&&e!==$a.TranscriptionReceived){const t=wu(n).filter(e=>void 0!==e);e!==$a.TrackSubscribed&&e!==$a.TrackUnsubscribed||this.log.trace("subscribe trace: ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:t})),this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:t}))}return super.emit(e,...n)}}function wu(e){return e.map(e=>{if(e)return Array.isArray(e)?wu(e):"object"===typeof e?"logContext"in e?e.logContext:void 0:e})}Tu.cleanupRegistry="undefined"!==typeof FinalizationRegistry&&new FinalizationRegistry(e=>{e()});var Cu;!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.SKIPPED=2]="SKIPPED",e[e.SUCCESS=3]="SUCCESS",e[e.FAILED=4]="FAILED"}(Cu||(Cu={}));No.EventEmitter;No.EventEmitter;function Eu(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}new TextEncoder;new TextDecoder;class Pu extends Error{constructor(e,t){var n;super(e,t),Eu(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,null===(n=Error.captureStackTrace)||void 0===n||n.call(Error,this,this.constructor)}}Eu(Pu,"code","ERR_JOSE_GENERIC");Eu(class extends Pu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";super(e,{cause:{claim:n,reason:i,payload:t}}),Eu(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),Eu(this,"claim",void 0),Eu(this,"reason",void 0),Eu(this,"payload",void 0),this.claim=n,this.reason=i,this.payload=t}},"code","ERR_JWT_CLAIM_VALIDATION_FAILED");Eu(class extends Pu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";super(e,{cause:{claim:n,reason:i,payload:t}}),Eu(this,"code","ERR_JWT_EXPIRED"),Eu(this,"claim",void 0),Eu(this,"reason",void 0),Eu(this,"payload",void 0),this.claim=n,this.reason=i,this.payload=t}},"code","ERR_JWT_EXPIRED");Eu(class extends Pu{constructor(){super(...arguments),Eu(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}},"code","ERR_JOSE_ALG_NOT_ALLOWED");Eu(class extends Pu{constructor(){super(...arguments),Eu(this,"code","ERR_JOSE_NOT_SUPPORTED")}},"code","ERR_JOSE_NOT_SUPPORTED");Eu(class extends Pu{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"decryption operation failed",arguments.length>1?arguments[1]:void 0),Eu(this,"code","ERR_JWE_DECRYPTION_FAILED")}},"code","ERR_JWE_DECRYPTION_FAILED");Eu(class extends Pu{constructor(){super(...arguments),Eu(this,"code","ERR_JWE_INVALID")}},"code","ERR_JWE_INVALID");Eu(class extends Pu{constructor(){super(...arguments),Eu(this,"code","ERR_JWS_INVALID")}},"code","ERR_JWS_INVALID");class Ru extends Pu{constructor(){super(...arguments),Eu(this,"code","ERR_JWT_INVALID")}}Eu(Ru,"code","ERR_JWT_INVALID");Eu(class extends Pu{constructor(){super(...arguments),Eu(this,"code","ERR_JWK_INVALID")}},"code","ERR_JWK_INVALID");Eu(class extends Pu{constructor(){super(...arguments),Eu(this,"code","ERR_JWKS_INVALID")}},"code","ERR_JWKS_INVALID");Eu(class extends Pu{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"no applicable key found in the JSON Web Key Set",arguments.length>1?arguments[1]:void 0),Eu(this,"code","ERR_JWKS_NO_MATCHING_KEY")}},"code","ERR_JWKS_NO_MATCHING_KEY");Eu(class extends Pu{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"multiple matching keys found in the JSON Web Key Set",arguments.length>1?arguments[1]:void 0),Eu(this,Symbol.asyncIterator,void 0),Eu(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}},"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");Eu(class extends Pu{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"request timed out",arguments.length>1?arguments[1]:void 0),Eu(this,"code","ERR_JWKS_TIMEOUT")}},"code","ERR_JWKS_TIMEOUT");Eu(class extends Pu{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"signature verification failed",arguments.length>1?arguments[1]:void 0),Eu(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}},"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);Math.min,Math.max,Math.round,Math.floor;var xu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ou(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _u,Iu={exports:{}},Nu=Iu.exports;var Du=(_u||(_u=1,function(e){var t,n;t=Nu,n=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],r={},o=null;function a(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(i){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(){for(var n=this.getLevel(),r=0;r<i.length;r++){var o=i[r];this[o]=r<n?e:this.methodFactory(o,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function l(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function u(i,r,o){return function(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?s:void 0!==console[i]?a(console,i):void 0!==console.log?a(console,"log"):e)}(i)||l.apply(this,arguments)}function d(e,n){var a,s,l,d=this,h="loglevel";function p(){var e;if(typeof window!==t&&h){try{e=window.localStorage[h]}catch(o){}if(typeof e===t)try{var n=window.document.cookie,i=encodeURIComponent(h),r=n.indexOf(i+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r+i.length+1))[1])}catch(a){}return void 0===d.levels[e]&&(e=void 0),e}}function f(e){var t=e;if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?h+=":"+e:"symbol"==typeof e&&(h=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||u,d.getLevel=function(){var e;return null!==(e=null!==l&&void 0!==l?l:s)&&void 0!==e?e:a},d.setLevel=function(e,n){return l=f(e),!1!==n&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&h){try{return void(window.localStorage[h]=n)}catch(r){}try{window.document.cookie=encodeURIComponent(h)+"="+n+";"}catch(o){}}}(l),c.call(d)},d.setDefaultLevel=function(e){s=f(e),p()||d.setLevel(e,!1)},d.resetLevel=function(){l=null,function(){if(typeof window!==t&&h){try{window.localStorage.removeItem(h)}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(n){}}}(),c.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(o!==d&&(a=f(o.getLevel())),c.call(d),o===d)for(var e in r)r[e].rebuild()},a=f(o?o.getLevel():"WARN");var m=p();null!=m&&(l=f(m)),c.call(d)}(o=new d).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=r[e];return t||(t=r[e]=new d(e,o.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=h),o},o.getLoggers=function(){return r},o.default=o,o},e.exports?e.exports=n():t.log=n()}(Iu)),Iu.exports);const Mu=Ou(Du);var Au=function(e,t){return Au=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Au(e,t)};function Lu(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Au(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function Uu(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{c(i.next(e))}catch(t){o(t)}}function s(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,s)}c((i=i.apply(e,t||[])).next())})}function ju(e,t){var n,i,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(c){s=[6,c],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}function Fu(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Bu(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(s){r={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function zu(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function Vu(e){return this instanceof Vu?(this.v=e,this):new Vu(e)}function qu(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,l)}}),i[Symbol.asyncIterator]=function(){return this},i;function a(e,t){r[e]&&(i[e]=function(t){return new Promise(function(n,i){o.push([e,t,n,i])>1||s(e,t)})},t&&(i[e]=t(i[e])))}function s(e,t){try{!function(e){e.value instanceof Vu?Promise.resolve(e.value.v).then(c,l):u(o[0][2],e)}(r[e](t))}catch(n){u(o[0][3],n)}}function c(e){s("next",e)}function l(e){s("throw",e)}function u(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function Hu(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Fu(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,r){(function(e,t,n,i){Promise.resolve(i).then(function(t){e({value:t,done:n})},t)})(i,r,(t=e[n](t)).done,t.value)})}}}function Wu(e){return"function"==typeof e}function Gu(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Ku=Gu(function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}});function Ju(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Qu=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,i,r;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Fu(o),s=a.next();!s.done;s=a.next()){s.value.remove(this)}}catch(p){e={error:p}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else o.remove(this);var c=this.initialTeardown;if(Wu(c))try{c()}catch(p){r=p instanceof Ku?p.errors:[p]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var u=Fu(l),d=u.next();!d.done;d=u.next()){var h=d.value;try{Xu(h)}catch(p){r=null!==r&&void 0!==r?r:[],p instanceof Ku?r=zu(zu([],Bu(r)),Bu(p.errors)):r.push(p)}}}catch(p){n={error:p}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}if(r)throw new Ku(r)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Xu(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Ju(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&Ju(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),$u=Qu.EMPTY;function Yu(e){return e instanceof Qu||e&&"closed"in e&&Wu(e.remove)&&Wu(e.add)&&Wu(e.unsubscribe)}function Xu(e){Wu(e)?e():e.unsubscribe()}var Zu=void 0,ed=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setTimeout.apply(void 0,zu([e,t],Bu(n)))};function td(e){ed(function(){throw e})}function nd(){}function id(e){e()}var rd=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,Yu(t)&&t.add(n)):n.destination=cd,n}return Lu(t,e),t.create=function(e,t,n){return new ad(e,t,n)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Qu),od=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(rl){sd(rl)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(rl){sd(rl)}else sd(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){sd(t)}},e}(),ad=function(e){function t(t,n,i){var r,o=e.call(this)||this;return r=Wu(t)||!t?{next:null!==t&&void 0!==t?t:void 0,error:null!==n&&void 0!==n?n:void 0,complete:null!==i&&void 0!==i?i:void 0}:t,o.destination=new od(r),o}return Lu(t,e),t}(rd);function sd(e){td(e)}var cd={closed:!0,next:nd,error:function(e){throw e},complete:nd},ld="function"==typeof Symbol&&Symbol.observable||"@@observable";function ud(e){return e}var dd=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var i=this,r=function(e){return e&&e instanceof rd||function(e){return e&&Wu(e.next)&&Wu(e.error)&&Wu(e.complete)}(e)&&Yu(e)}(e)?e:new ad(e,t,n);return id(function(){var e=i,t=e.operator,n=e.source;r.add(t?t.call(r,n):n?i._subscribe(r):i._trySubscribe(r))}),r},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=hd(t))(function(t,i){var r=new ad({next:function(t){try{e(t)}catch(n){i(n),r.unsubscribe()}},error:i,complete:t});n.subscribe(r)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[ld]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(e){return 0===e.length?ud:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=hd(e))(function(e,n){var i;t.subscribe(function(e){return i=e},function(e){return n(e)},function(){return e(i)})})},e.create=function(t){return new e(t)},e}();function hd(e){var t;return null!==(t=null!==e&&void 0!==e?e:Zu)&&void 0!==t?t:Promise}function pd(e){return function(t){if(function(e){return Wu(null==e?void 0:e.lift)}(t))return t.lift(function(t){try{return e(t,this)}catch(rl){this.error(rl)}});throw new TypeError("Unable to lift unknown Observable type")}}function fd(e,t,n,i,r){return new md(e,t,n,i,r)}var md=function(e){function t(t,n,i,r,o,a){var s=e.call(this,t)||this;return s.onFinalize=o,s.shouldUnsubscribe=a,s._next=n?function(e){try{n(e)}catch(i){t.error(i)}}:e.prototype._next,s._error=r?function(e){try{r(e)}catch(n){t.error(n)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=i?function(){try{i()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return Lu(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(rd),gd=Gu(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),vd=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return Lu(t,e),t.prototype.lift=function(e){var t=new yd(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new gd},t.prototype.next=function(e){var t=this;id(function(){var n,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var r=Fu(t.currentObservers),o=r.next();!o.done;o=r.next()){o.value.next(e)}}catch(a){n={error:a}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}}})},t.prototype.error=function(e){var t=this;id(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})},t.prototype.complete=function(){var e=this;id(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,i=n.hasError,r=n.isStopped,o=n.observers;return i||r?$u:(this.currentObservers=null,o.push(e),new Qu(function(){t.currentObservers=null,Ju(o,e)}))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,i=t.thrownError,r=t.isStopped;n?e.error(i):r&&e.complete()},t.prototype.asObservable=function(){var e=new dd;return e.source=this,e},t.create=function(e,t){return new yd(e,t)},t}(dd),yd=function(e){function t(t,n){var i=e.call(this)||this;return i.destination=t,i.source=n,i}return Lu(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:$u},t}(vd),bd=(function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}Lu(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,i=e._value;if(t)throw n;return this._throwIfClosed(),i},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)}}(vd),function(){return Date.now()}),kd=function(e){function t(t,n){return e.call(this)||this}return Lu(t,e),t.prototype.schedule=function(e,t){return this},t}(Qu),Sd=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setInterval.apply(void 0,zu([e,t],Bu(n)))},Td=function(e){return clearInterval(e)},wd=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return Lu(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),Sd(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&Td(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,i=!1;try{this.work(e)}catch(r){i=!0,n=r||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,i=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Ju(i,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(kd),Cd=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=bd,e}(),Ed=function(e){function t(t,n){void 0===n&&(n=Cd.now);var i=e.call(this,t,n)||this;return i.actions=[],i._active=!1,i}return Lu(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Cd);new Ed(wd);function Pd(e){return function(e){return e&&Wu(e.schedule)}(function(e){return e[e.length-1]}(e))?e.pop():void 0}var Rd=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function xd(e){return Wu(null==e?void 0:e.then)}function Od(e){return Wu(e[ld])}function _d(e){return Symbol.asyncIterator&&Wu(null==e?void 0:e[Symbol.asyncIterator])}function Id(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Nd="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Dd(e){return Wu(null==e?void 0:e[Nd])}function Md(e){return qu(this,arguments,function(){var t,n,i;return ju(this,function(r){switch(r.label){case 0:t=e.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,Vu(t.read())];case 3:return n=r.sent(),i=n.value,n.done?[4,Vu(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,Vu(i)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Ad(e){return Wu(null==e?void 0:e.getReader)}function Ld(e){if(e instanceof dd)return e;if(null!=e){if(Od(e))return function(e){return new dd(function(t){var n=e[ld]();if(Wu(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(Rd(e))return function(e){return new dd(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(xd(e))return function(e){return new dd(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,td)})}(e);if(_d(e))return Ud(e);if(Dd(e))return function(e){return new dd(function(t){var n,i;try{for(var r=Fu(e),o=r.next();!o.done;o=r.next()){var a=o.value;if(t.next(a),t.closed)return}}catch(s){n={error:s}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}t.complete()})}(e);if(Ad(e))return function(e){return Ud(Md(e))}(e)}throw Id(e)}function Ud(e){return new dd(function(t){(function(e,t){var n,i,r,o;return Uu(this,void 0,void 0,function(){var a,s;return ju(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=Hu(e),c.label=1;case 1:return[4,n.next()];case 2:if((i=c.sent()).done)return[3,4];if(a=i.value,t.next(a),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=c.sent(),r={error:s},[3,11];case 6:return c.trys.push([6,,9,10]),i&&!i.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})})(e,t).catch(function(e){return t.error(e)})})}function jd(e,t,n,i,r){void 0===i&&(i=0),void 0===r&&(r=!1);var o=t.schedule(function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(o),!r)return o}function Fd(e,t){return void 0===t&&(t=0),pd(function(n,i){n.subscribe(fd(i,function(n){return jd(i,e,function(){return i.next(n)},t)},function(){return jd(i,e,function(){return i.complete()},t)},function(n){return jd(i,e,function(){return i.error(n)},t)}))})}function Bd(e,t){return void 0===t&&(t=0),pd(function(n,i){i.add(e.schedule(function(){return n.subscribe(i)},t))})}function zd(e,t){if(!e)throw new Error("Iterable cannot be null");return new dd(function(n){jd(n,t,function(){var i=e[Symbol.asyncIterator]();jd(n,t,function(){i.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function Vd(e,t){if(null!=e){if(Od(e))return function(e,t){return Ld(e).pipe(Bd(t),Fd(t))}(e,t);if(Rd(e))return function(e,t){return new dd(function(n){var i=0;return t.schedule(function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())})})}(e,t);if(xd(e))return function(e,t){return Ld(e).pipe(Bd(t),Fd(t))}(e,t);if(_d(e))return zd(e,t);if(Dd(e))return function(e,t){return new dd(function(n){var i;return jd(n,t,function(){i=e[Nd](),jd(n,t,function(){var e,t,r;try{t=(e=i.next()).value,r=e.done}catch(o){return void n.error(o)}r?n.complete():n.next(t)},0,!0)}),function(){return Wu(null==i?void 0:i.return)&&i.return()}})}(e,t);if(Ad(e))return function(e,t){return zd(Md(e),t)}(e,t)}throw Id(e)}function qd(e,t){return t?Vd(e,t):Ld(e)}Gu(function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}});function Hd(e,t){return pd(function(n,i){var r=0;n.subscribe(fd(i,function(n){i.next(e.call(t,n,r++))}))})}Array.isArray;function Wd(e,t,n){return void 0===n&&(n=1/0),Wu(t)?Wd(function(n,i){return Hd(function(e,r){return t(n,e,i,r)})(Ld(e(n,i)))},n):("number"==typeof t&&(n=t),pd(function(t,i){return function(e,t,n,i,r,o,a){var s=[],c=0,l=0,u=!1,d=function(){u&&!s.length&&!c&&t.complete()},h=function(e){c++;var r=!1;Ld(n(e,l++)).subscribe(fd(t,function(e){t.next(e)},function(){r=!0},void 0,function(){if(r)try{c--;for(var e=function(){var e=s.shift();a||h(e)};s.length&&c<i;)e();d()}catch(n){t.error(n)}}))};return e.subscribe(fd(t,function(e){return c<i?h(e):s.push(e)},function(){u=!0,d()})),function(){}}(t,i,e,n)}))}function Gd(){return function(e){return Wd(ud,e)}(1)}function Kd(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Gd()(qd(e,Pd(e)))}function Jd(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Pd(e);return pd(function(t,i){(n?Kd(e,t,n):Kd(e,t)).subscribe(i)})}var Qd=Object.defineProperty,$d=Object.defineProperties,Yd=Object.getOwnPropertyDescriptors,Xd=Object.getOwnPropertySymbols,Zd=Object.prototype.hasOwnProperty,eh=Object.prototype.propertyIsEnumerable,th=(e,t,n)=>t in e?Qd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nh=(e,t)=>{for(var n in t||(t={}))Zd.call(t,n)&&th(e,n,t[n]);if(Xd)for(var n of Xd(t))eh.call(t,n)&&th(e,n,t[n]);return e},ih=(e,t)=>$d(e,Yd(t));function rh(e){return!(typeof e>"u")&&(function(e){var t;return!!e&&(e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("track")&&typeof(null==(t=e.publication)?void 0:t.track)<"u")}(e)||function(e){return!!e&&(e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("publication")&&typeof e.publication<"u")}(e))}function oh(e){return!!e&&(e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&typeof e.publication>"u")}function ah(e){if("string"==typeof e||"number"==typeof e)return"".concat(e);if(oh(e))return"".concat(e.participant.identity,"_").concat(e.source,"_placeholder");if(rh(e))return"".concat(e.participant.identity,"_").concat(e.publication.source,"_").concat(e.publication.trackSid);throw new Error("Can't generate a id for the given track reference: ".concat(e))}var sh=[...[$a.ConnectionStateChanged,$a.RoomMetadataChanged,$a.ActiveSpeakersChanged,$a.ConnectionQualityChanged,$a.ParticipantConnected,$a.ParticipantDisconnected,$a.ParticipantPermissionsChanged,$a.ParticipantMetadataChanged,$a.ParticipantNameChanged,$a.ParticipantAttributesChanged,$a.TrackMuted,$a.TrackUnmuted,$a.TrackPublished,$a.TrackUnpublished,$a.TrackStreamStateChanged,$a.TrackSubscriptionFailed,$a.TrackSubscriptionPermissionChanged,$a.TrackSubscriptionStatusChanged],$a.LocalTrackPublished,$a.LocalTrackUnpublished],ch=[Ya.TrackPublished,Ya.TrackUnpublished,Ya.TrackMuted,Ya.TrackUnmuted,Ya.TrackStreamStateChanged,Ya.TrackSubscribed,Ya.TrackUnsubscribed,Ya.TrackSubscriptionPermissionChanged,Ya.TrackSubscriptionFailed,Ya.LocalTrackPublished,Ya.LocalTrackUnpublished],lh=(Ya.ConnectionQualityChanged,Ya.IsSpeakingChanged,Ya.ParticipantMetadataChanged,Ya.ParticipantPermissionsChanged,Ya.TrackMuted,Ya.TrackUnmuted,Ya.TrackPublished,Ya.TrackUnpublished,Ya.TrackStreamStateChanged,Ya.TrackSubscriptionFailed,Ya.TrackSubscriptionPermissionChanged,Ya.TrackSubscriptionStatusChanged,Ya.LocalTrackPublished,Ya.LocalTrackUnpublished,Mu.getLogger("lk-components-js"));lh.setDefaultLevel("WARN");function uh(e){return"object"==typeof e}function dh(e){return Array.isArray(e)&&e.filter(uh).length>0}function hh(e){return"".concat("lk","-").concat(e)}function ph(e){if(rh(e))return e.publication;{const{source:t,name:n,participant:i}=e;if(t&&n)return i.getTrackPublications().find(e=>e.source===t&&e.trackName===n);if(n)return i.getTrackPublicationByName(n);if(t)return i.getTrackPublication(t);throw new Error("At least one of source and name needs to be defined")}}function fh(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new dd(t=>{const i=()=>{t.next(e)};return n.forEach(t=>{e.on(t,i)}),()=>{n.forEach(t=>{e.off(t,i)})}}).pipe(Jd(e))}function mh(e,t){return new dd(n=>{const i=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.next(t)};return e.on(t,i),()=>{e.off(t,i)}})}function gh(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new dd(t=>{const i=()=>{t.next(e)};return n.forEach(t=>{e.on(t,i)}),()=>{n.forEach(t=>{e.off(t,i)})}}).pipe(Jd(e))}function vh(e){return gh(e,Ya.TrackMuted,Ya.TrackUnmuted,Ya.ParticipantPermissionsChanged,Ya.TrackPublished,Ya.TrackUnpublished,Ya.LocalTrackPublished,Ya.LocalTrackUnpublished,Ya.MediaDevicesError,Ya.TrackSubscriptionStatusChanged).pipe(Hd(e=>{const{isMicrophoneEnabled:t,isCameraEnabled:n,isScreenShareEnabled:i}=e,r=e.getTrackPublication(ys.Source.Microphone);return{isCameraEnabled:n,isMicrophoneEnabled:t,isScreenShareEnabled:i,cameraTrack:e.getTrackPublication(ys.Source.Camera),microphoneTrack:r,participant:e}}))}function yh(e,t){return new dd(n=>{const i=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.next(t)};return e.on(t,i),()=>{e.off(t,i)}})}function bh(e){return typeof e>"u"?new dd:yh(e,Ya.AttributesChanged).pipe(Hd(t=>{let[n]=t;return{changed:n,attributes:e.attributes}}),Jd({changed:e.attributes,attributes:e.attributes}))}function kh(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=[e.localParticipant,...Array.from(e.remoteParticipants.values())],r=[];return i.forEach(e=>{t.forEach(t=>{const i=Array.from(e.trackPublications.values()).filter(e=>e.source===t&&(!n||e.track)).map(t=>({participant:e,publication:t,source:t.source}));r.push(...i)})}),{trackReferences:r,participants:i}}function Sh(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{sources:i,kind:r,name:o}=t;return Array.from(e.trackPublications.values()).filter(e=>(!i||i.includes(e.source))&&(!r||e.kind===r)&&(!o||e.trackName===o)&&(!n||e.track)).map(t=>({participant:e,publication:t,source:t.source}))}function Th(e,t){return new dd(n=>{const i=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.next(t)};return e.on(t,i),()=>{e.off(t,i)}})}var wh="".concat("lk","-user-choices"),{load:Ch,save:Eh}=function(e){return{load:()=>function(e){if(typeof localStorage>"u")lh.error("Local storage is not available.");else try{const t=localStorage.getItem(e);return t?JSON.parse(t):void lh.warn("Item with key ".concat(e," does not exist in local storage."))}catch(t){return void lh.error("Error getting item from local storage: ".concat(t))}}(e),save:t=>function(e,t){if(typeof localStorage>"u")lh.error("Local storage is not available.");else try{if(t){const n=Object.fromEntries(Object.entries(t).filter(e=>{let[,t]=e;return""!==t}));localStorage.setItem(e,JSON.stringify(n))}}catch(n){lh.error("Error setting item to local storage: ".concat(n))}}(e,t)}}(wh);i.createContext(void 0);const Ph=i.createContext(void 0);function Rh(){return i.useContext(Ph)}const xh=i.createContext(void 0);function Oh(){return i.useContext(xh)}const _h=i.createContext(void 0);function Ih(e){const t=i.useContext(_h),n=null!==e&&void 0!==e?e:t;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}const Nh=i.createContext(void 0);const Dh=["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"];function Mh(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=Mh(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function Ah(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=Mh(e))&&(i&&(i+=" "),i+=t);return i}function Lh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(const n of t)if("function"==typeof n)try{n(...arguments)}catch(e){console.error(e)}}}function Uh(){const e=u({},arguments.length<=0?void 0:arguments[0]);for(let t=1;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];for(const t in n){const i=e[t],r=n[t];"function"==typeof i&&"function"==typeof r&&"o"===t[0]&&"n"===t[1]&&t.charCodeAt(2)>=65&&t.charCodeAt(2)<=90?e[t]=Lh(i,r):e[t]="className"!==t&&"UNSAFE_className"!==t||"string"!=typeof i||"string"!=typeof r?void 0!==r?r:i:Ah(i,r)}}return e}function jh(e){return void 0!==e}function Fh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Uh(...t.filter(jh))}function Bh(e,t){return"processor"===e&&t&&"object"==typeof t&&"name"in t?t.name:"e2ee"===e&&t?"e2ee-enabled":t}const zh={connect:!0,audio:!1,video:!1};const Vh=i.forwardRef(function(e,t){const{room:n,htmlProps:r}=function(e){const t=u(u({},zh),e),{token:n,serverUrl:r,options:a,room:s,connectOptions:c,connect:l,audio:d,video:h,screen:p,onConnected:f,onDisconnected:m,onError:g,onMediaDeviceFailure:v,onEncryptionError:y,simulateParticipants:b}=t,k=o(t,Dh);a&&s&&lh.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[S,T]=i.useState(),w=i.useRef(l);i.useEffect(()=>{T(null!==s&&void 0!==s?s:new Tu(a))},[s,JSON.stringify(a,Bh)]);const C=i.useMemo(()=>{const{className:e}={className:"lk-room-container"};return Uh(k,{className:e})},[k]);return i.useEffect(()=>{if(!S)return;const e=()=>{const e=S.localParticipant;lh.debug("trying to publish local tracks"),Promise.all([e.setMicrophoneEnabled(!!d,"boolean"!=typeof d?d:void 0),e.setCameraEnabled(!!h,"boolean"!=typeof h?h:void 0),e.setScreenShareEnabled(!!p,"boolean"!=typeof p?p:void 0)]).catch(e=>{lh.warn(e),null==g||g(e)})},t=(e,t)=>{const n=Ja.getFailure(e);null==v||v(n,t)},n=e=>{null==y||y(e)},i=e=>{null==m||m(e)},r=()=>{null==f||f()};return S.on($a.SignalConnected,e).on($a.MediaDevicesError,t).on($a.EncryptionError,n).on($a.Disconnected,i).on($a.Connected,r),()=>{S.off($a.SignalConnected,e).off($a.MediaDevicesError,t).off($a.EncryptionError,n).off($a.Disconnected,i).off($a.Connected,r)}},[S,d,h,p,g,y,v,f,m]),i.useEffect(()=>{if(S){if(b)return void S.simulateParticipants({participants:{count:b},publish:{audio:!0,useRealTracks:!0}});if(l){if(w.current=!0,lh.debug("connecting"),!n)return void lh.debug("no token yet");if(!r)return lh.warn("no livekit url provided"),void(null==g||g(Error("no livekit url provided")));S.connect(r,n,c).catch(e=>{lh.warn(e),!0===w.current&&(null==g||g(e))})}else lh.debug("disconnecting because connect is false"),w.current=!1,S.disconnect()}},[l,n,JSON.stringify(c),S,g,r,b]),i.useEffect(()=>{if(S)return()=>{lh.info("disconnecting on onmount"),S.disconnect()}},[S]),{room:S,htmlProps:C}}(e);return i.createElement("div",u({ref:t},r),n&&i.createElement(_h.Provider,{value:n},i.createElement(Nh.Provider,{value:e.featureFlags},e.children)))});function qh(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const[r,o]=i.useState(t);return i.useEffect(()=>{if(n&&o(t),typeof window>"u"||!e)return;const i=e.subscribe(o);return()=>i.unsubscribe()},[e,n]),r}function Hh(e){const t=Ih(e),n=i.useMemo(()=>function(e){return mh(e,$a.ConnectionStateChanged).pipe(Hd(e=>{let[t]=e;return t}),Jd(e.state))}(t),[t]);return qh(n,t.state)}function Wh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Ih(e.room),[n,r]=i.useState([]);return i.useEffect(()=>{const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;let i;const r=new dd(e=>(i=e,()=>a.unsubscribe())).pipe(Jd(Array.from(e.remoteParticipants.values()))),o=null!=(n=t.additionalRoomEvents)?n:sh,a=fh(e,...Array.from(new Set([$a.ParticipantConnected,$a.ParticipantDisconnected,$a.ConnectionStateChanged,...o]))).subscribe(e=>null==i?void 0:i.next(Array.from(e.remoteParticipants.values())));return e.remoteParticipants.size>0&&(null==i||i.next(Array.from(e.remoteParticipants.values()))),r}(t,{additionalRoomEvents:e.updateOnlyOn}).subscribe(r);return()=>n.unsubscribe()},[t,JSON.stringify(e.updateOnlyOn)]),n}function Gh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Wh(e),{localParticipant:n}=function(){const e=Ih((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).room),[t,n]=i.useState(e.localParticipant),[r,o]=i.useState(t.isMicrophoneEnabled),[a,s]=i.useState(t.isCameraEnabled),[c,l]=i.useState(t.isScreenShareEnabled),[u,d]=i.useState(t.lastMicrophoneError),[h,p]=i.useState(t.lastCameraError),[f,m]=i.useState(void 0),[g,v]=i.useState(void 0),y=e=>{s(e.isCameraEnabled),o(e.isMicrophoneEnabled),l(e.isScreenShareEnabled),v(e.cameraTrack),m(e.microphoneTrack),d(e.participant.lastMicrophoneError),p(e.participant.lastCameraError),n(e.participant)};return i.useEffect(()=>{const t=vh(e.localParticipant).subscribe(y);return()=>t.unsubscribe()},[e]),{isMicrophoneEnabled:r,isScreenShareEnabled:c,isCameraEnabled:a,microphoneTrack:f,cameraTrack:g,lastMicrophoneError:u,lastCameraError:h,localParticipant:t}}(e);return i.useMemo(()=>[n,...t],[n,t])}function Kh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[ys.Source.Camera,ys.Source.Microphone,ys.Source.ScreenShare,ys.Source.ScreenShareAudio,ys.Source.Unknown],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Ih(t.room),[r,o]=i.useState([]),[a,s]=i.useState([]),c=i.useMemo(()=>e.map(e=>uh(e)?e.source:e),[JSON.stringify(e)]);return i.useEffect(()=>{const e=function(e,t,n){var i,r;const o=null!=(i=n.additionalRoomEvents)?i:sh,a=null==(r=n.onlySubscribed)||r;return fh(e,...Array.from(new Set([$a.ParticipantConnected,$a.ParticipantDisconnected,$a.ConnectionStateChanged,$a.LocalTrackPublished,$a.LocalTrackUnpublished,$a.TrackPublished,$a.TrackUnpublished,$a.TrackSubscriptionStatusChanged,...o]).values())).pipe(Hd(e=>{const n=kh(e,t,a);return lh.debug("TrackReference[] was updated. (length ".concat(n.trackReferences.length,")"),n),n}),Jd(kh(e,t,a)))}(n,c,{additionalRoomEvents:t.updateOnlyOn,onlySubscribed:t.onlySubscribed}).subscribe(e=>{let{trackReferences:t,participants:n}=e;lh.debug("setting track bundles",t,n),o(t),s(n)});return()=>e.unsubscribe()},[n,JSON.stringify(t.onlySubscribed),JSON.stringify(t.updateOnlyOn),JSON.stringify(e)]),i.useMemo(()=>{if(dh(e)){const t=function(e,t){const n=new Map;if(dh(e)){const i=e.filter(e=>e.withPlaceholder).map(e=>e.source);t.forEach(e=>{const t=e.getTrackPublications().map(e=>{var t;return null==(t=e.track)?void 0:t.source}).filter(e=>void 0!==e),r=Array.from(function(e,t){const n=new Set(e);for(const i of t)n.delete(i);return n}(new Set(i),new Set(t)));r.length>0&&n.set(e.identity,r)})}return n}(e,a),n=Array.from(r);return a.forEach(e=>{var i;t.has(e.identity)&&(null!==(i=t.get(e.identity))&&void 0!==i?i:[]).forEach(t=>{if(r.find(n=>{let{participant:i,publication:r}=n;return e.identity===i.identity&&r.source===t}))return;lh.debug("Add ".concat(t," placeholder for participant ").concat(e.identity,"."));const i={participant:e,source:t};n.push(i)})}),n}return r},[r,a,e])}function Jh(e,t){const n=Oh(),r=Gh({updateOnlyOn:[]}),o=i.useMemo(()=>t?r.find(e=>e.identity===t):n,[t,r,n]),a=i.useMemo(()=>{if(o)return function(e,t){return gh(e,...ch).pipe(Hd(e=>{const n=Sh(e,t);return lh.debug("TrackReference[] was updated. (length ".concat(n.length,")"),n),n}),Jd(Sh(e,t)))}(o,{sources:e})},[o,JSON.stringify(e)]);return qh(a,[])}function Qh(e){var t,n,r;const o=i.useMemo(()=>{var t;return null!=(t=null==e?void 0:e.publication)&&t.track?function(e){return Th(e,Za.TimeSyncUpdate).pipe(Hd(e=>{let[t]=e;return t}))}(null==e?void 0:e.publication.track):void 0},[null==(t=null==e?void 0:e.publication)?void 0:t.track]);return qh(o,{timestamp:Date.now(),rtpTimestamp:null==(r=null==(n=null==e?void 0:e.publication)?void 0:n.track)?void 0:r.rtpTimestamp})}const $h={bufferSize:100};function Yh(e,t){const n=u(u({},$h),t),[r,o]=i.useState([]),a=Qh(e),s=e=>{var t;null==(t=n.onTranscription)||t.call(n,e),o(t=>function(e,t,n){return[...e,...t].reduceRight((e,t)=>(e.find(e=>e.id===t.id)||e.unshift(t),e),[]).slice(0-n)}(t,e.map(e=>function(e,t){var n;return ih(nh({},e),{receivedAtMediaTimestamp:null!=(n=t.rtpTimestamp)?n:0,receivedAt:t.timestamp})}(e,a)),n.bufferSize))};return i.useEffect(()=>{if(null==e||!e.publication)return;const t=function(e){return Th(e,Za.TranscriptionReceived)}(e.publication).subscribe(e=>{s(...e)});return()=>{t.unsubscribe()}},[e&&ah(e),s]),{segments:r}}const Xh="lk.agent.state";function Zh(){var e,t;const n=Wh(),r=n.find(e=>e.kind===xi.AGENT&&!("lk.publish_on_behalf"in e.attributes)),o=n.find(e=>e.kind===xi.AGENT&&e.attributes["lk.publish_on_behalf"]===(null==r?void 0:r.identity)),a=Jh([ys.Source.Microphone,ys.Source.Camera],null==r?void 0:r.identity),s=Jh([ys.Source.Microphone,ys.Source.Camera],null==o?void 0:o.identity),c=null!==(e=a.find(e=>e.source===ys.Source.Microphone))&&void 0!==e?e:s.find(e=>e.source===ys.Source.Microphone),l=null!==(t=a.find(e=>e.source===ys.Source.Camera))&&void 0!==t?t:s.find(e=>e.source===ys.Source.Camera),{segments:u}=Yh(c),d=Hh(),{attributes:h}=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=Oh(),r=null!==(e=t.participant)&&void 0!==e?e:n;return qh(i.useMemo(()=>bh(r),[r]),{attributes:null==r?void 0:r.attributes})}({participant:r}),p=i.useMemo(()=>d===vu.Disconnected?"disconnected":d!==vu.Connecting&&r&&null!=h&&h[Xh]?h[Xh]:"connecting",[h,r,d]);return{agent:r,state:p,audioTrack:c,videoTrack:l,agentTranscriptions:u,agentAttributes:h}}const ep=["trackRef","onSubscriptionStatusChanged","volume"];function tp(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[r,o]=i.useState(ph(e)),[a,s]=i.useState(null==r?void 0:r.isMuted),[c,l]=i.useState(null==r?void 0:r.isSubscribed),[d,h]=i.useState(null==r?void 0:r.track),[p,f]=i.useState("landscape"),m=i.useRef(),{className:g,trackObserver:v}=i.useMemo(()=>function(e){const t=ph(e),n=vh(e.participant).pipe(Hd(()=>ph(e)),Jd(t));return{className:hh(e.source===ys.Source.Camera||e.source===ys.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}(e),[null!==(t=e.participant.sid)&&void 0!==t?t:e.participant.identity,e.source,rh(e)&&e.publication.trackSid]);return i.useEffect(()=>{const e=v.subscribe(e=>{lh.debug("update track",e),o(e),s(null==e?void 0:e.isMuted),l(null==e?void 0:e.isSubscribed),h(null==e?void 0:e.track)});return()=>null==e?void 0:e.unsubscribe()},[v]),i.useEffect(()=>{var t,i;return d&&(m.current&&d.detach(m.current),null!=(t=n.element)&&t.current&&!(e.participant.isLocal&&"audio"===(null==d?void 0:d.kind))&&d.attach(n.element.current)),m.current=null==(i=n.element)?void 0:i.current,()=>{m.current&&(null==d||d.detach(m.current))}},[d,n.element]),i.useEffect(()=>{var e,t;if("number"==typeof(null==(e=null==r?void 0:r.dimensions)?void 0:e.width)&&"number"==typeof(null==(t=null==r?void 0:r.dimensions)?void 0:t.height)){const e=r.dimensions.width>r.dimensions.height?"landscape":"portrait";f(e)}},[r]),{publication:r,isMuted:a,isSubscribed:c,track:d,elementProps:Fh(n.props,u({className:g,"data-lk-local-participant":e.participant.isLocal,"data-lk-source":null==r?void 0:r.source},"video"===(null==r?void 0:r.kind)&&{"data-lk-orientation":p}))}}var np,ip;!function(){if(ip)return np;ip=1;var e=/^\s+|\s+$/g,t=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,i=/^0o[0-7]+$/i,r=parseInt,o="object"==typeof xu&&xu&&xu.Object===Object&&xu,a="object"==typeof self&&self&&self.Object===Object&&self,s=o||a||Function("return this")(),c=Object.prototype.toString,l=Math.max,u=Math.min,d=function(){return s.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function p(o){if("number"==typeof o)return o;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(o))return NaN;if(h(o)){var a="function"==typeof o.valueOf?o.valueOf():o;o=h(a)?a+"":a}if("string"!=typeof o)return 0===o?o:+o;o=o.replace(e,"");var s=n.test(o);return s||i.test(o)?r(o.slice(2),s?2:8):t.test(o)?NaN:+o}np=function(e,t,n){var i,r,o,a,s,c,f=0,m=!1,g=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=i,o=r;return i=r=void 0,f=t,a=e.apply(o,n)}function b(e){var n=e-c;return void 0===c||n>=t||n<0||g&&e-f>=o}function k(){var e=d();if(b(e))return S(e);s=setTimeout(k,function(e){var n=t-(e-c);return g?u(n,o-(e-f)):n}(e))}function S(e){return s=void 0,v&&i?y(e):(i=r=void 0,a)}function T(){var e=d(),n=b(e);if(i=arguments,r=this,c=e,n){if(void 0===s)return function(e){return f=e,s=setTimeout(k,t),m?y(e):a}(c);if(g)return s=setTimeout(k,t),y(c)}return void 0===s&&(s=setTimeout(k,t)),a}return t=p(t)||0,h(n)&&(m=!!n.leading,o=(g="maxWait"in n)?l(p(n.maxWait)||0,t):o,v="trailing"in n?!!n.trailing:v),T.cancel=function(){void 0!==s&&clearTimeout(s),f=0,i=c=r=s=void 0},T.flush=function(){return void 0===s?a:S(d())},T}}();const rp=i.forwardRef(function(e,t){let{trackRef:n,onSubscriptionStatusChanged:r,volume:a}=e,s=o(e,ep);const c=function(e){const t=Rh(),n=null!==e&&void 0!==e?e:t;if(!n)throw new Error("No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly");return n}(n),l=i.useRef(null);i.useImperativeHandle(t,()=>l.current);const{elementProps:d,isSubscribed:h,track:p,publication:f}=tp(c,{element:l,props:s});return i.useEffect(()=>{null==r||r(!!h)},[h,r]),i.useEffect(()=>{void 0===p||void 0===a||(p instanceof cu?p.setVolume(a):lh.warn("Volume can only be set on remote audio tracks."))},[a,p]),i.useEffect(()=>{void 0===f||void 0===s.muted||(f instanceof ku?f.setEnabled(!s.muted):lh.warn("Can only call setEnabled on remote track publications."))},[s.muted,f,p]),i.createElement("audio",u({ref:l},d))});function op(e){let{volume:t,muted:n}=e;const r=Kh([ys.Source.Microphone,ys.Source.ScreenShareAudio,ys.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0}).filter(e=>!e.participant.isLocal&&e.publication.kind===ys.Kind.Audio);return i.createElement("div",{style:{display:"none"}},r.map(e=>i.createElement(rp,{key:ah(e),trackRef:e,volume:t,muted:n})))}function ap(e){let{onDisconnect:t}=e;const{state:n}=Zh(),[r,o]=(0,i.useState)(!1),[a,s]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{o("listening"===n),n&&"initializing"!==n&&s(!0)},[n]),(0,wt.jsxs)("div",{className:"voice-assistant-ui",children:[(0,wt.jsx)("h2",{children:"PlantSense AI Voice Assistant"}),(0,wt.jsxs)("div",{className:"voice-status-container",children:[(0,wt.jsxs)("div",{className:"voice-indicator ".concat(r?"listening":"speaking"),children:[(0,wt.jsx)("div",{className:"voice-pulse"}),(0,wt.jsx)("div",{className:"voice-icon",children:"\ud83c\udfa4"})]}),(0,wt.jsx)("div",{className:"voice-state-text",children:a?"listening"===n?"Listening...":"thinking"===n?"Thinking...":"speaking"===n?"Speaking...":"Connected":"Connecting..."})]}),(0,wt.jsxs)("div",{className:"voice-instructions",children:[(0,wt.jsx)("p",{children:"Describe your plant's symptoms or ask about diseases"}),(0,wt.jsx)("p",{className:"voice-tip",children:"The AI can help diagnose issues and provide treatment advice"})]}),(0,wt.jsx)("button",{className:"voice-end-btn",onClick:t,children:"End Conversation"})]})}const sp=function(e){let{isOpen:t,onClose:n}=e;const[r,o]=(0,i.useState)(null),[a,s]=(0,i.useState)(!1),[c,l]=(0,i.useState)(null);(0,i.useEffect)(()=>{t&&!r&&u()},[t]);const u=async()=>{s(!0),l(null);try{const e=await fetch("".concat("http://127.0.0.1:8000","/voice-token"),{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Failed to get voice token: ".concat(t))}const t=await e.json();o(t.token),s(!1)}catch(e){console.error("Error connecting to voice agent:",e),l(e.message),s(!1)}},d=()=>{o(null),l(null),n()};return t?(0,wt.jsx)("div",{className:"voice-modal-overlay",onClick:d,children:(0,wt.jsxs)("div",{className:"voice-modal-content",onClick:e=>e.stopPropagation(),children:[(0,wt.jsx)("button",{className:"voice-modal-close",onClick:d,children:"\xd7"}),r?(0,wt.jsxs)(Vh,{token:r,serverUrl:"wss://final-llm-a8copwku.livekit.cloud",connect:!0,audio:!0,video:!1,onDisconnected:d,children:[(0,wt.jsx)(ap,{onDisconnect:d}),(0,wt.jsx)(op,{})]}):(0,wt.jsx)("div",{className:"voice-modal-connecting",children:a?(0,wt.jsxs)(wt.Fragment,{children:[(0,wt.jsx)("div",{className:"voice-spinner"}),(0,wt.jsx)("p",{children:"Connecting to PlantSense AI..."})]}):c?(0,wt.jsxs)(wt.Fragment,{children:[(0,wt.jsx)("div",{className:"voice-error-icon",children:"\u26a0\ufe0f"}),(0,wt.jsx)("p",{className:"voice-error-text",children:c}),(0,wt.jsx)("button",{className:"voice-retry-btn",onClick:u,children:"Retry Connection"})]}):null})]})}):null};const cp=function(){me();const[e,t]=(0,i.useState)(null),[n,r]=(0,i.useState)(!1),[o,a]=(0,i.useState)(null),[s,c]=(0,i.useState)([]),[l,u]=(0,i.useState)(!1);return(0,wt.jsxs)("div",{className:"container",children:[(0,wt.jsxs)("div",{className:"content-wrapper",children:[(0,wt.jsxs)("div",{className:"left-panel",children:[(0,wt.jsx)("div",{className:"logo",children:"PlantSense.AI"}),(0,wt.jsx)("label",{htmlFor:"imageInput",className:"add-image",children:e?(0,wt.jsx)("img",{id:"preview",src:e,alt:"Preview"}):(0,wt.jsx)("span",{children:"Add Image"})}),(0,wt.jsx)("input",{type:"file",id:"imageInput",accept:"image/*",style:{display:"none"},onChange:e=>{const n=e.target.files[0];if(n){const e=new FileReader;e.onload=()=>t(e.result),e.readAsDataURL(n)}}}),(0,wt.jsx)("button",{className:"analyse-btn",onClick:async()=>{const e=document.getElementById("imageInput").files[0];if(!e)return void alert("Please select an image first!");const t=new FormData;t.append("file",e),r(!0),a(null),c([]);try{const e=await fetch("".concat("http://127.0.0.1:8000","/predict"),{method:"POST",body:t,mode:"cors",headers:{Accept:"application/json"}});if(!e.ok){const t=await e.text();throw new Error("HTTP ".concat(e.status,": ").concat(t))}const n=await e.json();a({disease:n.disease||"Unknown Disease",description:n.description||"No description available.",confidence:n.confidence,isUncertain:!0===n.isUncertain}),c(n.predictions||[])}catch(n){a({disease:"Error",description:n.message})}finally{r(!1)}},disabled:n,children:n?"Analysing...":"Analyse Plant"})]}),(0,wt.jsxs)("div",{className:"right-panel",children:[(0,wt.jsx)("div",{className:"description",children:o?(0,wt.jsxs)(wt.Fragment,{children:[(0,wt.jsx)("div",{className:"prediction-header",children:o.isUncertain?(0,wt.jsx)("strong",{style:{color:"#9c6d1e"},children:"Suspected Disease"}):(0,wt.jsxs)("strong",{children:["\u2705 Detected Disease: ",o.disease]})}),(0,wt.jsx)("div",{className:"symptoms-section",children:(0,wt.jsx)("div",{className:"symptom-item",children:o.description})})]}):(0,wt.jsxs)(wt.Fragment,{children:[(0,wt.jsx)("div",{className:"desc-title",children:"Description"}),"Upload a plant image to see predictions."]})}),(0,wt.jsxs)("div",{className:"bar-section",children:[(0,wt.jsx)("div",{className:"desc-title",children:"Confidence Levels"}),(0,wt.jsx)("svg",{width:"100%",height:"160",children:s.map((e,t)=>{const n=45*t,i=["#22c55e","#78b48e","#9bb9a6"],r=i[t%i.length];return(0,wt.jsxs)("g",{transform:"translate(0, ".concat(n,")"),children:[(0,wt.jsx)("rect",{x:"0",y:"0",width:"100%",height:30,fill:"#f0f0f0",rx:"4"}),(0,wt.jsx)("rect",{className:"confidence-bar",x:"0",y:"0",width:"".concat(e.confidence,"%"),height:30,fill:r,rx:"4"}),(0,wt.jsx)("text",{x:"10",y:19,className:"confidence-label",children:e.disease}),(0,wt.jsxs)("text",{x:"98%",y:19,className:"confidence-value",textAnchor:"end",children:[e.confidence,"%"]})]},t)})})]})]})]}),o&&o.isUncertain&&(0,wt.jsxs)("div",{className:"uncertainty-warning",children:["\u26a0\ufe0f Note: PlantSense.AI is not fully confident in this prediction. This may be due to image quality or the disease not being represented in training data. Consider taking another photo or consulting an expert.",(0,wt.jsx)("button",{className:"voice-assistant-link-btn",onClick:()=>u(!0),style:{marginLeft:"10px",padding:"8px 16px",backgroundColor:"#22c55e",color:"white",border:"none",borderRadius:"20px",cursor:"pointer",fontWeight:"600"},children:"\ud83c\udfa4 Try Voice Assistant"})]}),(0,wt.jsx)("footer",{children:"\xa9 2025 PlantSense.AI | Empowering Farmers with Artificial Intelligence"}),(0,wt.jsx)("button",{className:"voice-btn",onClick:()=>u(!0),title:"Talk to PlantSense AI Assistant",children:"\ud83c\udfa4"}),(0,wt.jsx)(sp,{isOpen:l,onClose:()=>u(!1)})]})};const lp=function(){return(0,wt.jsx)(pt,{children:(0,wt.jsxs)(Me,{children:[(0,wt.jsx)(Ne,{path:"/",element:(0,wt.jsx)(Ct,{})}),(0,wt.jsx)(Ne,{path:"/predict",element:(0,wt.jsx)(cp,{})})]})})},up=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:o,getTTFB:a}=t;n(e),i(e),r(e),o(e),a(e)})};r.createRoot(document.getElementById("root")).render((0,wt.jsx)(i.StrictMode,{children:(0,wt.jsx)(lp,{})})),up()})();
//# sourceMappingURL=main.caf9e62b.js.map